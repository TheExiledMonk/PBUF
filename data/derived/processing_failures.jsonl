{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T06:33:00.003621+00:00", "processing_duration": 0.001064, "error_stage": "input_validation", "error_type": "input_validation_failed", "error_message": "Input validation failed", "context": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-9/test_prepare_dataset_input_val0/test_data.txt", "metadata_keys": []}, "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"]}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T06:33:00.005871+00:00", "processing_duration": 0.001204, "error_stage": "transformation", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "context": {"module_type": "sn", "supported_formats": [".txt", ".csv"], "file_extension": ".txt", "error_details": "Mock transformation failure", "transformation_summary": {"transformation_steps": ["Mock sn transformation"], "formulas_used": ["sn_formula = x * 2"], "assumptions": ["sn assumption"], "references": ["sn reference"]}}, "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values"]}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T06:33:00.010159+00:00", "processing_duration": 0.001061, "error_stage": "output_validation", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "context": {"schema_requirements": {"required_fields": ["z", "observable", "uncertainty", "metadata"], "optional_fields": ["covariance"], "required_metadata_keys": ["source"], "recommended_metadata_keys": ["dataset_type"]}}, "suggested_actions": ["Ensure all required fields (z, observable, uncertainty, metadata) are present", "Check derivation module output format", "Verify data loading process includes all necessary fields"]}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T06:34:35.395149+00:00", "processing_duration": 0.001126, "error_stage": "input_validation", "error_type": "input_validation_failed", "error_message": "Input validation failed", "context": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-10/test_prepare_dataset_input_val0/test_data.txt", "metadata_keys": []}, "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"]}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T06:34:35.397308+00:00", "processing_duration": 0.00106, "error_stage": "transformation", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "context": {"module_type": "sn", "supported_formats": [".txt", ".csv"], "file_extension": ".txt", "error_details": "Mock transformation failure", "transformation_summary": {"transformation_steps": ["Mock sn transformation"], "formulas_used": ["sn_formula = x * 2"], "assumptions": ["sn assumption"], "references": ["sn reference"]}}, "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values"]}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T06:34:35.399319+00:00", "processing_duration": 0.00109, "error_stage": "output_validation", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "context": {"schema_requirements": {"required_fields": ["z", "observable", "uncertainty", "metadata"], "optional_fields": ["covariance"], "required_metadata_keys": ["source"], "recommended_metadata_keys": ["dataset_type"]}}, "suggested_actions": ["Ensure all required fields (z, observable, uncertainty, metadata) are present", "Check derivation module output format", "Verify data loading process includes all necessary fields"]}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T06:34:42.591659+00:00", "processing_duration": 0.001296, "error_stage": "output_validation", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "context": {"issue_type": "nan_values", "data_statistics": {"n_points": 3, "z_range": [0.1, 0.3], "observable_range": [NaN, NaN], "uncertainty_range": [0.1, 0.3]}}, "suggested_actions": ["Check input data for missing values or invalid entries", "Review data loading process for proper NaN handling", "Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)", "Consider data cleaning or interpolation for missing values"]}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T06:34:42.594865+00:00", "processing_duration": 0.001262, "error_stage": "module_selection", "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "suggested_actions": ["Implement derivation module for unknown", "Check dataset name and type classification", "Verify module registration", "Use register_derivation_module() to add missing module"]}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T06:34:42.595203+00:00", "processing_duration": 0.000166, "error_stage": "input_validation", "error_type": "input_validation_failed", "error_message": "Input validation failed", "context": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-11/test_error_handling_integratio0/test.txt", "metadata_keys": []}, "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"]}
{"dataset_name": "cmb", "failure_time": "2025-10-23T07:05:54.893817+00:00", "processing_duration": 0.002068, "error_stage": "data_retrieval", "error_type": "registry_access_error", "error_message": "Unexpected error accessing registry: 'DatasetRegistry' object has no attribute 'get_registry_entry'", "context": {"exception_type": "AttributeError"}, "suggested_actions": ["Check registry system health", "Verify file system permissions", "Check network connectivity if using remote registry"]}
{"dataset_name": "cmb", "failure_time": "2025-10-23T07:06:31.604657+00:00", "processing_duration": 0.001852, "error_stage": "data_retrieval", "error_type": "registry_access_error", "error_message": "Unexpected error accessing registry: 'DatasetRegistry' object has no attribute 'get_registry_entry'", "context": {"exception_type": "AttributeError"}, "suggested_actions": ["Check registry system health", "Verify file system permissions", "Check network connectivity if using remote registry"]}
{"dataset_name": "test_data", "failure_time": "2025-10-23T08:24:50.168343+00:00", "processing_duration": 0.012275, "error_context": {"dataset_name": "test_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "'str' object has no attribute 'get'", "timestamp": "2025-10-23T08:24:50.167452+00:00", "processing_duration": 0.01138, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12306898944, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 497, in prepare_dataset\n    transformation_logger.save_publication_summary()\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/transformation_logging.py\", line 443, in save_publication_summary\n    pub_summary = self.generate_publication_summary()\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/transformation_logging.py\", line 422, in generate_publication_summary\n    validation_summary[validation_type] = \"passed\" if result.get('passed', False) else \"failed\"\n                                                      ^^^^^^^^^^\nAttributeError: 'str' object has no attribute 'get'\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T08:24:50.268614+00:00", "memory": {"total": 33224306688, "available": 12306382848, "used": 18902413312, "percent": 63.0}, "disk": {"total": 1965300219904, "used": 865576718336, "free": 999816228864, "percent": 44.04297672028355}, "cpu": {"percent": 10.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T08:26:23.104904+00:00", "processing_duration": 0.004115, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n", "timestamp": "2025-10-23T08:26:23.103893+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12275130368, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 144, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T08:26:23.205251+00:00", "memory": {"total": 33224306688, "available": 12275130368, "used": 18924453888, "percent": 63.1}, "disk": {"total": 1965300219904, "used": 865582596096, "free": 999810351104, "percent": 44.04327579723578}, "cpu": {"percent": 25.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T08:26:23.245063+00:00", "processing_duration": 0.003261, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T08:26:23.244653+00:00", "processing_duration": 0.002848, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12138782720, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 304, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T08:26:23.345389+00:00", "memory": {"total": 33224306688, "available": 12146819072, "used": 19029975040, "percent": 63.4}, "disk": {"total": 1965300219904, "used": 865582624768, "free": 999810322432, "percent": 44.043277256147746}, "cpu": {"percent": 13.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_planck2018", "failure_time": "2025-10-23T08:43:03.746200+00:00", "processing_duration": 0.008614, "error_context": {"dataset_name": "cmb_planck2018", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: No uncertainty found for parameter 'R' and no covariance matrix provided", "timestamp": "2025-10-23T08:43:03.745331+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13005938688, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "data/mock_phase_a/cmb_planck2018_mock.json", "metadata_keys": ["dataset_type", "description", "expected_observables", "expected_data_points", "source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 155, in _validate_cmb_parameters\n    raise ValueError(f\"No uncertainty found for parameter '{param}' and no covariance matrix provided\")\nValueError: No uncertainty found for parameter 'R' and no covariance matrix provided\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T08:43:03.846528+00:00", "memory": {"total": 33224306688, "available": 13034221568, "used": 18118250496, "percent": 60.8}, "disk": {"total": 1965300219904, "used": 865584791552, "free": 999808155648, "percent": 44.04338750820888}, "cpu": {"percent": 11.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon_plus", "failure_time": "2025-10-23T08:43:03.850156+00:00", "processing_duration": 0.001907, "error_context": {"dataset_name": "sn_pantheon_plus", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Unsupported file format: .json", "timestamp": "2025-10-23T08:43:03.849612+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12967157760, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "data/mock_phase_a/sn_pantheon_plus_mock.json", "metadata_keys": ["dataset_type", "description", "expected_observables", "expected_data_points", "source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 140, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 85, in validate_input\n    raise ValueError(f\"Unsupported file format: {raw_data_path.suffix}\")\nValueError: Unsupported file format: .json\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T08:43:03.950449+00:00", "memory": {"total": 33224306688, "available": 12967157760, "used": 18185314304, "percent": 61.0}, "disk": {"total": 1965300219904, "used": 865584812032, "free": 999808135168, "percent": 44.04338855028885}, "cpu": {"percent": 10.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_compilation", "failure_time": "2025-10-23T08:43:03.953945+00:00", "processing_duration": 0.001991, "error_context": {"dataset_name": "bao_compilation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Failed to read or validate raw data: 'NoneType' object has no attribute 'read_json'", "timestamp": "2025-10-23T08:43:03.953197+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12761620480, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "data/mock_phase_a/bao_compilation_mock.json", "metadata_keys": ["dataset_type", "description", "expected_observables", "expected_data_points", "source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 75, in validate_input\n    data = pd.read_json(raw_data_path)\n           ^^^^^^^^^^^^\nAttributeError: 'NoneType' object has no attribute 'read_json'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 101, in validate_input\n    raise ValueError(f\"Failed to read or validate raw data: {str(e)}\")\nValueError: Failed to read or validate raw data: 'NoneType' object has no attribute 'read_json'\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T08:43:04.054232+00:00", "memory": {"total": 33224306688, "available": 12761620480, "used": 18390847488, "percent": 61.6}, "disk": {"total": 1965300219904, "used": 865584824320, "free": 999808122880, "percent": 44.04338917553684}, "cpu": {"percent": 10.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_aniso_boss_dr12", "failure_time": "2025-10-23T08:43:04.058210+00:00", "processing_duration": 0.001884, "error_context": {"dataset_name": "bao_aniso_boss_dr12", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Failed to read or validate raw data: 'NoneType' object has no attribute 'read_json'", "timestamp": "2025-10-23T08:43:04.057559+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12495171584, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "data/mock_phase_a/bao_aniso_boss_dr12_mock.json", "metadata_keys": ["dataset_type", "description", "expected_observables", "expected_data_points", "source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 75, in validate_input\n    data = pd.read_json(raw_data_path)\n           ^^^^^^^^^^^^\nAttributeError: 'NoneType' object has no attribute 'read_json'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 101, in validate_input\n    raise ValueError(f\"Failed to read or validate raw data: {str(e)}\")\nValueError: Failed to read or validate raw data: 'NoneType' object has no attribute 'read_json'\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T08:43:04.158445+00:00", "memory": {"total": 33224306688, "available": 12495171584, "used": 18663620608, "percent": 62.4}, "disk": {"total": 1965300219904, "used": 865584848896, "free": 999808098304, "percent": 44.0433904260328}, "cpu": {"percent": 10.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_data", "failure_time": "2025-10-23T10:08:04.840009+00:00", "processing_duration": 0.008936, "error_context": {"dataset_name": "test_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:08:04.839357+00:00", "processing_duration": 0.00828, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12596191232, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:08:04.940293+00:00", "memory": {"total": 33224306688, "available": 12594356224, "used": 20629950464, "percent": 62.1}, "disk": {"total": 1965300219904, "used": 865816911872, "free": 999576035328, "percent": 44.05519844262232}, "cpu": {"percent": 11.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T10:08:04.946570+00:00", "processing_duration": 0.003803, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:08:04.945975+00:00", "processing_duration": 0.003204, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12461858816, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:08:05.046944+00:00", "memory": {"total": 33224306688, "available": 12461858816, "used": 20762447872, "percent": 62.5}, "disk": {"total": 1965300219904, "used": 865816940544, "free": 999576006656, "percent": 44.05519990153428}, "cpu": {"percent": 10.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T10:08:05.053650+00:00", "processing_duration": 0.003163, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:08:05.053196+00:00", "processing_duration": 0.002706, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12099710976, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:08:05.153918+00:00", "memory": {"total": 33224306688, "available": 12099710976, "used": 21124595712, "percent": 63.6}, "disk": {"total": 1965300219904, "used": 865816965120, "free": 999575982080, "percent": 44.05520115203025}, "cpu": {"percent": 11.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:08:05.464380+00:00", "processing_duration": 0.003183, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T10:08:05.464025+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12588904448, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:08:05.564735+00:00", "memory": {"total": 33224306688, "available": 12588904448, "used": 20635402240, "percent": 62.1}, "disk": {"total": 1965300219904, "used": 865817288704, "free": 999575658496, "percent": 44.05521761689382}, "cpu": {"percent": 7.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:08:05.570028+00:00", "processing_duration": 0.003308, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T10:08:05.569392+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12480462848, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-46/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 373, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1609, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:08:05.670275+00:00", "memory": {"total": 33224306688, "available": 12480462848, "used": 20743843840, "percent": 62.4}, "disk": {"total": 1965300219904, "used": 865817321472, "free": 999575625728, "percent": 44.05521928422178}, "cpu": {"percent": 7.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:08:05.675451+00:00", "processing_duration": 0.003791, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n", "timestamp": "2025-10-23T10:08:05.674424+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12676968448, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 157, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 409, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:08:05.775697+00:00", "memory": {"total": 33224306688, "available": 12685451264, "used": 20538855424, "percent": 61.8}, "disk": {"total": 1965300219904, "used": 865817358336, "free": 999575588864, "percent": 44.05522115996573}, "cpu": {"percent": 5.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T10:08:12.972942+00:00", "processing_duration": 0.004061, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T10:08:12.972404+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13264338944, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-46/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:08:13.073228+00:00", "memory": {"total": 33224306688, "available": 13264338944, "used": 19959967744, "percent": 60.1}, "disk": {"total": 1965300219904, "used": 865817600000, "free": 999575347200, "percent": 44.055233456509406}, "cpu": {"percent": 4.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T10:08:13.079373+00:00", "processing_duration": 0.003886, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T10:08:13.078907+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13266018304, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-46/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:08:13.179654+00:00", "memory": {"total": 33224306688, "available": 13266018304, "used": 19958288384, "percent": 60.1}, "disk": {"total": 1965300219904, "used": 865817628672, "free": 999575318528, "percent": 44.05523491542137}, "cpu": {"percent": 4.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T10:08:13.186028+00:00", "processing_duration": 0.004003, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T10:08:13.185563+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13264998400, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-46/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:08:13.286293+00:00", "memory": {"total": 33224306688, "available": 13264998400, "used": 19959308288, "percent": 60.1}, "disk": {"total": 1965300219904, "used": 865817653248, "free": 999575293952, "percent": 44.055236165917336}, "cpu": {"percent": 4.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T10:08:13.292347+00:00", "processing_duration": 0.00377, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T10:08:13.291806+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13266575360, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-46/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:08:13.392595+00:00", "memory": {"total": 33224306688, "available": 13266575360, "used": 19957731328, "percent": 60.1}, "disk": {"total": 1965300219904, "used": 865817681920, "free": 999575265280, "percent": 44.0552376248293}, "cpu": {"percent": 4.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_data", "failure_time": "2025-10-23T10:16:46.936414+00:00", "processing_duration": 0.008258, "error_context": {"dataset_name": "test_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:16:46.935846+00:00", "processing_duration": 0.007687, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12178190336, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:16:47.036686+00:00", "memory": {"total": 33224306688, "available": 12178190336, "used": 21046116352, "percent": 63.3}, "disk": {"total": 1965300219904, "used": 865849339904, "free": 999543607296, "percent": 44.05684847205149}, "cpu": {"percent": 15.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T10:16:47.042169+00:00", "processing_duration": 0.003344, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:16:47.041801+00:00", "processing_duration": 0.002974, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12008108032, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:16:47.142434+00:00", "memory": {"total": 33224306688, "available": 12008108032, "used": 21216198656, "percent": 63.9}, "disk": {"total": 1965300219904, "used": 865849376768, "free": 999543570432, "percent": 44.05685034779544}, "cpu": {"percent": 8.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T10:16:47.148252+00:00", "processing_duration": 0.003287, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:16:47.147897+00:00", "processing_duration": 0.002931, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12432072704, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:16:47.248583+00:00", "memory": {"total": 33224306688, "available": 12432072704, "used": 20792233984, "percent": 62.6}, "disk": {"total": 1965300219904, "used": 865849397248, "free": 999543549952, "percent": 44.05685138987541}, "cpu": {"percent": 12.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:16:47.548780+00:00", "processing_duration": 0.002658, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T10:16:47.548422+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12327530496, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:16:47.649027+00:00", "memory": {"total": 33224306688, "available": 12327530496, "used": 20896776192, "percent": 62.9}, "disk": {"total": 1965300219904, "used": 865849720832, "free": 999543226368, "percent": 44.05686785473898}, "cpu": {"percent": 7.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:16:47.654581+00:00", "processing_duration": 0.004271, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T10:16:47.653919+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12711800832, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-48/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 373, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1609, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:16:47.754915+00:00", "memory": {"total": 33224306688, "available": 12711800832, "used": 20512505856, "percent": 61.7}, "disk": {"total": 1965300219904, "used": 865849749504, "free": 999543197696, "percent": 44.05686931365095}, "cpu": {"percent": 4.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:16:47.760042+00:00", "processing_duration": 0.003497, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n", "timestamp": "2025-10-23T10:16:47.759298+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12738715648, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 157, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 409, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:16:47.860329+00:00", "memory": {"total": 33224306688, "available": 12738715648, "used": 20485591040, "percent": 61.7}, "disk": {"total": 1965300219904, "used": 865849786368, "free": 999543160832, "percent": 44.056871189394904}, "cpu": {"percent": 4.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T10:16:55.140459+00:00", "processing_duration": 0.003701, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T10:16:55.139963+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13114908672, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-48/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:16:55.240712+00:00", "memory": {"total": 33224306688, "available": 13114908672, "used": 20109398016, "percent": 60.5}, "disk": {"total": 1965300219904, "used": 865849987072, "free": 999542960128, "percent": 44.05688140177864}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T10:16:55.247554+00:00", "processing_duration": 0.004411, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T10:16:55.246931+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13115219968, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-48/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:16:55.347897+00:00", "memory": {"total": 33224306688, "available": 13114966016, "used": 20109340672, "percent": 60.5}, "disk": {"total": 1965300219904, "used": 865850007552, "free": 999542939648, "percent": 44.056882443858605}, "cpu": {"percent": 5.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T10:16:55.354151+00:00", "processing_duration": 0.003895, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T10:16:55.353625+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13114601472, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-48/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:16:55.454435+00:00", "memory": {"total": 33224306688, "available": 13114601472, "used": 20109705216, "percent": 60.5}, "disk": {"total": 1965300219904, "used": 865850036224, "free": 999542910976, "percent": 44.05688390277057}, "cpu": {"percent": 5.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T10:16:55.461654+00:00", "processing_duration": 0.004394, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T10:16:55.460951+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13131010048, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-48/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:16:55.561923+00:00", "memory": {"total": 33224306688, "available": 13131010048, "used": 20093296640, "percent": 60.5}, "disk": {"total": 1965300219904, "used": 865850064896, "free": 999542882304, "percent": 44.05688536168253}, "cpu": {"percent": 5.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_data", "failure_time": "2025-10-23T10:18:09.925070+00:00", "processing_duration": 0.009309, "error_context": {"dataset_name": "test_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:18:09.924452+00:00", "processing_duration": 0.008687, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12062097408, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:18:10.025357+00:00", "memory": {"total": 33224306688, "available": 12062097408, "used": 21162209280, "percent": 63.7}, "disk": {"total": 1965300219904, "used": 865832583168, "free": 999560364032, "percent": 44.05599584221762}, "cpu": {"percent": 10.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T10:18:10.030463+00:00", "processing_duration": 0.003048, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:18:10.030095+00:00", "processing_duration": 0.002678, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12290363392, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:18:10.130745+00:00", "memory": {"total": 33224306688, "available": 12290363392, "used": 20933943296, "percent": 63.0}, "disk": {"total": 1965300219904, "used": 865832611840, "free": 999560335360, "percent": 44.05599730112959}, "cpu": {"percent": 6.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T10:18:10.136500+00:00", "processing_duration": 0.002804, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:18:10.136162+00:00", "processing_duration": 0.002464, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12290850816, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:18:10.236714+00:00", "memory": {"total": 33224306688, "available": 12290850816, "used": 20933455872, "percent": 63.0}, "disk": {"total": 1965300219904, "used": 865832636416, "free": 999560310784, "percent": 44.05599855162555}, "cpu": {"percent": 7.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:18:10.535412+00:00", "processing_duration": 0.00278, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T10:18:10.535061+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11902590976, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:18:10.635670+00:00", "memory": {"total": 33224306688, "available": 11902590976, "used": 21321715712, "percent": 64.2}, "disk": {"total": 1965300219904, "used": 865832972288, "free": 999559974912, "percent": 44.056015641737105}, "cpu": {"percent": 10.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:18:10.640148+00:00", "processing_duration": 0.003337, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T10:18:10.639590+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11744620544, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-50/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 373, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1609, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:18:10.740369+00:00", "memory": {"total": 33224306688, "available": 11736363008, "used": 21487943680, "percent": 64.7}, "disk": {"total": 1965300219904, "used": 865832996864, "free": 999559950336, "percent": 44.056016892233075}, "cpu": {"percent": 9.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:18:10.745202+00:00", "processing_duration": 0.003604, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n", "timestamp": "2025-10-23T10:18:10.744524+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11484356608, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 157, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 409, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:18:10.845458+00:00", "memory": {"total": 33224306688, "available": 11476099072, "used": 21748207616, "percent": 65.5}, "disk": {"total": 1965300219904, "used": 865833050112, "free": 999559897088, "percent": 44.056019601641005}, "cpu": {"percent": 9.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T10:18:17.903773+00:00", "processing_duration": 0.004439, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T10:18:17.902942+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12624113664, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-50/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:18:18.004093+00:00", "memory": {"total": 33224306688, "available": 12624113664, "used": 20600193024, "percent": 62.0}, "disk": {"total": 1965300219904, "used": 865833246720, "free": 999559700480, "percent": 44.05602960560874}, "cpu": {"percent": 4.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T10:18:18.010292+00:00", "processing_duration": 0.003967, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T10:18:18.009797+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12623335424, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-50/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:18:18.110544+00:00", "memory": {"total": 33224306688, "available": 12623335424, "used": 20600971264, "percent": 62.0}, "disk": {"total": 1965300219904, "used": 865833267200, "free": 999559680000, "percent": 44.056030647688715}, "cpu": {"percent": 4.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T10:18:18.116885+00:00", "processing_duration": 0.004398, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T10:18:18.116437+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12676333568, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-50/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:18:18.217163+00:00", "memory": {"total": 33224306688, "available": 12676333568, "used": 20547973120, "percent": 61.8}, "disk": {"total": 1965300219904, "used": 865833295872, "free": 999559651328, "percent": 44.05603210660068}, "cpu": {"percent": 4.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T10:18:18.223790+00:00", "processing_duration": 0.00466, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T10:18:18.223222+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12676915200, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-50/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:18:18.324070+00:00", "memory": {"total": 33224306688, "available": 12676915200, "used": 20547391488, "percent": 61.8}, "disk": {"total": 1965300219904, "used": 865833324544, "free": 999559622656, "percent": 44.05603356551264}, "cpu": {"percent": 4.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_data", "failure_time": "2025-10-23T10:21:08.732620+00:00", "processing_duration": 0.009931, "error_context": {"dataset_name": "test_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:21:08.731751+00:00", "processing_duration": 0.009054, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12491317248, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:21:08.832959+00:00", "memory": {"total": 33224306688, "available": 12491317248, "used": 20732989440, "percent": 62.4}, "disk": {"total": 1965300219904, "used": 865842991104, "free": 999549956096, "percent": 44.05652542725987}, "cpu": {"percent": 8.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T10:21:08.838629+00:00", "processing_duration": 0.003378, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:21:08.838122+00:00", "processing_duration": 0.002868, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12392665088, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:21:08.938931+00:00", "memory": {"total": 33224306688, "available": 12392665088, "used": 20831641600, "percent": 62.7}, "disk": {"total": 1965300219904, "used": 865843019776, "free": 999549927424, "percent": 44.05652688617184}, "cpu": {"percent": 7.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T10:21:08.945249+00:00", "processing_duration": 0.003061, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:21:08.944881+00:00", "processing_duration": 0.002691, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12287029248, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:21:09.045483+00:00", "memory": {"total": 33224306688, "available": 12287029248, "used": 20937277440, "percent": 63.0}, "disk": {"total": 1965300219904, "used": 865843085312, "free": 999549861888, "percent": 44.05653022082775}, "cpu": {"percent": 7.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:21:09.352994+00:00", "processing_duration": 0.003314, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T10:21:09.352559+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12182728704, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:21:09.453341+00:00", "memory": {"total": 33224306688, "available": 12182728704, "used": 21041577984, "percent": 63.3}, "disk": {"total": 1965300219904, "used": 865843421184, "free": 999549526016, "percent": 44.05654731093931}, "cpu": {"percent": 7.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:21:09.458718+00:00", "processing_duration": 0.003705, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T10:21:09.458012+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12477566976, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-51/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 373, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1609, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:21:09.558976+00:00", "memory": {"total": 33224306688, "available": 12477566976, "used": 20746739712, "percent": 62.4}, "disk": {"total": 1965300219904, "used": 865843458048, "free": 999549489152, "percent": 44.056549186683256}, "cpu": {"percent": 7.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:21:09.564166+00:00", "processing_duration": 0.003842, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n", "timestamp": "2025-10-23T10:21:09.563424+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12330614784, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 157, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 409, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:21:09.664437+00:00", "memory": {"total": 33224306688, "available": 12322357248, "used": 20901949440, "percent": 62.9}, "disk": {"total": 1965300219904, "used": 865843482624, "free": 999549464576, "percent": 44.056550437179226}, "cpu": {"percent": 5.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T10:21:17.377710+00:00", "processing_duration": 0.00401, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T10:21:17.377239+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13235433472, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-51/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:21:17.477996+00:00", "memory": {"total": 33224306688, "available": 13235433472, "used": 19988873216, "percent": 60.2}, "disk": {"total": 1965300219904, "used": 865843605504, "free": 999549341696, "percent": 44.05655668965907}, "cpu": {"percent": 4.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T10:21:17.484493+00:00", "processing_duration": 0.003849, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T10:21:17.484025+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13278654464, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-51/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:21:17.584765+00:00", "memory": {"total": 33224306688, "available": 13278654464, "used": 19945652224, "percent": 60.0}, "disk": {"total": 1965300219904, "used": 865843634176, "free": 999549313024, "percent": 44.05655814857102}, "cpu": {"percent": 4.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T10:21:17.591600+00:00", "processing_duration": 0.004158, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T10:21:17.591121+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13284519936, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-51/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:21:17.691896+00:00", "memory": {"total": 33224306688, "available": 13284519936, "used": 19939786752, "percent": 60.0}, "disk": {"total": 1965300219904, "used": 865843658752, "free": 999549288448, "percent": 44.05655939906699}, "cpu": {"percent": 4.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T10:21:17.698222+00:00", "processing_duration": 0.00375, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T10:21:17.697718+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13285957632, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-51/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:21:17.798507+00:00", "memory": {"total": 33224306688, "available": 13285957632, "used": 19938349056, "percent": 60.0}, "disk": {"total": 1965300219904, "used": 865843691520, "free": 999549255680, "percent": 44.05656106639495}, "cpu": {"percent": 4.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_data", "failure_time": "2025-10-23T10:21:35.240006+00:00", "processing_duration": 0.009813, "error_context": {"dataset_name": "test_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:21:35.239375+00:00", "processing_duration": 0.009178, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12629643264, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:21:35.340376+00:00", "memory": {"total": 33224306688, "available": 12627836928, "used": 20596469760, "percent": 62.0}, "disk": {"total": 1965300219904, "used": 865843572736, "free": 999549374464, "percent": 44.0565550223311}, "cpu": {"percent": 9.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T10:21:35.345680+00:00", "processing_duration": 0.003194, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:21:35.345216+00:00", "processing_duration": 0.002726, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12675100672, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:21:35.445931+00:00", "memory": {"total": 33224306688, "available": 12675100672, "used": 20549206016, "percent": 61.8}, "disk": {"total": 1965300219904, "used": 865843605504, "free": 999549341696, "percent": 44.05655668965907}, "cpu": {"percent": 7.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T10:21:35.451499+00:00", "processing_duration": 0.002775, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:21:35.451148+00:00", "processing_duration": 0.002422, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12554735616, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:21:35.551805+00:00", "memory": {"total": 33224306688, "available": 12554735616, "used": 20669571072, "percent": 62.2}, "disk": {"total": 1965300219904, "used": 865843634176, "free": 999549313024, "percent": 44.05655814857102}, "cpu": {"percent": 8.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:21:35.845575+00:00", "processing_duration": 0.00288, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T10:21:35.845217+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12994871296, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:21:35.945861+00:00", "memory": {"total": 33224306688, "available": 12994613248, "used": 20229693440, "percent": 60.9}, "disk": {"total": 1965300219904, "used": 865843953664, "free": 999548993536, "percent": 44.05657440501861}, "cpu": {"percent": 4.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:21:35.951300+00:00", "processing_duration": 0.003567, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T10:21:35.950725+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13016301568, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-52/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 373, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1609, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:21:36.051571+00:00", "memory": {"total": 33224306688, "available": 13016301568, "used": 20208005120, "percent": 60.8}, "disk": {"total": 1965300219904, "used": 865843986432, "free": 999548960768, "percent": 44.05657607234656}, "cpu": {"percent": 4.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:21:36.056601+00:00", "processing_duration": 0.003445, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n", "timestamp": "2025-10-23T10:21:36.055895+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13015625728, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 157, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 409, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:21:36.156869+00:00", "memory": {"total": 33224306688, "available": 13015625728, "used": 20208680960, "percent": 60.8}, "disk": {"total": 1965300219904, "used": 865844023296, "free": 999548923904, "percent": 44.05657794809051}, "cpu": {"percent": 4.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T10:21:44.300489+00:00", "processing_duration": 0.004162, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T10:21:44.299632+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13593169920, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-52/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:21:44.400867+00:00", "memory": {"total": 33224306688, "available": 13593169920, "used": 19631136768, "percent": 59.1}, "disk": {"total": 1965300219904, "used": 865844215808, "free": 999548731392, "percent": 44.056587743642254}, "cpu": {"percent": 4.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T10:21:44.407119+00:00", "processing_duration": 0.00396, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T10:21:44.406440+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13607968768, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-52/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:21:44.507439+00:00", "memory": {"total": 33224306688, "available": 13607968768, "used": 19616337920, "percent": 59.0}, "disk": {"total": 1965300219904, "used": 865844244480, "free": 999548702720, "percent": 44.05658920255422}, "cpu": {"percent": 3.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T10:21:44.514443+00:00", "processing_duration": 0.004881, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T10:21:44.513863+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13610446848, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-52/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:21:44.614730+00:00", "memory": {"total": 33224306688, "available": 13610446848, "used": 19613859840, "percent": 59.0}, "disk": {"total": 1965300219904, "used": 865844264960, "free": 999548682240, "percent": 44.056590244634194}, "cpu": {"percent": 4.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T10:21:44.620797+00:00", "processing_duration": 0.003893, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T10:21:44.620226+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13617893376, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-52/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:21:44.721169+00:00", "memory": {"total": 33224306688, "available": 13617893376, "used": 19606413312, "percent": 59.0}, "disk": {"total": 1965300219904, "used": 865844301824, "free": 999548645376, "percent": 44.05659212037815}, "cpu": {"percent": 3.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_data", "failure_time": "2025-10-23T10:28:57.037555+00:00", "processing_duration": 0.009278, "error_context": {"dataset_name": "test_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:28:57.036815+00:00", "processing_duration": 0.008533, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12173402112, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:28:57.137976+00:00", "memory": {"total": 33224306688, "available": 12173402112, "used": 21050904576, "percent": 63.4}, "disk": {"total": 1965300219904, "used": 865867071488, "free": 999525875712, "percent": 44.05775070489207}, "cpu": {"percent": 8.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T10:28:57.143804+00:00", "processing_duration": 0.003439, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:28:57.143320+00:00", "processing_duration": 0.002951, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12045594624, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:28:57.244074+00:00", "memory": {"total": 33224306688, "available": 12037337088, "used": 21186969600, "percent": 63.8}, "disk": {"total": 1965300219904, "used": 865867100160, "free": 999525847040, "percent": 44.05775216380403}, "cpu": {"percent": 6.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T10:28:57.250364+00:00", "processing_duration": 0.003154, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:28:57.250020+00:00", "processing_duration": 0.002808, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11978772480, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:28:57.350646+00:00", "memory": {"total": 33224306688, "available": 11970514944, "used": 21253791744, "percent": 64.0}, "disk": {"total": 1965300219904, "used": 865867124736, "free": 999525822464, "percent": 44.0577534143}, "cpu": {"percent": 10.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:28:57.657439+00:00", "processing_duration": 0.00282, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T10:28:57.657016+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11884273664, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:28:57.757754+00:00", "memory": {"total": 33224306688, "available": 11884273664, "used": 21340033024, "percent": 64.2}, "disk": {"total": 1965300219904, "used": 865867464704, "free": 999525482496, "percent": 44.057770712827555}, "cpu": {"percent": 12.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:28:57.763220+00:00", "processing_duration": 0.004008, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T10:28:57.762472+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11658096640, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-53/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 373, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1609, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:28:57.863560+00:00", "memory": {"total": 33224306688, "available": 11658096640, "used": 21566210048, "percent": 64.9}, "disk": {"total": 1965300219904, "used": 865867481088, "free": 999525466112, "percent": 44.05777154649153}, "cpu": {"percent": 12.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:28:57.869483+00:00", "processing_duration": 0.004142, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n", "timestamp": "2025-10-23T10:28:57.868603+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12054614016, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 157, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 409, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:28:57.969773+00:00", "memory": {"total": 33224306688, "available": 12046356480, "used": 21177950208, "percent": 63.7}, "disk": {"total": 1965300219904, "used": 865867513856, "free": 999525433344, "percent": 44.05777321381949}, "cpu": {"percent": 10.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T10:29:05.340402+00:00", "processing_duration": 0.003674, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T10:29:05.339924+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12889964544, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-53/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:29:05.440646+00:00", "memory": {"total": 33224306688, "available": 12889964544, "used": 20334342144, "percent": 61.2}, "disk": {"total": 1965300219904, "used": 865867714560, "free": 999525232640, "percent": 44.05778342620322}, "cpu": {"percent": 4.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T10:29:05.446546+00:00", "processing_duration": 0.003387, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T10:29:05.446092+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12908597248, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-53/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:29:05.546793+00:00", "memory": {"total": 33224306688, "available": 12908597248, "used": 20315709440, "percent": 61.1}, "disk": {"total": 1965300219904, "used": 865867743232, "free": 999525203968, "percent": 44.05778488511519}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T10:29:05.553763+00:00", "processing_duration": 0.005121, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T10:29:05.553229+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12925992960, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-53/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:29:05.654049+00:00", "memory": {"total": 33224306688, "available": 12925992960, "used": 20298313728, "percent": 61.1}, "disk": {"total": 1965300219904, "used": 865867767808, "free": 999525179392, "percent": 44.05778613561115}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T10:29:05.660911+00:00", "processing_duration": 0.004148, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T10:29:05.660320+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12938412032, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-53/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:29:05.761208+00:00", "memory": {"total": 33224306688, "available": 12938412032, "used": 20285894656, "percent": 61.1}, "disk": {"total": 1965300219904, "used": 865867796480, "free": 999525150720, "percent": 44.05778759452311}, "cpu": {"percent": 5.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_data", "failure_time": "2025-10-23T10:32:44.049850+00:00", "processing_duration": 0.009676, "error_context": {"dataset_name": "test_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:32:44.049062+00:00", "processing_duration": 0.008883, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11572240384, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:32:44.150174+00:00", "memory": {"total": 33224306688, "available": 11572240384, "used": 21652066304, "percent": 65.2}, "disk": {"total": 1965300219904, "used": 865877180416, "free": 999515766784, "percent": 44.05826507556672}, "cpu": {"percent": 8.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T10:32:44.155531+00:00", "processing_duration": 0.003091, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:32:44.155171+00:00", "processing_duration": 0.002729, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11432714240, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:32:44.255808+00:00", "memory": {"total": 33224306688, "available": 11432714240, "used": 21791592448, "percent": 65.6}, "disk": {"total": 1965300219904, "used": 865877209088, "free": 999515738112, "percent": 44.05826653447868}, "cpu": {"percent": 10.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T10:32:44.261925+00:00", "processing_duration": 0.00331, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:32:44.261569+00:00", "processing_duration": 0.002952, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11861573632, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:32:44.362182+00:00", "memory": {"total": 33224306688, "available": 11861573632, "used": 21362733056, "percent": 64.3}, "disk": {"total": 1965300219904, "used": 865877233664, "free": 999515713536, "percent": 44.05826778497465}, "cpu": {"percent": 14.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:32:44.663706+00:00", "processing_duration": 0.003134, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T10:32:44.663378+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11427807232, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:32:44.763961+00:00", "memory": {"total": 33224306688, "available": 11427807232, "used": 21796499456, "percent": 65.6}, "disk": {"total": 1965300219904, "used": 865877594112, "free": 999515353088, "percent": 44.05828612558217}, "cpu": {"percent": 7.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:32:44.768243+00:00", "processing_duration": 0.003125, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T10:32:44.767655+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11759054848, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-54/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 373, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1609, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:32:44.868515+00:00", "memory": {"total": 33224306688, "available": 11759054848, "used": 21465251840, "percent": 64.6}, "disk": {"total": 1965300219904, "used": 865877626880, "free": 999515320320, "percent": 44.058287792910136}, "cpu": {"percent": 6.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:32:44.873794+00:00", "processing_duration": 0.003918, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n", "timestamp": "2025-10-23T10:32:44.872981+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11611402240, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 157, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 409, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:32:44.974080+00:00", "memory": {"total": 33224306688, "available": 11611402240, "used": 21612904448, "percent": 65.1}, "disk": {"total": 1965300219904, "used": 865877663744, "free": 999515283456, "percent": 44.05828966865408}, "cpu": {"percent": 6.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T10:32:52.893090+00:00", "processing_duration": 0.004525, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T10:32:52.892536+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12746792960, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-54/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:32:52.993409+00:00", "memory": {"total": 33224306688, "available": 12746792960, "used": 20477513728, "percent": 61.6}, "disk": {"total": 1965300219904, "used": 865877860352, "free": 999515086848, "percent": 44.05829967262183}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T10:32:53.000909+00:00", "processing_duration": 0.004082, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T10:32:53.000422+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12748668928, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-54/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:32:53.101217+00:00", "memory": {"total": 33224306688, "available": 12748668928, "used": 20475637760, "percent": 61.6}, "disk": {"total": 1965300219904, "used": 865877880832, "free": 999515066368, "percent": 44.0583007147018}, "cpu": {"percent": 4.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T10:32:53.107445+00:00", "processing_duration": 0.003946, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T10:32:53.106849+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12747796480, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-54/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:32:53.207755+00:00", "memory": {"total": 33224306688, "available": 12747796480, "used": 20476510208, "percent": 61.6}, "disk": {"total": 1965300219904, "used": 865877913600, "free": 999515033600, "percent": 44.05830238202975}, "cpu": {"percent": 4.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T10:32:53.213676+00:00", "processing_duration": 0.003749, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T10:32:53.213165+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12747620352, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-54/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:32:53.313901+00:00", "memory": {"total": 33224306688, "available": 12747620352, "used": 20476686336, "percent": 61.6}, "disk": {"total": 1965300219904, "used": 865877938176, "free": 999515009024, "percent": 44.05830363252572}, "cpu": {"percent": 4.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_data", "failure_time": "2025-10-23T10:35:29.074574+00:00", "processing_duration": 0.009022, "error_context": {"dataset_name": "test_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:35:29.073856+00:00", "processing_duration": 0.0083, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11849015296, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:35:29.174846+00:00", "memory": {"total": 33224306688, "available": 11849015296, "used": 21375291392, "percent": 64.3}, "disk": {"total": 1965300219904, "used": 865888092160, "free": 999504855040, "percent": 44.05882029577631}, "cpu": {"percent": 7.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T10:35:29.179827+00:00", "processing_duration": 0.003036, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:35:29.179472+00:00", "processing_duration": 0.002678, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11659120640, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:35:29.280045+00:00", "memory": {"total": 33224306688, "available": 11659120640, "used": 21565186048, "percent": 64.9}, "disk": {"total": 1965300219904, "used": 865888120832, "free": 999504826368, "percent": 44.05882175468827}, "cpu": {"percent": 8.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T10:35:29.285715+00:00", "processing_duration": 0.003006, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:35:29.285370+00:00", "processing_duration": 0.002659, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11507806208, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:35:29.385919+00:00", "memory": {"total": 33224306688, "available": 11507806208, "used": 21716500480, "percent": 65.4}, "disk": {"total": 1965300219904, "used": 865888149504, "free": 999504797696, "percent": 44.058823213600235}, "cpu": {"percent": 7.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:35:29.696252+00:00", "processing_duration": 0.002799, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T10:35:29.695897+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11339620352, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:35:29.796540+00:00", "memory": {"total": 33224306688, "available": 11339620352, "used": 21884686336, "percent": 65.9}, "disk": {"total": 1965300219904, "used": 865888481280, "free": 999504465920, "percent": 44.0588400952958}, "cpu": {"percent": 15.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:35:29.801272+00:00", "processing_duration": 0.003379, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T10:35:29.800683+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11610144768, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-55/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 373, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1609, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:35:29.901514+00:00", "memory": {"total": 33224306688, "available": 11610144768, "used": 21614161920, "percent": 65.1}, "disk": {"total": 1965300219904, "used": 865888505856, "free": 999504441344, "percent": 44.05884134579176}, "cpu": {"percent": 6.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:35:29.906294+00:00", "processing_duration": 0.003496, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n", "timestamp": "2025-10-23T10:35:29.905510+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11527581696, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 165, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 409, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:35:30.006550+00:00", "memory": {"total": 33224306688, "available": 11527581696, "used": 21696724992, "percent": 65.3}, "disk": {"total": 1965300219904, "used": 865888542720, "free": 999504404480, "percent": 44.05884322153572}, "cpu": {"percent": 6.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T10:35:37.862308+00:00", "processing_duration": 0.003975, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T10:35:37.861773+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12632137728, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-55/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:35:37.962565+00:00", "memory": {"total": 33224306688, "available": 12632137728, "used": 20592168960, "percent": 62.0}, "disk": {"total": 1965300219904, "used": 865888735232, "free": 999504211968, "percent": 44.058853017087465}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T10:35:37.968653+00:00", "processing_duration": 0.003811, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T10:35:37.968181+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12684673024, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-55/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:35:38.068903+00:00", "memory": {"total": 33224306688, "available": 12684673024, "used": 20539633664, "percent": 61.8}, "disk": {"total": 1965300219904, "used": 865888755712, "free": 999504191488, "percent": 44.05885405916744}, "cpu": {"percent": 5.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T10:35:38.074582+00:00", "processing_duration": 0.003806, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T10:35:38.074136+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12685348864, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-55/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:35:38.174822+00:00", "memory": {"total": 33224306688, "available": 12685348864, "used": 20538957824, "percent": 61.8}, "disk": {"total": 1965300219904, "used": 865888784384, "free": 999504162816, "percent": 44.05885551807939}, "cpu": {"percent": 4.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T10:35:38.180266+00:00", "processing_duration": 0.003432, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T10:35:38.179813+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12685938688, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-55/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:35:38.280534+00:00", "memory": {"total": 33224306688, "available": 12685938688, "used": 20538368000, "percent": 61.8}, "disk": {"total": 1965300219904, "used": 865888817152, "free": 999504130048, "percent": 44.058857185407355}, "cpu": {"percent": 4.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_data", "failure_time": "2025-10-23T10:36:34.079853+00:00", "processing_duration": 0.009633, "error_context": {"dataset_name": "test_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:36:34.079205+00:00", "processing_duration": 0.008981, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11841097728, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:36:34.180160+00:00", "memory": {"total": 33224306688, "available": 11841097728, "used": 21383208960, "percent": 64.4}, "disk": {"total": 1965300219904, "used": 865889267712, "free": 999503679488, "percent": 44.05888011116676}, "cpu": {"percent": 10.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T10:36:34.185787+00:00", "processing_duration": 0.003445, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:36:34.185317+00:00", "processing_duration": 0.002972, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11484663808, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:36:34.286313+00:00", "memory": {"total": 33224306688, "available": 11484663808, "used": 21739642880, "percent": 65.4}, "disk": {"total": 1965300219904, "used": 865889296384, "free": 999503650816, "percent": 44.05888157007872}, "cpu": {"percent": 9.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T10:36:34.293945+00:00", "processing_duration": 0.003493, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:36:34.293508+00:00", "processing_duration": 0.003053, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11360366592, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:36:34.394262+00:00", "memory": {"total": 33224306688, "available": 11360366592, "used": 21863940096, "percent": 65.8}, "disk": {"total": 1965300219904, "used": 865889325056, "free": 999503622144, "percent": 44.05888302899068}, "cpu": {"percent": 11.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:36:34.693976+00:00", "processing_duration": 0.00309, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T10:36:34.693581+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11655688192, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:36:34.794240+00:00", "memory": {"total": 33224306688, "available": 11655688192, "used": 21568618496, "percent": 64.9}, "disk": {"total": 1965300219904, "used": 865889652736, "free": 999503294464, "percent": 44.058899702270246}, "cpu": {"percent": 8.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:36:34.798984+00:00", "processing_duration": 0.003299, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T10:36:34.798399+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11506913280, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-58/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 373, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1609, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:36:34.899250+00:00", "memory": {"total": 33224306688, "available": 11506913280, "used": 21717393408, "percent": 65.4}, "disk": {"total": 1965300219904, "used": 865889685504, "free": 999503261696, "percent": 44.05890136959821}, "cpu": {"percent": 8.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:36:34.904346+00:00", "processing_duration": 0.003689, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n", "timestamp": "2025-10-23T10:36:34.903720+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11339804672, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 165, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 409, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:36:35.004596+00:00", "memory": {"total": 33224306688, "available": 11339804672, "used": 21884502016, "percent": 65.9}, "disk": {"total": 1965300219904, "used": 865889710080, "free": 999503237120, "percent": 44.05890262009417}, "cpu": {"percent": 9.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T10:36:42.619340+00:00", "processing_duration": 0.004279, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T10:36:42.618849+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12430766080, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-58/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:36:42.719578+00:00", "memory": {"total": 33224306688, "available": 12430766080, "used": 20793540608, "percent": 62.6}, "disk": {"total": 1965300219904, "used": 865889914880, "free": 999503032320, "percent": 44.058913040893906}, "cpu": {"percent": 5.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T10:36:42.725491+00:00", "processing_duration": 0.003827, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T10:36:42.725030+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12451827712, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-58/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:36:42.825761+00:00", "memory": {"total": 33224306688, "available": 12451827712, "used": 20772478976, "percent": 62.5}, "disk": {"total": 1965300219904, "used": 865889947648, "free": 999502999552, "percent": 44.058914708221856}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T10:36:42.832358+00:00", "processing_duration": 0.004471, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T10:36:42.831906+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12458311680, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-58/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:36:42.932622+00:00", "memory": {"total": 33224306688, "available": 12458311680, "used": 20765995008, "percent": 62.5}, "disk": {"total": 1965300219904, "used": 865889968128, "free": 999502979072, "percent": 44.05891575030183}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T10:36:42.938987+00:00", "processing_duration": 0.003941, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T10:36:42.938515+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12466700288, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-58/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:36:43.039263+00:00", "memory": {"total": 33224306688, "available": 12466700288, "used": 20757606400, "percent": 62.5}, "disk": {"total": 1965300219904, "used": 865890000896, "free": 999502946304, "percent": 44.058917417629786}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_data", "failure_time": "2025-10-23T10:42:43.405401+00:00", "processing_duration": 0.009503, "error_context": {"dataset_name": "test_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:42:43.404719+00:00", "processing_duration": 0.008816, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11646881792, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:42:43.505758+00:00", "memory": {"total": 33224306688, "available": 11646881792, "used": 21577424896, "percent": 64.9}, "disk": {"total": 1965300219904, "used": 865893478400, "free": 999499468800, "percent": 44.0590943628092}, "cpu": {"percent": 10.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T10:42:43.511220+00:00", "processing_duration": 0.003307, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:42:43.510774+00:00", "processing_duration": 0.002857, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11368255488, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:42:43.611507+00:00", "memory": {"total": 33224306688, "available": 11368255488, "used": 21856051200, "percent": 65.8}, "disk": {"total": 1965300219904, "used": 865893498880, "free": 999499448320, "percent": 44.05909540488917}, "cpu": {"percent": 10.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T10:42:43.618218+00:00", "processing_duration": 0.003174, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:42:43.617843+00:00", "processing_duration": 0.002797, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11770916864, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:42:43.718483+00:00", "memory": {"total": 33224306688, "available": 11770916864, "used": 21453389824, "percent": 64.6}, "disk": {"total": 1965300219904, "used": 865893523456, "free": 999499423744, "percent": 44.05909665538514}, "cpu": {"percent": 9.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:42:44.027052+00:00", "processing_duration": 0.003076, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T10:42:44.026705+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11327557632, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:42:44.127341+00:00", "memory": {"total": 33224306688, "available": 11327557632, "used": 21896749056, "percent": 65.9}, "disk": {"total": 1965300219904, "used": 865893863424, "free": 999499083776, "percent": 44.059113953912686}, "cpu": {"percent": 10.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:42:44.132230+00:00", "processing_duration": 0.003509, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T10:42:44.131552+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11712094208, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-59/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 373, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1609, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:42:44.232535+00:00", "memory": {"total": 33224306688, "available": 11712094208, "used": 21512212480, "percent": 64.7}, "disk": {"total": 1965300219904, "used": 865893896192, "free": 999499051008, "percent": 44.05911562124064}, "cpu": {"percent": 12.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:42:44.237837+00:00", "processing_duration": 0.003718, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n", "timestamp": "2025-10-23T10:42:44.237187+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11748106240, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 165, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 409, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:42:44.338095+00:00", "memory": {"total": 33224306688, "available": 11748106240, "used": 21476200448, "percent": 64.6}, "disk": {"total": 1965300219904, "used": 865893928960, "free": 999499018240, "percent": 44.0591172885686}, "cpu": {"percent": 9.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T10:42:51.684328+00:00", "processing_duration": 0.00389, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T10:42:51.683825+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12698439680, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-59/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:42:51.784589+00:00", "memory": {"total": 33224306688, "available": 12698439680, "used": 20525867008, "percent": 61.8}, "disk": {"total": 1965300219904, "used": 865894100992, "free": 999498846208, "percent": 44.059126042040376}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T10:42:51.790942+00:00", "processing_duration": 0.004205, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T10:42:51.790056+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12698193920, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-59/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:42:51.891221+00:00", "memory": {"total": 33224306688, "available": 12698193920, "used": 20526112768, "percent": 61.8}, "disk": {"total": 1965300219904, "used": 865894129664, "free": 999498817536, "percent": 44.059127500952336}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T10:42:51.897685+00:00", "processing_duration": 0.003975, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T10:42:51.897118+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12702597120, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-59/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:42:51.997983+00:00", "memory": {"total": 33224306688, "available": 12702597120, "used": 20521709568, "percent": 61.8}, "disk": {"total": 1965300219904, "used": 865894154240, "free": 999498792960, "percent": 44.0591287514483}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T10:42:52.004422+00:00", "processing_duration": 0.004027, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T10:42:52.003956+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12703244288, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-59/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:42:52.104683+00:00", "memory": {"total": 33224306688, "available": 12703244288, "used": 20521062400, "percent": 61.8}, "disk": {"total": 1965300219904, "used": 865894187008, "free": 999498760192, "percent": 44.05913041877626}, "cpu": {"percent": 4.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_data", "failure_time": "2025-10-23T10:47:54.487593+00:00", "processing_duration": 0.00983, "error_context": {"dataset_name": "test_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:47:54.486948+00:00", "processing_duration": 0.009181, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12048158720, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:47:54.587900+00:00", "memory": {"total": 33224306688, "available": 12048158720, "used": 21176147968, "percent": 63.7}, "disk": {"total": 1965300219904, "used": 865855557632, "free": 999537389568, "percent": 44.057164847531276}, "cpu": {"percent": 11.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T10:47:54.593052+00:00", "processing_duration": 0.002948, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:47:54.592689+00:00", "processing_duration": 0.002583, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11867578368, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:47:54.693279+00:00", "memory": {"total": 33224306688, "available": 11867578368, "used": 21356728320, "percent": 64.3}, "disk": {"total": 1965300219904, "used": 865855586304, "free": 999537360896, "percent": 44.05716630644324}, "cpu": {"percent": 7.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T10:47:54.699876+00:00", "processing_duration": 0.003449, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:47:54.699353+00:00", "processing_duration": 0.002923, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11819692032, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:47:54.800179+00:00", "memory": {"total": 33224306688, "available": 11819692032, "used": 21404614656, "percent": 64.4}, "disk": {"total": 1965300219904, "used": 865855619072, "free": 999537328128, "percent": 44.0571679737712}, "cpu": {"percent": 7.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:47:55.100987+00:00", "processing_duration": 0.002735, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T10:47:55.100666+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11651624960, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:47:55.201318+00:00", "memory": {"total": 33224306688, "available": 11651170304, "used": 21573136384, "percent": 64.9}, "disk": {"total": 1965300219904, "used": 865855942656, "free": 999537004544, "percent": 44.05718443863477}, "cpu": {"percent": 32.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:47:55.206967+00:00", "processing_duration": 0.003727, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T10:47:55.206192+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11613937664, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-60/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 373, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1609, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:47:55.307311+00:00", "memory": {"total": 33224306688, "available": 11638939648, "used": 21585367040, "percent": 65.0}, "disk": {"total": 1965300219904, "used": 865855971328, "free": 999536975872, "percent": 44.05718589754673}, "cpu": {"percent": 14.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:47:55.312822+00:00", "processing_duration": 0.00393, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n", "timestamp": "2025-10-23T10:47:55.312033+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11876585472, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 409, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:47:55.413096+00:00", "memory": {"total": 33224306688, "available": 11876585472, "used": 21347721216, "percent": 64.3}, "disk": {"total": 1965300219904, "used": 865856004096, "free": 999536943104, "percent": 44.05718756487469}, "cpu": {"percent": 6.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T10:48:03.545455+00:00", "processing_duration": 0.004487, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T10:48:03.544924+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12876091392, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-60/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:48:03.645752+00:00", "memory": {"total": 33224306688, "available": 12876091392, "used": 20348215296, "percent": 61.2}, "disk": {"total": 1965300219904, "used": 865856180224, "free": 999536766976, "percent": 44.05719652676245}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T10:48:03.652773+00:00", "processing_duration": 0.00487, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T10:48:03.652256+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12875247616, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-60/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:48:03.752998+00:00", "memory": {"total": 33224306688, "available": 12875247616, "used": 20349059072, "percent": 61.2}, "disk": {"total": 1965300219904, "used": 865856208896, "free": 999536738304, "percent": 44.05719798567442}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T10:48:03.759378+00:00", "processing_duration": 0.004417, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T10:48:03.758928+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12883210240, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-60/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Missing required columns. Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:48:03.859608+00:00", "memory": {"total": 33224306688, "available": 12883210240, "used": 20341096448, "percent": 61.2}, "disk": {"total": 1965300219904, "used": 865856237568, "free": 999536709632, "percent": 44.05719944458638}, "cpu": {"percent": 4.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T10:48:03.864767+00:00", "processing_duration": 0.003202, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T10:48:03.864302+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12885012480, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-60/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:48:03.964985+00:00", "memory": {"total": 33224306688, "available": 12885012480, "used": 20339294208, "percent": 61.2}, "disk": {"total": 1965300219904, "used": 865856270336, "free": 999536676864, "percent": 44.05720111191434}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_data", "failure_time": "2025-10-23T10:50:30.675465+00:00", "processing_duration": 0.00974, "error_context": {"dataset_name": "test_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:50:30.674817+00:00", "processing_duration": 0.009087, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11660611584, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:50:30.775717+00:00", "memory": {"total": 33224306688, "available": 11660611584, "used": 21563695104, "percent": 64.9}, "disk": {"total": 1965300219904, "used": 865864863744, "free": 999528083456, "percent": 44.057638368670986}, "cpu": {"percent": 8.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T10:50:30.780660+00:00", "processing_duration": 0.003076, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:50:30.780216+00:00", "processing_duration": 0.00263, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11478192128, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:50:30.880906+00:00", "memory": {"total": 33224306688, "available": 11478192128, "used": 21746114560, "percent": 65.5}, "disk": {"total": 1965300219904, "used": 865864888320, "free": 999528058880, "percent": 44.057639619166956}, "cpu": {"percent": 11.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T10:50:30.886948+00:00", "processing_duration": 0.003036, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:50:30.886548+00:00", "processing_duration": 0.002633, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12005523456, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:50:30.987326+00:00", "memory": {"total": 33224306688, "available": 12005724160, "used": 21218582528, "percent": 63.9}, "disk": {"total": 1965300219904, "used": 865864908800, "free": 999528038400, "percent": 44.05764066124693}, "cpu": {"percent": 16.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:50:31.285783+00:00", "processing_duration": 0.00304, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T10:50:31.285409+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11779608576, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:50:31.386159+00:00", "memory": {"total": 33224306688, "available": 11779608576, "used": 21444698112, "percent": 64.5}, "disk": {"total": 1965300219904, "used": 865865236480, "free": 999527710720, "percent": 44.057657334526496}, "cpu": {"percent": 6.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:50:31.391993+00:00", "processing_duration": 0.004013, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T10:50:31.391257+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12165705728, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-61/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 373, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1609, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:50:31.492300+00:00", "memory": {"total": 33224306688, "available": 12165705728, "used": 21058600960, "percent": 63.4}, "disk": {"total": 1965300219904, "used": 865865269248, "free": 999527677952, "percent": 44.057659001854454}, "cpu": {"percent": 6.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:50:31.498471+00:00", "processing_duration": 0.004338, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n", "timestamp": "2025-10-23T10:50:31.497653+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12015431680, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 409, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:50:31.598736+00:00", "memory": {"total": 33224306688, "available": 12015431680, "used": 21208875008, "percent": 63.8}, "disk": {"total": 1965300219904, "used": 865865302016, "free": 999527645184, "percent": 44.05766066918241}, "cpu": {"percent": 7.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T10:50:39.629272+00:00", "processing_duration": 0.004019, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T10:50:39.628768+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12572602368, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-61/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:50:39.729541+00:00", "memory": {"total": 33224306688, "available": 12572602368, "used": 20651704320, "percent": 62.2}, "disk": {"total": 1965300219904, "used": 865865498624, "free": 999527448576, "percent": 44.05767067315015}, "cpu": {"percent": 5.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T10:50:39.735118+00:00", "processing_duration": 0.003389, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T10:50:39.734667+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12572778496, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-61/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:50:39.835391+00:00", "memory": {"total": 33224306688, "available": 12572778496, "used": 20651528192, "percent": 62.2}, "disk": {"total": 1965300219904, "used": 865865523200, "free": 999527424000, "percent": 44.05767192364612}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T10:50:39.842101+00:00", "processing_duration": 0.004145, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T10:50:39.841630+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12578762752, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-61/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Missing required columns. Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:50:39.942376+00:00", "memory": {"total": 33224306688, "available": 12578762752, "used": 20645543936, "percent": 62.1}, "disk": {"total": 1965300219904, "used": 865865551872, "free": 999527395328, "percent": 44.05767338255808}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T10:50:39.948650+00:00", "processing_duration": 0.003923, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T10:50:39.948176+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12576317440, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-61/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:50:40.048931+00:00", "memory": {"total": 33224306688, "available": 12576317440, "used": 20647989248, "percent": 62.1}, "disk": {"total": 1965300219904, "used": 865865576448, "free": 999527370752, "percent": 44.05767463305404}, "cpu": {"percent": 4.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_data", "failure_time": "2025-10-23T10:51:28.475516+00:00", "processing_duration": 0.008824, "error_context": {"dataset_name": "test_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:51:28.474888+00:00", "processing_duration": 0.008191, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11639787520, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:51:28.575825+00:00", "memory": {"total": 33224306688, "available": 11639787520, "used": 21584519168, "percent": 65.0}, "disk": {"total": 1965300219904, "used": 865869332480, "free": 999523614720, "percent": 44.05786575052109}, "cpu": {"percent": 11.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T10:51:28.581056+00:00", "processing_duration": 0.003036, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:51:28.580589+00:00", "processing_duration": 0.002567, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11588620288, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:51:28.681338+00:00", "memory": {"total": 33224306688, "available": 11588620288, "used": 21635686400, "percent": 65.1}, "disk": {"total": 1965300219904, "used": 865869365248, "free": 999523581952, "percent": 44.057867417849046}, "cpu": {"percent": 9.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T10:51:28.687038+00:00", "processing_duration": 0.003031, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:51:28.686694+00:00", "processing_duration": 0.002685, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11423232000, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:51:28.787312+00:00", "memory": {"total": 33224306688, "available": 11423232000, "used": 21801074688, "percent": 65.6}, "disk": {"total": 1965300219904, "used": 865869389824, "free": 999523557376, "percent": 44.057868668345016}, "cpu": {"percent": 8.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:51:29.097158+00:00", "processing_duration": 0.002849, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T10:51:29.096769+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11416735744, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:51:29.197489+00:00", "memory": {"total": 33224306688, "available": 11416219648, "used": 21808087040, "percent": 65.6}, "disk": {"total": 1965300219904, "used": 865869717504, "free": 999523229696, "percent": 44.057885341624576}, "cpu": {"percent": 35.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:51:29.202766+00:00", "processing_duration": 0.00354, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T10:51:29.202136+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11550584832, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-62/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 373, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1609, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:51:29.303081+00:00", "memory": {"total": 33224306688, "available": 11567104000, "used": 21657202688, "percent": 65.2}, "disk": {"total": 1965300219904, "used": 865869746176, "free": 999523201024, "percent": 44.05788680053654}, "cpu": {"percent": 14.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:51:29.308604+00:00", "processing_duration": 0.003883, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n", "timestamp": "2025-10-23T10:51:29.307920+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11660996608, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 409, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:51:29.408859+00:00", "memory": {"total": 33224306688, "available": 11660996608, "used": 21563310080, "percent": 64.9}, "disk": {"total": 1965300219904, "used": 865869783040, "free": 999523164160, "percent": 44.05788867628049}, "cpu": {"percent": 8.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T10:51:37.448801+00:00", "processing_duration": 0.004217, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T10:51:37.448251+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12621553664, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-62/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:51:37.549096+00:00", "memory": {"total": 33224306688, "available": 12621553664, "used": 20602753024, "percent": 62.0}, "disk": {"total": 1965300219904, "used": 865869987840, "free": 999522959360, "percent": 44.057899097080224}, "cpu": {"percent": 5.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T10:51:37.555379+00:00", "processing_duration": 0.004013, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T10:51:37.554876+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12628549632, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-62/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:51:37.655679+00:00", "memory": {"total": 33224306688, "available": 12628549632, "used": 20595757056, "percent": 62.0}, "disk": {"total": 1965300219904, "used": 865870008320, "free": 999522938880, "percent": 44.057900139160196}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T10:51:37.661730+00:00", "processing_duration": 0.003945, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T10:51:37.661278+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12637339648, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-62/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Missing required columns. Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:51:37.761996+00:00", "memory": {"total": 33224306688, "available": 12637339648, "used": 20586967040, "percent": 62.0}, "disk": {"total": 1965300219904, "used": 865870041088, "free": 999522906112, "percent": 44.05790180648815}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T10:51:37.767372+00:00", "processing_duration": 0.003373, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T10:51:37.766919+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12638932992, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-62/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:51:37.867599+00:00", "memory": {"total": 33224306688, "available": 12638932992, "used": 20585373696, "percent": 62.0}, "disk": {"total": 1965300219904, "used": 865870073856, "free": 999522873344, "percent": 44.057903473816104}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_data", "failure_time": "2025-10-23T11:07:57.152205+00:00", "processing_duration": 0.009487, "error_context": {"dataset_name": "test_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T11:07:57.151432+00:00", "processing_duration": 0.00871, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10319953920, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:07:57.252534+00:00", "memory": {"total": 33224306688, "available": 10311696384, "used": 22912610304, "percent": 69.0}, "disk": {"total": 1965300219904, "used": 865882521600, "free": 999510425600, "percent": 44.058536850023664}, "cpu": {"percent": 14.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T11:07:57.257860+00:00", "processing_duration": 0.003165, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T11:07:57.257369+00:00", "processing_duration": 0.002672, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10158137344, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:07:57.358135+00:00", "memory": {"total": 33224306688, "available": 10149879808, "used": 23074426880, "percent": 69.5}, "disk": {"total": 1965300219904, "used": 865882550272, "free": 999510396928, "percent": 44.05853830893563}, "cpu": {"percent": 11.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T11:07:57.363910+00:00", "processing_duration": 0.002991, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T11:07:57.363546+00:00", "processing_duration": 0.002625, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 9850830848, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:07:57.464163+00:00", "memory": {"total": 33224306688, "available": 9850830848, "used": 23373475840, "percent": 70.4}, "disk": {"total": 1965300219904, "used": 865882583040, "free": 999510364160, "percent": 44.05853997626358}, "cpu": {"percent": 14.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T11:07:57.768831+00:00", "processing_duration": 0.002754, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T11:07:57.768423+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10495926272, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:07:57.869132+00:00", "memory": {"total": 33224306688, "available": 10495926272, "used": 22728380416, "percent": 68.4}, "disk": {"total": 1965300219904, "used": 865882890240, "free": 999510056960, "percent": 44.05855560746318}, "cpu": {"percent": 11.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T11:07:57.873716+00:00", "processing_duration": 0.003153, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T11:07:57.873150+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10367528960, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-63/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 373, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1609, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:07:57.973960+00:00", "memory": {"total": 33224306688, "available": 10367528960, "used": 22856777728, "percent": 68.8}, "disk": {"total": 1965300219904, "used": 865882923008, "free": 999510024192, "percent": 44.05855727479114}, "cpu": {"percent": 13.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T11:07:57.980087+00:00", "processing_duration": 0.004179, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n", "timestamp": "2025-10-23T11:07:57.979297+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10194595840, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 409, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:07:58.080457+00:00", "memory": {"total": 33224306688, "available": 10194595840, "used": 23029710848, "percent": 69.3}, "disk": {"total": 1965300219904, "used": 865883041792, "free": 999509905408, "percent": 44.05856331885498}, "cpu": {"percent": 12.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T11:08:07.133016+00:00", "processing_duration": 0.005156, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T11:08:07.132169+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11219619840, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-63/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:08:07.233387+00:00", "memory": {"total": 33224306688, "available": 11219103744, "used": 22005202944, "percent": 66.2}, "disk": {"total": 1965300219904, "used": 865883320320, "free": 999509626880, "percent": 44.058577491142614}, "cpu": {"percent": 6.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T11:08:07.239654+00:00", "processing_duration": 0.003769, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T11:08:07.239156+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11219697664, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-63/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:08:07.339912+00:00", "memory": {"total": 33224306688, "available": 11219697664, "used": 22004609024, "percent": 66.2}, "disk": {"total": 1965300219904, "used": 865883348992, "free": 999509598208, "percent": 44.058578950054574}, "cpu": {"percent": 6.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T11:08:07.346733+00:00", "processing_duration": 0.00443, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T11:08:07.346202+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11219210240, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-63/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Missing required columns. Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:08:07.447036+00:00", "memory": {"total": 33224306688, "available": 11219210240, "used": 22005096448, "percent": 66.2}, "disk": {"total": 1965300219904, "used": 865883426816, "free": 999509520384, "percent": 44.058582909958474}, "cpu": {"percent": 6.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T11:08:07.454014+00:00", "processing_duration": 0.004194, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T11:08:07.453442+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11291320320, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-63/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:08:07.554313+00:00", "memory": {"total": 33224306688, "available": 11291320320, "used": 21932986368, "percent": 66.0}, "disk": {"total": 1965300219904, "used": 865883463680, "free": 999509483520, "percent": 44.05858478570242}, "cpu": {"percent": 6.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_data", "failure_time": "2025-10-23T11:13:35.415449+00:00", "processing_duration": 0.009624, "error_context": {"dataset_name": "test_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T11:13:35.414743+00:00", "processing_duration": 0.008914, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10502631424, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:13:35.515757+00:00", "memory": {"total": 33224306688, "available": 10502135808, "used": 22722170880, "percent": 68.4}, "disk": {"total": 1965300219904, "used": 865881169920, "free": 999511777280, "percent": 44.058468072745455}, "cpu": {"percent": 14.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T11:13:35.521076+00:00", "processing_duration": 0.002827, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T11:13:35.520720+00:00", "processing_duration": 0.002469, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10385756160, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:13:35.621320+00:00", "memory": {"total": 33224306688, "available": 10385756160, "used": 22838550528, "percent": 68.7}, "disk": {"total": 1965300219904, "used": 865881202688, "free": 999511744512, "percent": 44.058469740073406}, "cpu": {"percent": 15.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T11:13:35.627808+00:00", "processing_duration": 0.00363, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T11:13:35.627401+00:00", "processing_duration": 0.003221, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10821713920, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:13:35.728110+00:00", "memory": {"total": 33224306688, "available": 10820939776, "used": 22403366912, "percent": 67.4}, "disk": {"total": 1965300219904, "used": 865881227264, "free": 999511719936, "percent": 44.058470990569376}, "cpu": {"percent": 17.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T11:13:36.032463+00:00", "processing_duration": 0.00322, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T11:13:36.032022+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10442223616, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:13:36.132797+00:00", "memory": {"total": 33224306688, "available": 10442223616, "used": 22782083072, "percent": 68.6}, "disk": {"total": 1965300219904, "used": 865881546752, "free": 999511400448, "percent": 44.058487247016956}, "cpu": {"percent": 16.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T11:13:36.138384+00:00", "processing_duration": 0.003713, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T11:13:36.137755+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10572103680, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-64/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 373, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1609, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:13:36.238672+00:00", "memory": {"total": 33224306688, "available": 10570297344, "used": 22654009344, "percent": 68.2}, "disk": {"total": 1965300219904, "used": 865881583616, "free": 999511363584, "percent": 44.05848912276091}, "cpu": {"percent": 14.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T11:13:36.244058+00:00", "processing_duration": 0.003725, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n", "timestamp": "2025-10-23T11:13:36.243401+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10253983744, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 409, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:13:36.344348+00:00", "memory": {"total": 33224306688, "available": 10253983744, "used": 22970322944, "percent": 69.1}, "disk": {"total": 1965300219904, "used": 865881612288, "free": 999511334912, "percent": 44.058490581672864}, "cpu": {"percent": 15.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T11:13:43.911808+00:00", "processing_duration": 0.003394, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T11:13:43.911331+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11206815744, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-64/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:13:44.012044+00:00", "memory": {"total": 33224306688, "available": 11206815744, "used": 22017490944, "percent": 66.3}, "disk": {"total": 1965300219904, "used": 865881804800, "free": 999511142400, "percent": 44.05850037722461}, "cpu": {"percent": 6.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T11:13:44.017612+00:00", "processing_duration": 0.003621, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T11:13:44.017163+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11217203200, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-64/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:13:44.117849+00:00", "memory": {"total": 33224306688, "available": 11217203200, "used": 22007103488, "percent": 66.2}, "disk": {"total": 1965300219904, "used": 865881837568, "free": 999511109632, "percent": 44.05850204455257}, "cpu": {"percent": 5.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T11:13:44.125668+00:00", "processing_duration": 0.005958, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T11:13:44.125118+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11215826944, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-64/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Missing required columns. Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:13:44.225970+00:00", "memory": {"total": 33224306688, "available": 11215826944, "used": 22008479744, "percent": 66.2}, "disk": {"total": 1965300219904, "used": 865881858048, "free": 999511089152, "percent": 44.05850308663254}, "cpu": {"percent": 5.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T11:13:44.232324+00:00", "processing_duration": 0.003888, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T11:13:44.231765+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11216191488, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-64/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:13:44.332583+00:00", "memory": {"total": 33224306688, "available": 11216191488, "used": 22008115200, "percent": 66.2}, "disk": {"total": 1965300219904, "used": 865881890816, "free": 999511056384, "percent": 44.0585047539605}, "cpu": {"percent": 5.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_data", "failure_time": "2025-10-23T11:16:57.723956+00:00", "processing_duration": 0.008409, "error_context": {"dataset_name": "test_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T11:16:57.723327+00:00", "processing_duration": 0.007777, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10780991488, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:16:57.824276+00:00", "memory": {"total": 33224306688, "available": 10780991488, "used": 22443315200, "percent": 67.6}, "disk": {"total": 1965300219904, "used": 865894928384, "free": 999498018816, "percent": 44.05916814207128}, "cpu": {"percent": 10.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T11:16:57.830576+00:00", "processing_duration": 0.003654, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T11:16:57.830065+00:00", "processing_duration": 0.003139, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10612404224, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:16:57.930984+00:00", "memory": {"total": 33224306688, "available": 10612404224, "used": 22611902464, "percent": 68.1}, "disk": {"total": 1965300219904, "used": 865894961152, "free": 999497986048, "percent": 44.05916980939924}, "cpu": {"percent": 9.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T11:16:57.937330+00:00", "processing_duration": 0.003227, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T11:16:57.936772+00:00", "processing_duration": 0.002665, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10497953792, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:16:58.037629+00:00", "memory": {"total": 33224306688, "available": 10497953792, "used": 22726352896, "percent": 68.4}, "disk": {"total": 1965300219904, "used": 865894985728, "free": 999497961472, "percent": 44.059171059895206}, "cpu": {"percent": 9.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T11:16:58.350985+00:00", "processing_duration": 0.002655, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T11:16:58.350620+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10404667392, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:16:58.451306+00:00", "memory": {"total": 33224306688, "available": 10404667392, "used": 22819639296, "percent": 68.7}, "disk": {"total": 1965300219904, "used": 865895309312, "free": 999497637888, "percent": 44.059187524758784}, "cpu": {"percent": 27.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T11:16:58.456776+00:00", "processing_duration": 0.003632, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T11:16:58.456147+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10737385472, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-65/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 373, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1609, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:16:58.557025+00:00", "memory": {"total": 33224306688, "available": 10737385472, "used": 22486921216, "percent": 67.7}, "disk": {"total": 1965300219904, "used": 865895337984, "free": 999497609216, "percent": 44.05918898367074}, "cpu": {"percent": 7.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T11:16:58.561703+00:00", "processing_duration": 0.003284, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n", "timestamp": "2025-10-23T11:16:58.561039+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10613608448, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 409, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:16:58.661943+00:00", "memory": {"total": 33224306688, "available": 10613608448, "used": 22610698240, "percent": 68.1}, "disk": {"total": 1965300219904, "used": 865895378944, "free": 999497568256, "percent": 44.05919106783069}, "cpu": {"percent": 6.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T11:17:06.493368+00:00", "processing_duration": 0.004043, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T11:17:06.492882+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11430592512, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-65/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:17:06.593612+00:00", "memory": {"total": 33224306688, "available": 11430592512, "used": 21793714176, "percent": 65.6}, "disk": {"total": 1965300219904, "used": 865895649280, "free": 999497297920, "percent": 44.05920482328633}, "cpu": {"percent": 6.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T11:17:06.599844+00:00", "processing_duration": 0.003813, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T11:17:06.599381+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11445780480, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-65/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:17:06.700112+00:00", "memory": {"total": 33224306688, "available": 11445780480, "used": 21778526208, "percent": 65.5}, "disk": {"total": 1965300219904, "used": 865895673856, "free": 999497273344, "percent": 44.0592060737823}, "cpu": {"percent": 6.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T11:17:06.705762+00:00", "processing_duration": 0.003452, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T11:17:06.705305+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11446214656, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-65/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Missing required columns. Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:17:06.806037+00:00", "memory": {"total": 33224306688, "available": 11446214656, "used": 21778092032, "percent": 65.5}, "disk": {"total": 1965300219904, "used": 865895706624, "free": 999497240576, "percent": 44.05920774111025}, "cpu": {"percent": 6.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T11:17:06.812583+00:00", "processing_duration": 0.004311, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T11:17:06.812118+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11446898688, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-65/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:17:06.912857+00:00", "memory": {"total": 33224306688, "available": 11446898688, "used": 21777408000, "percent": 65.5}, "disk": {"total": 1965300219904, "used": 865895731200, "free": 999497216000, "percent": 44.05920899160622}, "cpu": {"percent": 7.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_data", "failure_time": "2025-10-23T11:18:58.153256+00:00", "processing_duration": 0.008757, "error_context": {"dataset_name": "test_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T11:18:58.152656+00:00", "processing_duration": 0.008153, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10510819328, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:18:58.253589+00:00", "memory": {"total": 33224306688, "available": 10510819328, "used": 22713487360, "percent": 68.4}, "disk": {"total": 1965300219904, "used": 865907716096, "free": 999485231104, "percent": 44.05981881680639}, "cpu": {"percent": 11.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T11:18:58.259599+00:00", "processing_duration": 0.003075, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T11:18:58.259157+00:00", "processing_duration": 0.002629, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10401259520, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:18:58.359987+00:00", "memory": {"total": 33224306688, "available": 10401259520, "used": 22823047168, "percent": 68.7}, "disk": {"total": 1965300219904, "used": 865907740672, "free": 999485206528, "percent": 44.059820067302354}, "cpu": {"percent": 10.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T11:18:58.366301+00:00", "processing_duration": 0.003123, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T11:18:58.365912+00:00", "processing_duration": 0.002731, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10235981824, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:18:58.466594+00:00", "memory": {"total": 33224306688, "available": 10235981824, "used": 22988324864, "percent": 69.2}, "disk": {"total": 1965300219904, "used": 865907773440, "free": 999485173760, "percent": 44.05982173463032}, "cpu": {"percent": 10.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T11:18:58.792253+00:00", "processing_duration": 0.003012, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T11:18:58.791568+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10305896448, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:18:58.892568+00:00", "memory": {"total": 33224306688, "available": 10313486336, "used": 22910820352, "percent": 69.0}, "disk": {"total": 1965300219904, "used": 865908109312, "free": 999484837888, "percent": 44.059838824741874}, "cpu": {"percent": 17.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T11:18:58.897769+00:00", "processing_duration": 0.003694, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T11:18:58.897175+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10597662720, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-66/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 373, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1609, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:18:58.998015+00:00", "memory": {"total": 33224306688, "available": 10589405184, "used": 22634901504, "percent": 68.1}, "disk": {"total": 1965300219904, "used": 865908133888, "free": 999484813312, "percent": 44.05984007523784}, "cpu": {"percent": 8.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T11:18:59.002918+00:00", "processing_duration": 0.003629, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n", "timestamp": "2025-10-23T11:18:59.002130+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10436362240, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 409, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:18:59.103189+00:00", "memory": {"total": 33224306688, "available": 10436362240, "used": 22787944448, "percent": 68.6}, "disk": {"total": 1965300219904, "used": 865908170752, "free": 999484776448, "percent": 44.05984195098179}, "cpu": {"percent": 11.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T11:19:07.072947+00:00", "processing_duration": 0.003966, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T11:19:07.072455+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11404730368, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-66/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:19:07.173185+00:00", "memory": {"total": 33224306688, "available": 11404730368, "used": 21819576320, "percent": 65.7}, "disk": {"total": 1965300219904, "used": 865908162560, "free": 999484784640, "percent": 44.059841534149804}, "cpu": {"percent": 7.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T11:19:07.178345+00:00", "processing_duration": 0.003259, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T11:19:07.177889+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11420991488, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-66/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:19:07.278579+00:00", "memory": {"total": 33224306688, "available": 11420991488, "used": 21803315200, "percent": 65.6}, "disk": {"total": 1965300219904, "used": 865908183040, "free": 999484764160, "percent": 44.05984257622978}, "cpu": {"percent": 6.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T11:19:07.284735+00:00", "processing_duration": 0.004163, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T11:19:07.284282+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11450163200, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-66/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Missing required columns. Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:19:07.384971+00:00", "memory": {"total": 33224306688, "available": 11450163200, "used": 21774143488, "percent": 65.5}, "disk": {"total": 1965300219904, "used": 865908215808, "free": 999484731392, "percent": 44.059844243557734}, "cpu": {"percent": 6.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T11:19:07.390346+00:00", "processing_duration": 0.00344, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T11:19:07.389891+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11449954304, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-66/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:19:07.490559+00:00", "memory": {"total": 33224306688, "available": 11449954304, "used": 21774352384, "percent": 65.5}, "disk": {"total": 1965300219904, "used": 865908215808, "free": 999484731392, "percent": 44.059844243557734}, "cpu": {"percent": 6.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_data", "failure_time": "2025-10-23T11:26:48.860580+00:00", "processing_duration": 0.009079, "error_context": {"dataset_name": "test_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T11:26:48.859955+00:00", "processing_duration": 0.00845, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10145533952, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:26:48.960850+00:00", "memory": {"total": 33224306688, "available": 10137276416, "used": 23087030272, "percent": 69.5}, "disk": {"total": 1965300219904, "used": 865903316992, "free": 999489630208, "percent": 44.0595949780282}, "cpu": {"percent": 15.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T11:26:48.967386+00:00", "processing_duration": 0.003115, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T11:26:48.966995+00:00", "processing_duration": 0.002721, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10337857536, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:26:49.067705+00:00", "memory": {"total": 33224306688, "available": 10343239680, "used": 22881067008, "percent": 68.9}, "disk": {"total": 1965300219904, "used": 865903341568, "free": 999489605632, "percent": 44.059596228524164}, "cpu": {"percent": 14.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T11:26:49.074761+00:00", "processing_duration": 0.003042, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T11:26:49.074313+00:00", "processing_duration": 0.002592, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10232872960, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:26:49.175037+00:00", "memory": {"total": 33224306688, "available": 10232872960, "used": 22991433728, "percent": 69.2}, "disk": {"total": 1965300219904, "used": 865903378432, "free": 999489568768, "percent": 44.05959810426812}, "cpu": {"percent": 17.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T11:26:49.483353+00:00", "processing_duration": 0.003212, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T11:26:49.483021+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10355924992, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:26:49.583624+00:00", "memory": {"total": 33224306688, "available": 10355924992, "used": 22868381696, "percent": 68.8}, "disk": {"total": 1965300219904, "used": 865904279552, "free": 999488667648, "percent": 44.05964395578693}, "cpu": {"percent": 9.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T11:26:49.588076+00:00", "processing_duration": 0.003184, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T11:26:49.587468+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10309677056, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-67/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 373, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1609, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:26:49.688315+00:00", "memory": {"total": 33224306688, "available": 10310004736, "used": 22914301952, "percent": 69.0}, "disk": {"total": 1965300219904, "used": 865904300032, "free": 999488647168, "percent": 44.059644997866904}, "cpu": {"percent": 12.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T11:26:49.692842+00:00", "processing_duration": 0.003224, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n", "timestamp": "2025-10-23T11:26:49.692198+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10185146368, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 409, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:26:49.793116+00:00", "memory": {"total": 33224306688, "available": 10185146368, "used": 23039160320, "percent": 69.3}, "disk": {"total": 1965300219904, "used": 865904328704, "free": 999488618496, "percent": 44.059646456778864}, "cpu": {"percent": 14.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T11:26:57.321293+00:00", "processing_duration": 0.004208, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T11:26:57.320831+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11174195200, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-67/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:26:57.421598+00:00", "memory": {"total": 33224306688, "available": 11174195200, "used": 22050111488, "percent": 66.4}, "disk": {"total": 1965300219904, "used": 865904439296, "free": 999488507904, "percent": 44.05965208401072}, "cpu": {"percent": 24.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T11:26:57.428004+00:00", "processing_duration": 0.004021, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T11:26:57.427406+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11180998656, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-67/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:26:57.528245+00:00", "memory": {"total": 33224306688, "available": 11180998656, "used": 22043308032, "percent": 66.3}, "disk": {"total": 1965300219904, "used": 865904476160, "free": 999488471040, "percent": 44.05965395975467}, "cpu": {"percent": 9.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T11:26:57.534161+00:00", "processing_duration": 0.003921, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T11:26:57.533704+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11181633536, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-67/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Missing required columns. Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:26:57.634401+00:00", "memory": {"total": 33224306688, "available": 11181633536, "used": 22042673152, "percent": 66.3}, "disk": {"total": 1965300219904, "used": 865904500736, "free": 999488446464, "percent": 44.05965521025064}, "cpu": {"percent": 9.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T11:26:57.640095+00:00", "processing_duration": 0.003777, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T11:26:57.639624+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11235856384, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-67/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:26:57.740371+00:00", "memory": {"total": 33224306688, "available": 11235856384, "used": 21988450304, "percent": 66.2}, "disk": {"total": 1965300219904, "used": 865904533504, "free": 999488413696, "percent": 44.0596568775786}, "cpu": {"percent": 11.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_data", "failure_time": "2025-10-23T11:27:00.137750+00:00", "processing_duration": 0.009697, "error_context": {"dataset_name": "test_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T11:27:00.137081+00:00", "processing_duration": 0.009024, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10926575616, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:27:00.238018+00:00", "memory": {"total": 33224306688, "available": 10926575616, "used": 22297731072, "percent": 67.1}, "disk": {"total": 1965300219904, "used": 865904033792, "free": 999488913408, "percent": 44.05963145082726}, "cpu": {"percent": 12.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T11:28:14.278774+00:00", "processing_duration": 0.010949, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n", "timestamp": "2025-10-23T11:28:14.277706+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10625228800, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 211, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:28:14.379128+00:00", "memory": {"total": 33224306688, "available": 10625228800, "used": 22599077888, "percent": 68.0}, "disk": {"total": 1965300219904, "used": 865903853568, "free": 999489093632, "percent": 44.05962228052349}, "cpu": {"percent": 11.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T11:29:28.810723+00:00", "processing_duration": 0.010356, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T11:29:28.809499+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10165559296, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 211, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:29:28.911053+00:00", "memory": {"total": 33224306688, "available": 10163888128, "used": 23060418560, "percent": 69.4}, "disk": {"total": 1965300219904, "used": 865880793088, "free": 999512154112, "percent": 44.05844889847395}, "cpu": {"percent": 9.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T11:29:37.762400+00:00", "processing_duration": 0.00958, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T11:29:37.761553+00:00", "processing_duration": 0.008729, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 9914716160, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 304, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:29:37.862821+00:00", "memory": {"total": 33224306688, "available": 9918406656, "used": 23305900032, "percent": 70.1}, "disk": {"total": 1965300219904, "used": 865881939968, "free": 999511007232, "percent": 44.05850725495243}, "cpu": {"percent": 15.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T11:46:26.867898+00:00", "processing_duration": 0.004544, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T11:46:26.866843+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10540707840, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 211, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:46:26.968270+00:00", "memory": {"total": 33224306688, "available": 10540707840, "used": 22683598848, "percent": 68.3}, "disk": {"total": 1965300219904, "used": 865899470848, "free": 999493476352, "percent": 44.059399275409284}, "cpu": {"percent": 20.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T11:46:27.181705+00:00", "processing_duration": 0.003468, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T11:46:27.181335+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10422337536, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:46:27.282067+00:00", "memory": {"total": 33224306688, "available": 10422337536, "used": 22801969152, "percent": 68.6}, "disk": {"total": 1965300219904, "used": 865899806720, "free": 999493140480, "percent": 44.05941636552084}, "cpu": {"percent": 9.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T11:46:27.287531+00:00", "processing_duration": 0.003504, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T11:46:27.286899+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10298408960, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-75/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:46:27.387806+00:00", "memory": {"total": 33224306688, "available": 10298408960, "used": 22925897728, "percent": 69.0}, "disk": {"total": 1965300219904, "used": 865899843584, "free": 999493103616, "percent": 44.059418241264794}, "cpu": {"percent": 10.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T11:46:27.392932+00:00", "processing_duration": 0.003604, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T11:46:27.392400+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10783813632, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:46:27.493194+00:00", "memory": {"total": 33224306688, "available": 10783617024, "used": 22440689664, "percent": 67.5}, "disk": {"total": 1965300219904, "used": 865899868160, "free": 999493079040, "percent": 44.05941949176076}, "cpu": {"percent": 10.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T11:46:35.020575+00:00", "processing_duration": 0.003495, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T11:46:35.020076+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10980589568, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-75/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:46:35.120870+00:00", "memory": {"total": 33224306688, "available": 10980589568, "used": 22243717120, "percent": 67.0}, "disk": {"total": 1965300219904, "used": 865900032000, "free": 999492915200, "percent": 44.05942782840054}, "cpu": {"percent": 10.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T11:46:35.127206+00:00", "processing_duration": 0.004159, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T11:46:35.126710+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10982432768, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-75/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:46:35.227448+00:00", "memory": {"total": 33224306688, "available": 10982432768, "used": 22241873920, "percent": 66.9}, "disk": {"total": 1965300219904, "used": 865900060672, "free": 999492886528, "percent": 44.059429287312504}, "cpu": {"percent": 9.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T11:46:35.233792+00:00", "processing_duration": 0.004362, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T11:46:35.233315+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11004370944, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-75/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Missing required columns. Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:46:35.334042+00:00", "memory": {"total": 33224306688, "available": 11004370944, "used": 22219935744, "percent": 66.9}, "disk": {"total": 1965300219904, "used": 865900085248, "free": 999492861952, "percent": 44.05943053780847}, "cpu": {"percent": 10.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T11:46:35.341788+00:00", "processing_duration": 0.005435, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T11:46:35.341199+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11019075584, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-75/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:46:35.442118+00:00", "memory": {"total": 33224306688, "available": 11019075584, "used": 22205231104, "percent": 66.8}, "disk": {"total": 1965300219904, "used": 865900109824, "free": 999492837376, "percent": 44.05943178830444}, "cpu": {"percent": 12.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T11:46:53.487771+00:00", "processing_duration": 0.003631, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T11:46:53.486905+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10190323712, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 211, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:46:53.588036+00:00", "memory": {"total": 33224306688, "available": 10190323712, "used": 23033982976, "percent": 69.3}, "disk": {"total": 1965300219904, "used": 865900830720, "free": 999492116480, "percent": 44.05946846951949}, "cpu": {"percent": 10.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T11:46:53.799053+00:00", "processing_duration": 0.002629, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T11:46:53.798738+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10185850880, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:46:53.899319+00:00", "memory": {"total": 33224306688, "available": 10185850880, "used": 23038455808, "percent": 69.3}, "disk": {"total": 1965300219904, "used": 865901174784, "free": 999491772416, "percent": 44.05948597646303}, "cpu": {"percent": 10.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T11:46:53.904033+00:00", "processing_duration": 0.003334, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T11:46:53.903464+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10071089152, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-76/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:46:54.004305+00:00", "memory": {"total": 33224306688, "available": 10071089152, "used": 23153217536, "percent": 69.7}, "disk": {"total": 1965300219904, "used": 865901199360, "free": 999491747840, "percent": 44.059487226959}, "cpu": {"percent": 9.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T11:46:54.009525+00:00", "processing_duration": 0.003276, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T11:46:54.009003+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10393845760, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:46:54.109758+00:00", "memory": {"total": 33224306688, "available": 10393845760, "used": 22830460928, "percent": 68.7}, "disk": {"total": 1965300219904, "used": 865901232128, "free": 999491715072, "percent": 44.05948889428696}, "cpu": {"percent": 10.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T11:47:02.735889+00:00", "processing_duration": 0.004049, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T11:47:02.735264+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11072094208, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-76/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:47:02.836214+00:00", "memory": {"total": 33224306688, "available": 11072094208, "used": 22152212480, "percent": 66.7}, "disk": {"total": 1965300219904, "used": 865901469696, "free": 999491477504, "percent": 44.05950098241464}, "cpu": {"percent": 6.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T11:47:02.842798+00:00", "processing_duration": 0.00435, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T11:47:02.842226+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11079806976, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-76/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:47:02.943152+00:00", "memory": {"total": 33224306688, "available": 11079806976, "used": 22144499712, "percent": 66.7}, "disk": {"total": 1965300219904, "used": 865901490176, "free": 999491457024, "percent": 44.05950202449461}, "cpu": {"percent": 5.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T11:47:02.949409+00:00", "processing_duration": 0.003899, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T11:47:02.948931+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11078385664, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-76/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Missing required columns. Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:47:03.049688+00:00", "memory": {"total": 33224306688, "available": 11078385664, "used": 22145921024, "percent": 66.7}, "disk": {"total": 1965300219904, "used": 865901518848, "free": 999491428352, "percent": 44.05950348340657}, "cpu": {"percent": 6.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T11:47:03.057064+00:00", "processing_duration": 0.00436, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T11:47:03.056574+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11078651904, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-76/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:47:03.157340+00:00", "memory": {"total": 33224306688, "available": 11078651904, "used": 22145654784, "percent": 66.7}, "disk": {"total": 1965300219904, "used": 865901547520, "free": 999491399680, "percent": 44.05950494231854}, "cpu": {"percent": 6.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T11:54:20.471351+00:00", "processing_duration": 0.004316, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T11:54:20.470394+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10072170496, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 213, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:54:20.571672+00:00", "memory": {"total": 33224306688, "available": 10072170496, "used": 23152136192, "percent": 69.7}, "disk": {"total": 1965300219904, "used": 865912721408, "free": 999480225792, "percent": 44.060073501151784}, "cpu": {"percent": 15.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T11:54:20.785401+00:00", "processing_duration": 0.002992, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T11:54:20.785086+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 9587589120, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:54:20.885663+00:00", "memory": {"total": 33224306688, "available": 9584275456, "used": 23640031232, "percent": 71.2}, "disk": {"total": 1965300219904, "used": 865913069568, "free": 999479877632, "percent": 44.060091216511324}, "cpu": {"percent": 13.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T11:54:20.890738+00:00", "processing_duration": 0.003931, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T11:54:20.890012+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 9309487104, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-77/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:54:20.991101+00:00", "memory": {"total": 33224306688, "available": 9309487104, "used": 23914819584, "percent": 72.0}, "disk": {"total": 1965300219904, "used": 865913098240, "free": 999479848960, "percent": 44.060092675423284}, "cpu": {"percent": 12.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T11:54:20.997055+00:00", "processing_duration": 0.004026, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T11:54:20.996364+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10114273280, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 170, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:54:21.097435+00:00", "memory": {"total": 33224306688, "available": 10114273280, "used": 23110033408, "percent": 69.6}, "disk": {"total": 1965300219904, "used": 865913131008, "free": 999479816192, "percent": 44.060094342751235}, "cpu": {"percent": 10.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T11:54:28.912345+00:00", "processing_duration": 0.004385, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T11:54:28.911797+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10700378112, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-77/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:54:29.012653+00:00", "memory": {"total": 33224306688, "available": 10700378112, "used": 22523928576, "percent": 67.8}, "disk": {"total": 1965300219904, "used": 865913344000, "free": 999479603200, "percent": 44.060105180382955}, "cpu": {"percent": 6.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T11:54:29.019484+00:00", "processing_duration": 0.004609, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T11:54:29.018987+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10700124160, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-77/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:54:29.119804+00:00", "memory": {"total": 33224306688, "available": 10700124160, "used": 22524182528, "percent": 67.8}, "disk": {"total": 1965300219904, "used": 865913368576, "free": 999479578624, "percent": 44.060106430878925}, "cpu": {"percent": 6.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T11:54:29.125890+00:00", "processing_duration": 0.003828, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T11:54:29.125366+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10700328960, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-77/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Missing required columns. Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:54:29.226147+00:00", "memory": {"total": 33224306688, "available": 10700328960, "used": 22523977728, "percent": 67.8}, "disk": {"total": 1965300219904, "used": 865913393152, "free": 999479554048, "percent": 44.060107681374895}, "cpu": {"percent": 11.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T11:54:29.231974+00:00", "processing_duration": 0.003682, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T11:54:29.231474+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10695147520, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-77/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:54:29.332268+00:00", "memory": {"total": 33224306688, "available": 10695147520, "used": 22529159168, "percent": 67.8}, "disk": {"total": 1965300219904, "used": 865913425920, "free": 999479521280, "percent": 44.06010934870285}, "cpu": {"percent": 18.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T11:57:06.428861+00:00", "processing_duration": 0.00385, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T11:57:06.427750+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 9735876608, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 213, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:57:06.529140+00:00", "memory": {"total": 33224306688, "available": 9735876608, "used": 23488430080, "percent": 70.7}, "disk": {"total": 1965300219904, "used": 865923432448, "free": 999469514752, "percent": 44.06061850897763}, "cpu": {"percent": 17.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T11:57:06.742381+00:00", "processing_duration": 0.003395, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T11:57:06.741930+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 9333919744, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:57:06.842694+00:00", "memory": {"total": 33224306688, "available": 9333919744, "used": 23890386944, "percent": 71.9}, "disk": {"total": 1965300219904, "used": 865923772416, "free": 999469174784, "percent": 44.060635807505186}, "cpu": {"percent": 17.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T11:57:06.847500+00:00", "processing_duration": 0.003252, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T11:57:06.846910+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 9064361984, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-78/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:57:06.947795+00:00", "memory": {"total": 33224306688, "available": 9064361984, "used": 24159944704, "percent": 72.7}, "disk": {"total": 1965300219904, "used": 865923801088, "free": 999469146112, "percent": 44.060637266417146}, "cpu": {"percent": 19.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T11:57:06.954074+00:00", "processing_duration": 0.004033, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T11:57:06.953473+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 9525866496, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 170, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:57:07.054363+00:00", "memory": {"total": 33224306688, "available": 9524948992, "used": 23699357696, "percent": 71.3}, "disk": {"total": 1965300219904, "used": 865923829760, "free": 999469117440, "percent": 44.06063872532911}, "cpu": {"percent": 20.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T11:57:14.346931+00:00", "processing_duration": 0.004884, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T11:57:14.346256+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10214100992, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-78/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:57:14.447243+00:00", "memory": {"total": 33224306688, "available": 10214379520, "used": 23009927168, "percent": 69.3}, "disk": {"total": 1965300219904, "used": 865924030464, "free": 999468916736, "percent": 44.06064893771285}, "cpu": {"percent": 6.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T11:57:14.453377+00:00", "processing_duration": 0.00391, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T11:57:14.452879+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10255994880, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-78/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:57:14.553617+00:00", "memory": {"total": 33224306688, "available": 10255994880, "used": 22968311808, "percent": 69.1}, "disk": {"total": 1965300219904, "used": 865924050944, "free": 999468896256, "percent": 44.06064997979282}, "cpu": {"percent": 6.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T11:57:14.560083+00:00", "processing_duration": 0.003751, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T11:57:14.559507+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10274447360, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-78/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Missing required columns. Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:57:14.660371+00:00", "memory": {"total": 33224306688, "available": 10274447360, "used": 22949859328, "percent": 69.1}, "disk": {"total": 1965300219904, "used": 865924083712, "free": 999468863488, "percent": 44.06065164712077}, "cpu": {"percent": 7.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T11:57:14.667095+00:00", "processing_duration": 0.004256, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T11:57:14.666075+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10282713088, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-78/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:57:14.767371+00:00", "memory": {"total": 33224306688, "available": 10282713088, "used": 22941593600, "percent": 69.1}, "disk": {"total": 1965300219904, "used": 865924112384, "free": 999468834816, "percent": 44.06065310603274}, "cpu": {"percent": 6.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T11:59:41.842946+00:00", "processing_duration": 0.009587, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T11:59:41.943533+00:00", "memory": {"total": 33224306688, "available": 10197491712, "used": 23026814976, "percent": 69.3}, "disk": {"total": 1965300219904, "used": 865930227712, "free": 999462719488, "percent": 44.06096427111266}, "cpu": {"percent": 12.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T11:59:41.947030+00:00", "processing_duration": 0.002446, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T11:59:41.946513+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10074214400, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:59:42.047601+00:00", "memory": {"total": 33224306688, "available": 10074214400, "used": 23150092288, "percent": 69.7}, "disk": {"total": 1965300219904, "used": 865930248192, "free": 999462699008, "percent": 44.06096531319263}, "cpu": {"percent": 14.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T11:59:51.688853+00:00", "processing_duration": 0.004234, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T11:59:51.687787+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 9879425024, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 213, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:59:51.789140+00:00", "memory": {"total": 33224306688, "available": 9879425024, "used": 23344881664, "percent": 70.3}, "disk": {"total": 1965300219904, "used": 865930874880, "free": 999462072320, "percent": 44.06099720083981}, "cpu": {"percent": 10.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T11:59:51.794063+00:00", "processing_duration": 0.002712, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T11:59:51.894422+00:00", "memory": {"total": 33224306688, "available": 9724489728, "used": 23499816960, "percent": 70.7}, "disk": {"total": 1965300219904, "used": 865930891264, "free": 999462055936, "percent": 44.06099803450378}, "cpu": {"percent": 16.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T11:59:51.897464+00:00", "processing_duration": 0.002331, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T11:59:51.896945+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10164891648, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:59:51.997824+00:00", "memory": {"total": 33224306688, "available": 10164891648, "used": 23059415040, "percent": 69.4}, "disk": {"total": 1965300219904, "used": 865930907648, "free": 999462039552, "percent": 44.06099886816776}, "cpu": {"percent": 30.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T11:59:52.201745+00:00", "processing_duration": 0.00304, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T11:59:52.201347+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10265993216, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:59:52.301998+00:00", "memory": {"total": 33224306688, "available": 10265993216, "used": 22958313472, "percent": 69.1}, "disk": {"total": 1965300219904, "used": 865931239424, "free": 999461707776, "percent": 44.06101574986332}, "cpu": {"percent": 11.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T11:59:52.306592+00:00", "processing_duration": 0.003306, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T11:59:52.305992+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10123243520, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-83/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:59:52.406904+00:00", "memory": {"total": 33224306688, "available": 10123243520, "used": 23101063168, "percent": 69.5}, "disk": {"total": 1965300219904, "used": 865931268096, "free": 999461679104, "percent": 44.06101720877529}, "cpu": {"percent": 9.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T11:59:52.411744+00:00", "processing_duration": 0.003283, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T11:59:52.411166+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10476986368, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 170, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T11:59:52.512032+00:00", "memory": {"total": 33224306688, "available": 10476986368, "used": 22747320320, "percent": 68.5}, "disk": {"total": 1965300219904, "used": 865931296768, "free": 999461650432, "percent": 44.06101866768725}, "cpu": {"percent": 13.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T12:00:00.193568+00:00", "processing_duration": 0.004296, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T12:00:00.192952+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10786676736, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-83/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:00:00.293904+00:00", "memory": {"total": 33224306688, "available": 10786676736, "used": 22437629952, "percent": 67.5}, "disk": {"total": 1965300219904, "used": 865931636736, "free": 999461310464, "percent": 44.0610359662148}, "cpu": {"percent": 31.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T12:00:00.300063+00:00", "processing_duration": 0.003926, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T12:00:00.299526+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10839367680, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-83/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:00:00.400357+00:00", "memory": {"total": 33224306688, "available": 10839367680, "used": 22384939008, "percent": 67.4}, "disk": {"total": 1965300219904, "used": 865931669504, "free": 999461277696, "percent": 44.06103763354275}, "cpu": {"percent": 28.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T12:00:00.408887+00:00", "processing_duration": 0.004763, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T12:00:00.408166+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10827673600, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-83/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Missing required columns. Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:00:00.509210+00:00", "memory": {"total": 33224306688, "available": 10827673600, "used": 22396633088, "percent": 67.4}, "disk": {"total": 1965300219904, "used": 865931698176, "free": 999461249024, "percent": 44.06103909245472}, "cpu": {"percent": 15.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T12:00:00.516317+00:00", "processing_duration": 0.004015, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T12:00:00.515748+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10861314048, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-83/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:00:00.616637+00:00", "memory": {"total": 33224306688, "available": 10861314048, "used": 22362992640, "percent": 67.3}, "disk": {"total": 1965300219904, "used": 865931722752, "free": 999461224448, "percent": 44.06104034295068}, "cpu": {"percent": 11.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T12:01:14.072379+00:00", "processing_duration": 0.003635, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T12:01:14.071386+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 9952509952, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 213, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:01:14.172725+00:00", "memory": {"total": 33224306688, "available": 9952608256, "used": 23271698432, "percent": 70.0}, "disk": {"total": 1965300219904, "used": 865933697024, "free": 999459250176, "percent": 44.06114079946008}, "cpu": {"percent": 23.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T12:01:14.178429+00:00", "processing_duration": 0.003224, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T12:01:14.278812+00:00", "memory": {"total": 33224306688, "available": 9756917760, "used": 23467388928, "percent": 70.6}, "disk": {"total": 1965300219904, "used": 865933717504, "free": 999459229696, "percent": 44.06114184154005}, "cpu": {"percent": 37.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T12:01:14.282166+00:00", "processing_duration": 0.002598, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T12:01:14.281711+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 9555693568, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:01:14.382381+00:00", "memory": {"total": 33224306688, "available": 9555693568, "used": 23668613120, "percent": 71.2}, "disk": {"total": 1965300219904, "used": 865933737984, "free": 999459209216, "percent": 44.06114288362002}, "cpu": {"percent": 15.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T12:01:14.596285+00:00", "processing_duration": 0.003009, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T12:01:14.595918+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 9425870848, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:01:14.696535+00:00", "memory": {"total": 33224306688, "available": 9425870848, "used": 23798435840, "percent": 71.6}, "disk": {"total": 1965300219904, "used": 865934061568, "free": 999458885632, "percent": 44.0611593484836}, "cpu": {"percent": 15.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T12:01:14.701455+00:00", "processing_duration": 0.003333, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T12:01:14.700729+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 9684480000, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-84/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:01:14.801807+00:00", "memory": {"total": 33224306688, "available": 9684480000, "used": 23539826688, "percent": 70.9}, "disk": {"total": 1965300219904, "used": 865934094336, "free": 999458852864, "percent": 44.06116101581156}, "cpu": {"percent": 17.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T12:01:14.807264+00:00", "processing_duration": 0.003617, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T12:01:14.806650+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 9667608576, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 170, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:01:14.907559+00:00", "memory": {"total": 33224306688, "available": 9667608576, "used": 23556698112, "percent": 70.9}, "disk": {"total": 1965300219904, "used": 865934114816, "free": 999458832384, "percent": 44.06116205789153}, "cpu": {"percent": 20.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T12:01:22.386714+00:00", "processing_duration": 0.004466, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T12:01:22.386084+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10823323648, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-84/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:01:22.487066+00:00", "memory": {"total": 33224306688, "available": 10831360000, "used": 22392946688, "percent": 67.4}, "disk": {"total": 1965300219904, "used": 865934336000, "free": 999458611200, "percent": 44.06117331235524}, "cpu": {"percent": 8.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T12:01:22.493833+00:00", "processing_duration": 0.004278, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T12:01:22.493244+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10878259200, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-84/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:01:22.594159+00:00", "memory": {"total": 33224306688, "available": 10878259200, "used": 22346047488, "percent": 67.3}, "disk": {"total": 1965300219904, "used": 865934360576, "free": 999458586624, "percent": 44.0611745628512}, "cpu": {"percent": 10.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T12:01:22.601109+00:00", "processing_duration": 0.004103, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T12:01:22.600543+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10879299584, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-84/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Missing required columns. Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:01:22.701373+00:00", "memory": {"total": 33224306688, "available": 10879299584, "used": 22345007104, "percent": 67.3}, "disk": {"total": 1965300219904, "used": 865934385152, "free": 999458562048, "percent": 44.06117581334717}, "cpu": {"percent": 11.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T12:01:22.707772+00:00", "processing_duration": 0.004141, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T12:01:22.707193+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10879696896, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-84/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:01:22.808018+00:00", "memory": {"total": 33224306688, "available": 10879696896, "used": 22344609792, "percent": 67.3}, "disk": {"total": 1965300219904, "used": 865934426112, "free": 999458521088, "percent": 44.061177897507115}, "cpu": {"percent": 6.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T12:03:54.321388+00:00", "processing_duration": 0.003857, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T12:03:54.320417+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10844364800, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 213, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:03:54.421711+00:00", "memory": {"total": 33224306688, "available": 10844364800, "used": 22379941888, "percent": 67.4}, "disk": {"total": 1965300219904, "used": 865937559552, "free": 999455387648, "percent": 44.06133733574298}, "cpu": {"percent": 14.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T12:03:54.426893+00:00", "processing_duration": 0.00258, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T12:03:54.527183+00:00", "memory": {"total": 33224306688, "available": 10533117952, "used": 22691188736, "percent": 68.3}, "disk": {"total": 1965300219904, "used": 865937575936, "free": 999455371264, "percent": 44.06133816940695}, "cpu": {"percent": 13.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T12:03:54.529739+00:00", "processing_duration": 0.002002, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T12:03:54.529385+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10376069120, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:03:54.629974+00:00", "memory": {"total": 33224306688, "available": 10392588288, "used": 22831718400, "percent": 68.7}, "disk": {"total": 1965300219904, "used": 865937596416, "free": 999455350784, "percent": 44.061339211486924}, "cpu": {"percent": 10.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T12:03:54.833966+00:00", "processing_duration": 0.002838, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T12:03:54.833590+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10605215744, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:03:54.934206+00:00", "memory": {"total": 33224306688, "available": 10615037952, "used": 22609268736, "percent": 68.1}, "disk": {"total": 1965300219904, "used": 865937924096, "free": 999455023104, "percent": 44.0613558847665}, "cpu": {"percent": 11.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T12:03:54.938873+00:00", "processing_duration": 0.003389, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T12:03:54.938246+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10930843648, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-85/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:03:55.039140+00:00", "memory": {"total": 33224306688, "available": 10930843648, "used": 22293463040, "percent": 67.1}, "disk": {"total": 1965300219904, "used": 865937956864, "free": 999454990336, "percent": 44.06135755209446}, "cpu": {"percent": 9.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T12:03:55.044044+00:00", "processing_duration": 0.003514, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T12:03:55.043461+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10713980928, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 170, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:03:55.144323+00:00", "memory": {"total": 33224306688, "available": 10716692480, "used": 22507614208, "percent": 67.7}, "disk": {"total": 1965300219904, "used": 865937985536, "free": 999454961664, "percent": 44.06135901100642}, "cpu": {"percent": 9.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T12:04:02.916604+00:00", "processing_duration": 0.004141, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T12:04:02.915992+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11361755136, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-85/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:04:03.016887+00:00", "memory": {"total": 33224306688, "available": 11361755136, "used": 21862551552, "percent": 65.8}, "disk": {"total": 1965300219904, "used": 865938182144, "free": 999454765056, "percent": 44.061369014974154}, "cpu": {"percent": 11.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T12:04:03.023746+00:00", "processing_duration": 0.004383, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T12:04:03.023163+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11368062976, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-85/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:04:03.124050+00:00", "memory": {"total": 33224306688, "available": 11368062976, "used": 21856243712, "percent": 65.8}, "disk": {"total": 1965300219904, "used": 865938219008, "free": 999454728192, "percent": 44.0613708907181}, "cpu": {"percent": 11.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T12:04:03.131040+00:00", "processing_duration": 0.004594, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T12:04:03.130361+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11362250752, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-85/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Missing required columns. Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:04:03.231398+00:00", "memory": {"total": 33224306688, "available": 11362250752, "used": 21862055936, "percent": 65.8}, "disk": {"total": 1965300219904, "used": 865938255872, "free": 999454691328, "percent": 44.06137276646206}, "cpu": {"percent": 7.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T12:04:03.238121+00:00", "processing_duration": 0.004521, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T12:04:03.237521+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11360575488, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-85/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:04:03.338490+00:00", "memory": {"total": 33224306688, "available": 11360575488, "used": 21863731200, "percent": 65.8}, "disk": {"total": 1965300219904, "used": 865938288640, "free": 999454658560, "percent": 44.061374433790014}, "cpu": {"percent": 10.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T12:09:36.075015+00:00", "processing_duration": 0.004186, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T12:09:36.073577+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10279219200, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 213, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:09:36.175408+00:00", "memory": {"total": 33224306688, "available": 10279219200, "used": 22945087488, "percent": 69.1}, "disk": {"total": 1965300219904, "used": 865935929344, "free": 999457017856, "percent": 44.061254386177126}, "cpu": {"percent": 12.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T12:09:36.180438+00:00", "processing_duration": 0.002274, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T12:09:36.280691+00:00", "memory": {"total": 33224306688, "available": 10092429312, "used": 23131877376, "percent": 69.6}, "disk": {"total": 1965300219904, "used": 865935949824, "free": 999456997376, "percent": 44.0612554282571}, "cpu": {"percent": 11.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T12:09:36.283781+00:00", "processing_duration": 0.002597, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T12:09:36.283298+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 9825579008, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:09:36.384144+00:00", "memory": {"total": 33224306688, "available": 9825579008, "used": 23398727680, "percent": 70.4}, "disk": {"total": 1965300219904, "used": 865935974400, "free": 999456972800, "percent": 44.06125667875307}, "cpu": {"percent": 11.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T12:09:36.583912+00:00", "processing_duration": 0.002883, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T12:09:36.583545+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 9977970688, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:09:36.684170+00:00", "memory": {"total": 33224306688, "available": 9969713152, "used": 23254593536, "percent": 70.0}, "disk": {"total": 1965300219904, "used": 865936297984, "free": 999456649216, "percent": 44.06127314361664}, "cpu": {"percent": 12.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T12:09:36.688377+00:00", "processing_duration": 0.002961, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T12:09:36.687737+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10478989312, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-86/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:09:36.788643+00:00", "memory": {"total": 33224306688, "available": 10476924928, "used": 22747381760, "percent": 68.5}, "disk": {"total": 1965300219904, "used": 865936326656, "free": 999456620544, "percent": 44.061274602528606}, "cpu": {"percent": 8.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T12:09:36.793802+00:00", "processing_duration": 0.003614, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T12:09:36.793231+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10382704640, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 170, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:09:36.894072+00:00", "memory": {"total": 33224306688, "available": 10382704640, "used": 22841602048, "percent": 68.7}, "disk": {"total": 1965300219904, "used": 865936355328, "free": 999456591872, "percent": 44.061276061440566}, "cpu": {"percent": 8.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T12:09:44.732748+00:00", "processing_duration": 0.003379, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T12:09:44.732203+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10936766464, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-86/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:09:44.832985+00:00", "memory": {"total": 33224306688, "available": 10936766464, "used": 22287540224, "percent": 67.1}, "disk": {"total": 1965300219904, "used": 865936580608, "free": 999456366592, "percent": 44.06128752432027}, "cpu": {"percent": 6.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T12:09:44.838476+00:00", "processing_duration": 0.003658, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T12:09:44.837969+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10938449920, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-86/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:09:44.938804+00:00", "memory": {"total": 33224306688, "available": 10938449920, "used": 22285856768, "percent": 67.1}, "disk": {"total": 1965300219904, "used": 865936605184, "free": 999456342016, "percent": 44.06128877481624}, "cpu": {"percent": 6.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T12:09:44.944892+00:00", "processing_duration": 0.003724, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T12:09:44.944383+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10941472768, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-86/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Missing required columns. Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:09:45.045159+00:00", "memory": {"total": 33224306688, "available": 10941472768, "used": 22282833920, "percent": 67.1}, "disk": {"total": 1965300219904, "used": 865936633856, "free": 999456313344, "percent": 44.0612902337282}, "cpu": {"percent": 9.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T12:09:45.051748+00:00", "processing_duration": 0.004553, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T12:09:45.051239+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10941140992, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-86/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:09:45.152015+00:00", "memory": {"total": 33224306688, "available": 10941140992, "used": 22283165696, "percent": 67.1}, "disk": {"total": 1965300219904, "used": 865936658432, "free": 999456288768, "percent": 44.06129148422417}, "cpu": {"percent": 6.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T12:11:49.694922+00:00", "processing_duration": 0.004185, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T12:11:49.693802+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 9909923840, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 213, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:11:49.795207+00:00", "memory": {"total": 33224306688, "available": 9909923840, "used": 23314382848, "percent": 70.2}, "disk": {"total": 1965300219904, "used": 865942814720, "free": 999450132480, "percent": 44.06160473346404}, "cpu": {"percent": 10.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T12:11:49.800944+00:00", "processing_duration": 0.002778, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T12:11:49.901229+00:00", "memory": {"total": 33224306688, "available": 9733689344, "used": 23490617344, "percent": 70.7}, "disk": {"total": 1965300219904, "used": 865942831104, "free": 999450116096, "percent": 44.06160556712801}, "cpu": {"percent": 10.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T12:11:49.903732+00:00", "processing_duration": 0.001966, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T12:11:49.903343+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10203049984, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:11:50.004015+00:00", "memory": {"total": 33224306688, "available": 10202591232, "used": 23021715456, "percent": 69.3}, "disk": {"total": 1965300219904, "used": 865942851584, "free": 999450095616, "percent": 44.061606609207985}, "cpu": {"percent": 15.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T12:11:50.213298+00:00", "processing_duration": 0.00259, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T12:11:50.212928+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 9838649344, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:11:50.313579+00:00", "memory": {"total": 33224306688, "available": 9847132160, "used": 23377174528, "percent": 70.4}, "disk": {"total": 1965300219904, "used": 865943187456, "free": 999449759744, "percent": 44.06162369931955}, "cpu": {"percent": 12.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T12:11:50.318275+00:00", "processing_duration": 0.00323, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T12:11:50.317683+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10062348288, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-90/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:11:50.418553+00:00", "memory": {"total": 33224306688, "available": 10062348288, "used": 23161958400, "percent": 69.7}, "disk": {"total": 1965300219904, "used": 865943216128, "free": 999449731072, "percent": 44.06162515823151}, "cpu": {"percent": 7.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T12:11:50.423977+00:00", "processing_duration": 0.003386, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T12:11:50.423403+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 9894363136, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 170, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:11:50.524259+00:00", "memory": {"total": 33224306688, "available": 9894363136, "used": 23329943552, "percent": 70.2}, "disk": {"total": 1965300219904, "used": 865943244800, "free": 999449702400, "percent": 44.06162661714347}, "cpu": {"percent": 7.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T12:11:58.227911+00:00", "processing_duration": 0.003581, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T12:11:58.227381+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10905866240, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-90/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:11:58.328176+00:00", "memory": {"total": 33224306688, "available": 10905866240, "used": 22318440448, "percent": 67.2}, "disk": {"total": 1965300219904, "used": 865943453696, "free": 999449493504, "percent": 44.06163724635919}, "cpu": {"percent": 6.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T12:11:58.334320+00:00", "processing_duration": 0.00397, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T12:11:58.333822+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10906165248, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-90/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:11:58.434576+00:00", "memory": {"total": 33224306688, "available": 10906165248, "used": 22318141440, "percent": 67.2}, "disk": {"total": 1965300219904, "used": 865943478272, "free": 999449468928, "percent": 44.06163849685516}, "cpu": {"percent": 6.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T12:11:58.441022+00:00", "processing_duration": 0.004221, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T12:11:58.440521+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10957094912, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-90/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Missing required columns. Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:11:58.541258+00:00", "memory": {"total": 33224306688, "available": 10957094912, "used": 22267211776, "percent": 67.0}, "disk": {"total": 1965300219904, "used": 865943502848, "free": 999449444352, "percent": 44.06163974735113}, "cpu": {"percent": 6.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T12:11:58.548063+00:00", "processing_duration": 0.004146, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T12:11:58.547525+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10971545600, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-90/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:11:58.648328+00:00", "memory": {"total": 33224306688, "available": 10971545600, "used": 22252761088, "percent": 67.0}, "disk": {"total": 1965300219904, "used": 865943543808, "free": 999449403392, "percent": 44.061641831511075}, "cpu": {"percent": 6.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T12:17:26.515581+00:00", "processing_duration": 0.003855, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T12:17:26.514439+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11540398080, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 213, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:17:26.615855+00:00", "memory": {"total": 33224306688, "available": 11548106752, "used": 21676199936, "percent": 65.2}, "disk": {"total": 1965300219904, "used": 865946701824, "free": 999446245376, "percent": 44.06180252024291}, "cpu": {"percent": 17.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T12:17:26.621613+00:00", "processing_duration": 0.002557, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T12:17:26.721983+00:00", "memory": {"total": 33224306688, "available": 11826405376, "used": 21397901312, "percent": 64.4}, "disk": {"total": 1965300219904, "used": 865946718208, "free": 999446228992, "percent": 44.06180335390688}, "cpu": {"percent": 28.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T12:17:26.725491+00:00", "processing_duration": 0.002681, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T12:17:26.725009+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11786440704, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:17:26.825819+00:00", "memory": {"total": 33224306688, "available": 11786440704, "used": 21437865984, "percent": 64.5}, "disk": {"total": 1965300219904, "used": 865946763264, "free": 999446183936, "percent": 44.061805646482824}, "cpu": {"percent": 18.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T12:17:27.032337+00:00", "processing_duration": 0.00256, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T12:17:27.031986+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12140437504, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:17:27.132584+00:00", "memory": {"total": 33224306688, "available": 12140437504, "used": 21083869184, "percent": 63.5}, "disk": {"total": 1965300219904, "used": 865947103232, "free": 999445843968, "percent": 44.06182294501038}, "cpu": {"percent": 8.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T12:17:27.136754+00:00", "processing_duration": 0.003018, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T12:17:27.136142+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11998330880, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-91/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:17:27.237011+00:00", "memory": {"total": 33224306688, "available": 11998330880, "used": 21225975808, "percent": 63.9}, "disk": {"total": 1965300219904, "used": 865947131904, "free": 999445815296, "percent": 44.06182440392234}, "cpu": {"percent": 10.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T12:17:27.242155+00:00", "processing_duration": 0.003861, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T12:17:27.241430+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11987996672, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 170, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:17:27.342523+00:00", "memory": {"total": 33224306688, "available": 11987996672, "used": 21236310016, "percent": 63.9}, "disk": {"total": 1965300219904, "used": 865947156480, "free": 999445790720, "percent": 44.0618256544183}, "cpu": {"percent": 11.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T12:17:35.412830+00:00", "processing_duration": 0.003663, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T12:17:35.412301+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12529119232, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-91/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:17:35.513067+00:00", "memory": {"total": 33224306688, "available": 12529119232, "used": 20695187456, "percent": 62.3}, "disk": {"total": 1965300219904, "used": 865947455488, "free": 999445491712, "percent": 44.06184086878591}, "cpu": {"percent": 5.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T12:17:35.518483+00:00", "processing_duration": 0.003514, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T12:17:35.517979+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12579811328, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-91/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:17:35.618714+00:00", "memory": {"total": 33224306688, "available": 12579811328, "used": 20644495360, "percent": 62.1}, "disk": {"total": 1965300219904, "used": 865947488256, "free": 999445458944, "percent": 44.061842536113865}, "cpu": {"percent": 6.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T12:17:35.623850+00:00", "processing_duration": 0.003292, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T12:17:35.623359+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12570193920, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-91/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Missing required columns. Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:17:35.724085+00:00", "memory": {"total": 33224306688, "available": 12570193920, "used": 20654112768, "percent": 62.2}, "disk": {"total": 1965300219904, "used": 865947512832, "free": 999445434368, "percent": 44.061843786609835}, "cpu": {"percent": 6.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T12:17:35.729586+00:00", "processing_duration": 0.003439, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T12:17:35.729081+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12572033024, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-91/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:17:35.829827+00:00", "memory": {"total": 33224306688, "available": 12572033024, "used": 20652273664, "percent": 62.2}, "disk": {"total": 1965300219904, "used": 865947545600, "free": 999445401600, "percent": 44.061845453937785}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T12:19:06.353425+00:00", "processing_duration": 0.004655, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T12:19:06.352291+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11542364160, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 213, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:19:06.453774+00:00", "memory": {"total": 33224306688, "available": 11540054016, "used": 21684252672, "percent": 65.3}, "disk": {"total": 1965300219904, "used": 865954471936, "free": 999438475264, "percent": 44.06219788538464}, "cpu": {"percent": 22.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T12:19:06.459256+00:00", "processing_duration": 0.002701, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T12:19:06.559491+00:00", "memory": {"total": 33224306688, "available": 11431038976, "used": 21793267712, "percent": 65.6}, "disk": {"total": 1965300219904, "used": 865954492416, "free": 999438454784, "percent": 44.062198927464614}, "cpu": {"percent": 13.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T12:19:06.562551+00:00", "processing_duration": 0.002542, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T12:19:06.562053+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11301462016, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:19:06.662877+00:00", "memory": {"total": 33224306688, "available": 11301462016, "used": 21922844672, "percent": 66.0}, "disk": {"total": 1965300219904, "used": 865954508800, "free": 999438438400, "percent": 44.062199761128596}, "cpu": {"percent": 10.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T12:19:06.875130+00:00", "processing_duration": 0.00271, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T12:19:06.874565+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11392888832, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:19:06.975523+00:00", "memory": {"total": 33224306688, "available": 11392950272, "used": 21831356416, "percent": 65.7}, "disk": {"total": 1965300219904, "used": 865954840576, "free": 999438106624, "percent": 44.062216642824154}, "cpu": {"percent": 12.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T12:19:06.980911+00:00", "processing_duration": 0.003387, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T12:19:06.980130+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11328598016, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-92/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:19:07.081304+00:00", "memory": {"total": 33224306688, "available": 11326533632, "used": 21897773056, "percent": 65.9}, "disk": {"total": 1965300219904, "used": 865954873344, "free": 999438073856, "percent": 44.06221831015211}, "cpu": {"percent": 10.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T12:19:07.086764+00:00", "processing_duration": 0.003634, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T12:19:07.086138+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11273646080, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 170, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:19:07.187015+00:00", "memory": {"total": 33224306688, "available": 11273646080, "used": 21950660608, "percent": 66.1}, "disk": {"total": 1965300219904, "used": 865954906112, "free": 999438041088, "percent": 44.06221997748007}, "cpu": {"percent": 10.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T12:19:14.237583+00:00", "processing_duration": 0.00388, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T12:19:14.237082+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12189450240, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-92/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:19:14.337865+00:00", "memory": {"total": 33224306688, "available": 12189450240, "used": 21034856448, "percent": 63.3}, "disk": {"total": 1965300219904, "used": 865954979840, "free": 999437967360, "percent": 44.06222372896797}, "cpu": {"percent": 5.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T12:19:14.344024+00:00", "processing_duration": 0.003934, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T12:19:14.343520+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12192468992, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-92/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:19:14.444285+00:00", "memory": {"total": 33224306688, "available": 12192468992, "used": 21031837696, "percent": 63.3}, "disk": {"total": 1965300219904, "used": 865955004416, "free": 999437942784, "percent": 44.062224979463934}, "cpu": {"percent": 5.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T12:19:14.450988+00:00", "processing_duration": 0.004515, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T12:19:14.450284+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12252364800, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-92/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Missing required columns. Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:19:14.551336+00:00", "memory": {"total": 33224306688, "available": 12252377088, "used": 20971929600, "percent": 63.1}, "disk": {"total": 1965300219904, "used": 865955028992, "free": 999437918208, "percent": 44.062226229959904}, "cpu": {"percent": 5.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T12:19:14.558433+00:00", "processing_duration": 0.004689, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T12:19:14.557740+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12257374208, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-92/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:19:14.658783+00:00", "memory": {"total": 33224306688, "available": 12257374208, "used": 20966932480, "percent": 63.1}, "disk": {"total": 1965300219904, "used": 865955065856, "free": 999437881344, "percent": 44.06222810570385}, "cpu": {"percent": 5.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T12:23:40.058180+00:00", "processing_duration": 0.004533, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T12:23:40.056506+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11321888768, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 213, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:23:40.158490+00:00", "memory": {"total": 33224306688, "available": 11321888768, "used": 21902417920, "percent": 65.9}, "disk": {"total": 1965300219904, "used": 865945047040, "free": 999447900160, "percent": 44.061718320181086}, "cpu": {"percent": 9.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T12:23:40.163915+00:00", "processing_duration": 0.002965, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T12:23:40.264304+00:00", "memory": {"total": 33224306688, "available": 11743080448, "used": 21481226240, "percent": 64.7}, "disk": {"total": 1965300219904, "used": 865945067520, "free": 999447879680, "percent": 44.061719362261066}, "cpu": {"percent": 16.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T12:23:40.266941+00:00", "processing_duration": 0.001889, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T12:23:40.266559+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11556544512, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:23:40.367235+00:00", "memory": {"total": 33224306688, "available": 11556282368, "used": 21668024320, "percent": 65.2}, "disk": {"total": 1965300219904, "used": 865945083904, "free": 999447863296, "percent": 44.06172019592504}, "cpu": {"percent": 15.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T12:23:40.568258+00:00", "processing_duration": 0.002631, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T12:23:40.567905+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11734474752, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:23:40.668571+00:00", "memory": {"total": 33224306688, "available": 11734474752, "used": 21489831936, "percent": 64.7}, "disk": {"total": 1965300219904, "used": 865945419776, "free": 999447527424, "percent": 44.061737286036596}, "cpu": {"percent": 11.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T12:23:40.674414+00:00", "processing_duration": 0.00396, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T12:23:40.673707+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11553468416, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-101/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:23:40.774745+00:00", "memory": {"total": 33224306688, "available": 11545153536, "used": 21679153152, "percent": 65.3}, "disk": {"total": 1965300219904, "used": 865945452544, "free": 999447494656, "percent": 44.061738953364554}, "cpu": {"percent": 7.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T12:23:40.780198+00:00", "processing_duration": 0.003832, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T12:23:40.779492+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11939147776, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 170, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:23:40.880493+00:00", "memory": {"total": 33224306688, "available": 11939147776, "used": 21285158912, "percent": 64.1}, "disk": {"total": 1965300219904, "used": 865945477120, "free": 999447470080, "percent": 44.06174020386052}, "cpu": {"percent": 6.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T12:23:48.369624+00:00", "processing_duration": 0.004418, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T12:23:48.369009+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12145926144, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-101/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:23:48.469957+00:00", "memory": {"total": 33224306688, "available": 12145926144, "used": 21078380544, "percent": 63.4}, "disk": {"total": 1965300219904, "used": 865945702400, "free": 999447244800, "percent": 44.06175166674022}, "cpu": {"percent": 8.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T12:23:48.476313+00:00", "processing_duration": 0.004122, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T12:23:48.475742+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12165021696, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-101/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:23:48.576546+00:00", "memory": {"total": 33224306688, "available": 12165021696, "used": 21059284992, "percent": 63.4}, "disk": {"total": 1965300219904, "used": 865945731072, "free": 999447216128, "percent": 44.06175312565219}, "cpu": {"percent": 5.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T12:23:48.582793+00:00", "processing_duration": 0.004022, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T12:23:48.582270+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12164771840, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-101/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Missing required columns. Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:23:48.683077+00:00", "memory": {"total": 33224306688, "available": 12164771840, "used": 21059534848, "percent": 63.4}, "disk": {"total": 1965300219904, "used": 865945755648, "free": 999447191552, "percent": 44.06175437614815}, "cpu": {"percent": 6.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T12:23:48.689581+00:00", "processing_duration": 0.004256, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T12:23:48.689085+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12174336000, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-101/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:23:48.789868+00:00", "memory": {"total": 33224306688, "available": 12174336000, "used": 21049970688, "percent": 63.4}, "disk": {"total": 1965300219904, "used": 865945784320, "free": 999447162880, "percent": 44.06175583506012}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T12:25:13.187949+00:00", "processing_duration": 0.0046, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T12:25:13.186923+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11513065472, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 213, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:25:13.288254+00:00", "memory": {"total": 33224306688, "available": 11504807936, "used": 21719498752, "percent": 65.4}, "disk": {"total": 1965300219904, "used": 865948631040, "free": 999444316160, "percent": 44.06190068417636}, "cpu": {"percent": 12.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T12:25:13.292960+00:00", "processing_duration": 0.002334, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T12:25:13.393230+00:00", "memory": {"total": 33224306688, "available": 11208855552, "used": 22015451136, "percent": 66.3}, "disk": {"total": 1965300219904, "used": 865948647424, "free": 999444299776, "percent": 44.06190151784033}, "cpu": {"percent": 12.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T12:25:13.395668+00:00", "processing_duration": 0.001889, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T12:25:13.395320+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10929692672, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:25:13.495932+00:00", "memory": {"total": 33224306688, "available": 10929692672, "used": 22294614016, "percent": 67.1}, "disk": {"total": 1965300219904, "used": 865948672000, "free": 999444275200, "percent": 44.0619027683363}, "cpu": {"percent": 11.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T12:25:13.702484+00:00", "processing_duration": 0.003175, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T12:25:13.702136+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11165454336, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:25:13.802766+00:00", "memory": {"total": 33224306688, "available": 11174383616, "used": 22049923072, "percent": 66.4}, "disk": {"total": 1965300219904, "used": 865949007872, "free": 999443939328, "percent": 44.06191985844786}, "cpu": {"percent": 10.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T12:25:13.808288+00:00", "processing_duration": 0.004095, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T12:25:13.807448+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11544588288, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-102/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:25:13.908662+00:00", "memory": {"total": 33224306688, "available": 11544588288, "used": 21679718400, "percent": 65.3}, "disk": {"total": 1965300219904, "used": 865949032448, "free": 999443914752, "percent": 44.06192110894382}, "cpu": {"percent": 8.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T12:25:13.914450+00:00", "processing_duration": 0.003822, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T12:25:13.913848+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11441246208, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 170, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:25:14.014699+00:00", "memory": {"total": 33224306688, "available": 11441246208, "used": 21783060480, "percent": 65.6}, "disk": {"total": 1965300219904, "used": 865949061120, "free": 999443886080, "percent": 44.06192256785579}, "cpu": {"percent": 8.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T12:25:21.478479+00:00", "processing_duration": 0.00387, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T12:25:21.477964+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12146122752, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-102/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:25:21.578724+00:00", "memory": {"total": 33224306688, "available": 12146122752, "used": 21078183936, "percent": 63.4}, "disk": {"total": 1965300219904, "used": 865949257728, "free": 999443689472, "percent": 44.061932571823526}, "cpu": {"percent": 10.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T12:25:21.584263+00:00", "processing_duration": 0.003515, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T12:25:21.583762+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12141170688, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-102/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:25:21.684618+00:00", "memory": {"total": 33224306688, "available": 12141170688, "used": 21083136000, "percent": 63.5}, "disk": {"total": 1965300219904, "used": 865949274112, "free": 999443673088, "percent": 44.06193340548751}, "cpu": {"percent": 28.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T12:25:21.692706+00:00", "processing_duration": 0.005226, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T12:25:21.692023+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12133421056, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-102/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Missing required columns. Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:25:21.793092+00:00", "memory": {"total": 33224306688, "available": 12133421056, "used": 21090885632, "percent": 63.5}, "disk": {"total": 1965300219904, "used": 865949306880, "free": 999443640320, "percent": 44.06193507281546}, "cpu": {"percent": 19.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T12:25:21.800118+00:00", "processing_duration": 0.004577, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T12:25:21.799484+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12125458432, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-102/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:25:21.900416+00:00", "memory": {"total": 33224306688, "available": 12125458432, "used": 21098848256, "percent": 63.5}, "disk": {"total": 1965300219904, "used": 865949335552, "free": 999443611648, "percent": 44.061936531727426}, "cpu": {"percent": 7.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T12:28:29.100548+00:00", "processing_duration": 0.004362, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T12:28:29.099362+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10648231936, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 213, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:28:29.200888+00:00", "memory": {"total": 33224306688, "available": 10648231936, "used": 22576074752, "percent": 68.0}, "disk": {"total": 1965300219904, "used": 865968427008, "free": 999424520192, "percent": 44.06290795867821}, "cpu": {"percent": 14.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T12:28:29.206742+00:00", "processing_duration": 0.00276, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T12:28:29.307121+00:00", "memory": {"total": 33224306688, "available": 11270901760, "used": 21953404928, "percent": 66.1}, "disk": {"total": 1965300219904, "used": 865968443392, "free": 999424503808, "percent": 44.062908792342185}, "cpu": {"percent": 14.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T12:28:29.310259+00:00", "processing_duration": 0.002302, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T12:28:29.309760+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11070922752, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:28:29.410650+00:00", "memory": {"total": 33224306688, "available": 11070922752, "used": 22153383936, "percent": 66.7}, "disk": {"total": 1965300219904, "used": 865968463872, "free": 999424483328, "percent": 44.062909834422165}, "cpu": {"percent": 14.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T12:28:29.614946+00:00", "processing_duration": 0.002685, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T12:28:29.614425+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11176161280, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:28:29.715316+00:00", "memory": {"total": 33224306688, "available": 11176595456, "used": 22047711232, "percent": 66.4}, "disk": {"total": 1965300219904, "used": 865968795648, "free": 999424151552, "percent": 44.06292671611772}, "cpu": {"percent": 7.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T12:28:29.720496+00:00", "processing_duration": 0.003614, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T12:28:29.719855+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11462574080, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-103/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:28:29.820715+00:00", "memory": {"total": 33224306688, "available": 11486683136, "used": 21737623552, "percent": 65.4}, "disk": {"total": 1965300219904, "used": 865968840704, "free": 999424106496, "percent": 44.062929008693665}, "cpu": {"percent": 6.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T12:28:29.825675+00:00", "processing_duration": 0.003619, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T12:28:29.824979+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11526914048, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 170, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:28:29.925915+00:00", "memory": {"total": 33224306688, "available": 11526914048, "used": 21697392640, "percent": 65.3}, "disk": {"total": 1965300219904, "used": 865968861184, "free": 999424086016, "percent": 44.06293005077364}, "cpu": {"percent": 8.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T12:28:38.425418+00:00", "processing_duration": 0.004111, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T12:28:38.424868+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11701792768, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-103/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:28:38.525711+00:00", "memory": {"total": 33224306688, "available": 11701792768, "used": 21522513920, "percent": 64.8}, "disk": {"total": 1965300219904, "used": 865969057792, "free": 999423889408, "percent": 44.062940054741375}, "cpu": {"percent": 5.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T12:28:38.532067+00:00", "processing_duration": 0.004007, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T12:28:38.531519+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11703451648, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-103/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:28:38.632349+00:00", "memory": {"total": 33224306688, "available": 11703451648, "used": 21520855040, "percent": 64.8}, "disk": {"total": 1965300219904, "used": 865969086464, "free": 999423860736, "percent": 44.06294151365334}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T12:28:38.637988+00:00", "processing_duration": 0.003398, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T12:28:38.637494+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11703144448, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-103/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Missing required columns. Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:28:38.738234+00:00", "memory": {"total": 33224306688, "available": 11703144448, "used": 21521162240, "percent": 64.8}, "disk": {"total": 1965300219904, "used": 865969115136, "free": 999423832064, "percent": 44.0629429725653}, "cpu": {"percent": 5.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T12:28:38.744034+00:00", "processing_duration": 0.003911, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T12:28:38.743484+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11705204736, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-103/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:28:38.844273+00:00", "memory": {"total": 33224306688, "available": 11705204736, "used": 21519101952, "percent": 64.8}, "disk": {"total": 1965300219904, "used": 865969147904, "free": 999423799296, "percent": 44.06294463989326}, "cpu": {"percent": 5.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T12:56:32.773540+00:00", "processing_duration": 0.004469, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T12:56:32.772211+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11246346240, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 213, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:56:32.873901+00:00", "memory": {"total": 33224306688, "available": 11245572096, "used": 21978734592, "percent": 66.2}, "disk": {"total": 1965300219904, "used": 865970663424, "free": 999422283776, "percent": 44.06302175381126}, "cpu": {"percent": 8.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T12:56:32.879417+00:00", "processing_duration": 0.00249, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T12:56:32.979679+00:00", "memory": {"total": 33224306688, "available": 11263008768, "used": 21961297920, "percent": 66.1}, "disk": {"total": 1965300219904, "used": 865970683904, "free": 999422263296, "percent": 44.063022795891236}, "cpu": {"percent": 7.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T12:56:32.981965+00:00", "processing_duration": 0.001785, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T12:56:32.981599+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11085479936, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:56:33.082242+00:00", "memory": {"total": 33224306688, "available": 11077222400, "used": 22147084288, "percent": 66.7}, "disk": {"total": 1965300219904, "used": 865970704384, "free": 999422242816, "percent": 44.0630238379712}, "cpu": {"percent": 7.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T12:56:33.348324+00:00", "processing_duration": 0.00371, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T12:56:33.347866+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11220152320, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:56:33.448697+00:00", "memory": {"total": 33224306688, "available": 11220152320, "used": 22004154368, "percent": 66.2}, "disk": {"total": 1965300219904, "used": 865971040256, "free": 999421906944, "percent": 44.063040928082756}, "cpu": {"percent": 10.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T12:56:33.454294+00:00", "processing_duration": 0.003816, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T12:56:33.453532+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11079700480, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-104/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:56:33.554651+00:00", "memory": {"total": 33224306688, "available": 11079700480, "used": 22144606208, "percent": 66.7}, "disk": {"total": 1965300219904, "used": 865971068928, "free": 999421878272, "percent": 44.063042386994724}, "cpu": {"percent": 11.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T12:56:33.560191+00:00", "processing_duration": 0.003844, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T12:56:33.559485+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10873278464, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 170, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:56:33.660488+00:00", "memory": {"total": 33224306688, "available": 10865020928, "used": 22359285760, "percent": 67.3}, "disk": {"total": 1965300219904, "used": 865971097600, "free": 999421849600, "percent": 44.063043845906684}, "cpu": {"percent": 11.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T12:56:41.385821+00:00", "processing_duration": 0.003807, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T12:56:41.385276+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12102737920, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-104/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:56:41.486131+00:00", "memory": {"total": 33224306688, "available": 12101398528, "used": 21122908160, "percent": 63.6}, "disk": {"total": 1965300219904, "used": 865971294208, "free": 999421652992, "percent": 44.06305384987442}, "cpu": {"percent": 8.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T12:56:41.522371+00:00", "processing_duration": 0.003963, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T12:56:41.521783+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12100964352, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-104/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:56:41.622613+00:00", "memory": {"total": 33224306688, "available": 12109000704, "used": 21115305984, "percent": 63.6}, "disk": {"total": 1965300219904, "used": 865971318784, "free": 999421628416, "percent": 44.06305510037039}, "cpu": {"percent": 4.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T12:56:41.660031+00:00", "processing_duration": 0.003938, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T12:56:41.659515+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12125593600, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-104/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Missing required columns. Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Missing required columns. Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:56:41.760298+00:00", "memory": {"total": 33224306688, "available": 12125593600, "used": 21098713088, "percent": 63.5}, "disk": {"total": 1965300219904, "used": 865971367936, "free": 999421579264, "percent": 44.063057601362324}, "cpu": {"percent": 4.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T12:56:41.792586+00:00", "processing_duration": 0.003692, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T12:56:41.791990+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12125106176, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-104/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T12:56:41.892880+00:00", "memory": {"total": 33224306688, "available": 12125106176, "used": 21099200512, "percent": 63.5}, "disk": {"total": 1965300219904, "used": 865971392512, "free": 999421554688, "percent": 44.063058851858294}, "cpu": {"percent": 4.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T13:16:03.824064+00:00", "processing_duration": 0.004225, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T13:16:03.823074+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11392200704, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 211, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:16:03.924413+00:00", "memory": {"total": 33224306688, "available": 11392200704, "used": 21832105984, "percent": 65.7}, "disk": {"total": 1965300219904, "used": 865991106560, "free": 999401840640, "percent": 44.064061958040256}, "cpu": {"percent": 8.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T13:16:03.929742+00:00", "processing_duration": 0.002428, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T13:16:04.030033+00:00", "memory": {"total": 33224306688, "available": 11335241728, "used": 21889064960, "percent": 65.9}, "disk": {"total": 1965300219904, "used": 865991122944, "free": 999401824256, "percent": 44.06406279170423}, "cpu": {"percent": 8.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T13:16:04.032315+00:00", "processing_duration": 0.00175, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T13:16:04.031953+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11712266240, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:16:04.132581+00:00", "memory": {"total": 33224306688, "available": 11710316544, "used": 21513990144, "percent": 64.8}, "disk": {"total": 1965300219904, "used": 865991139328, "free": 999401807872, "percent": 44.06406362536821}, "cpu": {"percent": 7.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:16:04.321091+00:00", "processing_duration": 0.002475, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T13:16:04.320748+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11842527232, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:16:04.421321+00:00", "memory": {"total": 33224306688, "available": 11842527232, "used": 21381779456, "percent": 64.4}, "disk": {"total": 1965300219904, "used": 865991475200, "free": 999401472000, "percent": 44.06408071547977}, "cpu": {"percent": 8.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:16:04.425964+00:00", "processing_duration": 0.003376, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T13:16:04.425330+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11849179136, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-110/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:16:04.526200+00:00", "memory": {"total": 33224306688, "available": 11849203712, "used": 21375102976, "percent": 64.3}, "disk": {"total": 1965300219904, "used": 865991499776, "free": 999401447424, "percent": 44.06408196597574}, "cpu": {"percent": 5.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:16:04.531839+00:00", "processing_duration": 0.004371, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T13:16:04.531264+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11856932864, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:16:04.632072+00:00", "memory": {"total": 33224306688, "available": 11857178624, "used": 21367128064, "percent": 64.3}, "disk": {"total": 1965300219904, "used": 865991516160, "free": 999401431040, "percent": 44.06408279963971}, "cpu": {"percent": 4.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T13:16:11.917559+00:00", "processing_duration": 0.003345, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T13:16:11.917030+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12247605248, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-110/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:16:12.017839+00:00", "memory": {"total": 33224306688, "available": 12247605248, "used": 20976701440, "percent": 63.1}, "disk": {"total": 1965300219904, "used": 865991778304, "free": 999401168896, "percent": 44.06409613826337}, "cpu": {"percent": 5.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T13:16:12.023781+00:00", "processing_duration": 0.004032, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T13:16:12.023270+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12244140032, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-110/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:16:12.124046+00:00", "memory": {"total": 33224306688, "available": 12244140032, "used": 20980166656, "percent": 63.1}, "disk": {"total": 1965300219904, "used": 865991798784, "free": 999401148416, "percent": 44.06409718034334}, "cpu": {"percent": 5.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T13:16:12.130690+00:00", "processing_duration": 0.004459, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: No uncertainty found for parameter 'R' and no covariance matrix provided", "timestamp": "2025-10-23T13:16:12.130107+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12307697664, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-110/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 174, in _validate_cmb_parameters\n    raise ValueError(f\"No uncertainty found for parameter '{param}' and no covariance matrix provided\")\nValueError: No uncertainty found for parameter 'R' and no covariance matrix provided\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:16:12.231000+00:00", "memory": {"total": 33224306688, "available": 12307697664, "used": 20916609024, "percent": 63.0}, "disk": {"total": 1965300219904, "used": 865991827456, "free": 999401119744, "percent": 44.064098639255306}, "cpu": {"percent": 4.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T13:16:12.237656+00:00", "processing_duration": 0.004207, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T13:16:12.237131+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12316475392, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-110/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:16:12.337912+00:00", "memory": {"total": 33224306688, "available": 12316475392, "used": 20907831296, "percent": 62.9}, "disk": {"total": 1965300219904, "used": 865991860224, "free": 999401086976, "percent": 44.06410030658326}, "cpu": {"percent": 6.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T13:16:21.452571+00:00", "processing_duration": 0.004086, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T13:16:21.451552+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10964701184, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 211, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:16:21.552861+00:00", "memory": {"total": 33224306688, "available": 10964701184, "used": 22259605504, "percent": 67.0}, "disk": {"total": 1965300219904, "used": 865993564160, "free": 999399383040, "percent": 44.06418700763701}, "cpu": {"percent": 10.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T13:16:21.557320+00:00", "processing_duration": 0.002161, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T13:16:21.657597+00:00", "memory": {"total": 33224306688, "available": 11400323072, "used": 21823983616, "percent": 65.7}, "disk": {"total": 1965300219904, "used": 865993580544, "free": 999399366656, "percent": 44.06418784130099}, "cpu": {"percent": 14.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T13:16:21.660113+00:00", "processing_duration": 0.001894, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T13:16:21.659764+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11299205120, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:16:21.760428+00:00", "memory": {"total": 33224306688, "available": 11299270656, "used": 21925036032, "percent": 66.0}, "disk": {"total": 1965300219904, "used": 865993605120, "free": 999399342080, "percent": 44.064189091796955}, "cpu": {"percent": 30.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:16:21.962799+00:00", "processing_duration": 0.002692, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T13:16:21.962394+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11506085888, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:16:22.063155+00:00", "memory": {"total": 33224306688, "available": 11505053696, "used": 21719252992, "percent": 65.4}, "disk": {"total": 1965300219904, "used": 865993945088, "free": 999399002112, "percent": 44.064206390324514}, "cpu": {"percent": 33.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:16:22.069001+00:00", "processing_duration": 0.00388, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T13:16:22.067955+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11367309312, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-111/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:16:22.169411+00:00", "memory": {"total": 33224306688, "available": 11367104512, "used": 21857202176, "percent": 65.8}, "disk": {"total": 1965300219904, "used": 865993973760, "free": 999398973440, "percent": 44.06420784923647}, "cpu": {"percent": 23.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:16:22.175310+00:00", "processing_duration": 0.003991, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T13:16:22.174655+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11828068352, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:16:22.275599+00:00", "memory": {"total": 33224306688, "available": 11828068352, "used": 21396238336, "percent": 64.4}, "disk": {"total": 1965300219904, "used": 865993998336, "free": 999398948864, "percent": 44.06420909973244}, "cpu": {"percent": 15.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T13:16:30.959838+00:00", "processing_duration": 0.004636, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T13:16:30.959314+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11959250944, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-111/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:16:31.060074+00:00", "memory": {"total": 33224306688, "available": 11959513088, "used": 21264793600, "percent": 64.0}, "disk": {"total": 1965300219904, "used": 865994166272, "free": 999398780928, "percent": 44.064217644788215}, "cpu": {"percent": 5.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T13:16:31.066420+00:00", "processing_duration": 0.004039, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T13:16:31.065896+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11964018688, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-111/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:16:31.166690+00:00", "memory": {"total": 33224306688, "available": 11964018688, "used": 21260288000, "percent": 64.0}, "disk": {"total": 1965300219904, "used": 865994194944, "free": 999398752256, "percent": 44.06421910370018}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T13:16:31.172610+00:00", "processing_duration": 0.003745, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: No uncertainty found for parameter 'R' and no covariance matrix provided", "timestamp": "2025-10-23T13:16:31.172131+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11969875968, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-111/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 174, in _validate_cmb_parameters\n    raise ValueError(f\"No uncertainty found for parameter '{param}' and no covariance matrix provided\")\nValueError: No uncertainty found for parameter 'R' and no covariance matrix provided\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:16:31.272876+00:00", "memory": {"total": 33224306688, "available": 11969875968, "used": 21254430720, "percent": 64.0}, "disk": {"total": 1965300219904, "used": 865994219520, "free": 999398727680, "percent": 44.06422035419615}, "cpu": {"percent": 5.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T13:16:31.278908+00:00", "processing_duration": 0.003796, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T13:16:31.278394+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12009242624, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-111/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:16:31.379185+00:00", "memory": {"total": 33224306688, "available": 12009242624, "used": 21215064064, "percent": 63.9}, "disk": {"total": 1965300219904, "used": 865994252288, "free": 999398694912, "percent": 44.0642220215241}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T13:18:44.241983+00:00", "processing_duration": 0.004062, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T13:18:44.240832+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10352017408, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 211, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:18:44.342314+00:00", "memory": {"total": 33224306688, "available": 10343759872, "used": 22880546816, "percent": 68.9}, "disk": {"total": 1965300219904, "used": 866007068672, "free": 999385878528, "percent": 44.064874155171175}, "cpu": {"percent": 12.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T13:18:44.348186+00:00", "processing_duration": 0.002991, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T13:18:44.448465+00:00", "memory": {"total": 33224306688, "available": 10373681152, "used": 22850625536, "percent": 68.8}, "disk": {"total": 1965300219904, "used": 866007080960, "free": 999385866240, "percent": 44.06487478041916}, "cpu": {"percent": 8.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T13:18:44.451567+00:00", "processing_duration": 0.002365, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T13:18:44.451150+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10725146624, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:18:44.551907+00:00", "memory": {"total": 33224306688, "available": 10734968832, "used": 22489337856, "percent": 67.7}, "disk": {"total": 1965300219904, "used": 866007105536, "free": 999385841664, "percent": 44.06487603091513}, "cpu": {"percent": 8.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:18:44.751640+00:00", "processing_duration": 0.002497, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T13:18:44.751289+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10438131712, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:18:44.851968+00:00", "memory": {"total": 33224306688, "available": 10438131712, "used": 22786174976, "percent": 68.6}, "disk": {"total": 1965300219904, "used": 866007437312, "free": 999385509888, "percent": 44.064892912610695}, "cpu": {"percent": 8.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:18:44.857219+00:00", "processing_duration": 0.003672, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T13:18:44.856547+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10273468416, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-112/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:18:44.957513+00:00", "memory": {"total": 33224306688, "available": 10273468416, "used": 22950838272, "percent": 69.1}, "disk": {"total": 1965300219904, "used": 866007465984, "free": 999385481216, "percent": 44.06489437152265}, "cpu": {"percent": 11.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:18:44.962579+00:00", "processing_duration": 0.003519, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T13:18:44.961876+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10939179008, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:18:45.062909+00:00", "memory": {"total": 33224306688, "available": 10939629568, "used": 22284677120, "percent": 67.1}, "disk": {"total": 1965300219904, "used": 866007498752, "free": 999385448448, "percent": 44.06489603885061}, "cpu": {"percent": 23.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T13:18:53.183147+00:00", "processing_duration": 0.004177, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T13:18:53.182620+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12075978752, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-112/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:18:53.283383+00:00", "memory": {"total": 33224306688, "available": 12075978752, "used": 21148327936, "percent": 63.7}, "disk": {"total": 1965300219904, "used": 866007691264, "free": 999385255936, "percent": 44.06490583440236}, "cpu": {"percent": 5.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T13:18:53.289067+00:00", "processing_duration": 0.003838, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T13:18:53.288514+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12075986944, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-112/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:18:53.389300+00:00", "memory": {"total": 33224306688, "available": 12075986944, "used": 21148319744, "percent": 63.7}, "disk": {"total": 1965300219904, "used": 866007715840, "free": 999385231360, "percent": 44.06490708489832}, "cpu": {"percent": 4.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T13:18:53.395634+00:00", "processing_duration": 0.003878, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: No uncertainty found for parameter 'R' and no covariance matrix provided", "timestamp": "2025-10-23T13:18:53.395134+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12082941952, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-112/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 174, in _validate_cmb_parameters\n    raise ValueError(f\"No uncertainty found for parameter '{param}' and no covariance matrix provided\")\nValueError: No uncertainty found for parameter 'R' and no covariance matrix provided\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:18:53.496100+00:00", "memory": {"total": 33224306688, "available": 12082941952, "used": 21141364736, "percent": 63.6}, "disk": {"total": 1965300219904, "used": 866007740416, "free": 999385206784, "percent": 44.064908335394286}, "cpu": {"percent": 5.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T13:18:53.502763+00:00", "processing_duration": 0.004059, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T13:18:53.502215+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12091752448, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-112/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:18:53.603056+00:00", "memory": {"total": 33224306688, "available": 12091752448, "used": 21132554240, "percent": 63.6}, "disk": {"total": 1965300219904, "used": 866007773184, "free": 999385174016, "percent": 44.06491000272224}, "cpu": {"percent": 5.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T13:23:11.982393+00:00", "processing_duration": 0.004175, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T13:23:11.981319+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11564617728, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 211, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:23:12.082642+00:00", "memory": {"total": 33224306688, "available": 11564617728, "used": 21659688960, "percent": 65.2}, "disk": {"total": 1965300219904, "used": 866010116096, "free": 999382831104, "percent": 44.06502921667116}, "cpu": {"percent": 9.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T13:23:12.087776+00:00", "processing_duration": 0.002567, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T13:23:12.187977+00:00", "memory": {"total": 33224306688, "available": 11463950336, "used": 21760356352, "percent": 65.5}, "disk": {"total": 1965300219904, "used": 866010136576, "free": 999382810624, "percent": 44.06503025875112}, "cpu": {"percent": 7.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T13:23:12.190279+00:00", "processing_duration": 0.001837, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T13:23:12.189933+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11295924224, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:23:12.290495+00:00", "memory": {"total": 33224306688, "available": 11295924224, "used": 21928382464, "percent": 66.0}, "disk": {"total": 1965300219904, "used": 866010152960, "free": 999382794240, "percent": 44.065031092415104}, "cpu": {"percent": 7.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:23:12.553265+00:00", "processing_duration": 0.003121, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T13:23:12.552902+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11434500096, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:23:12.653525+00:00", "memory": {"total": 33224306688, "available": 11441201152, "used": 21783105536, "percent": 65.6}, "disk": {"total": 1965300219904, "used": 866010480640, "free": 999382466560, "percent": 44.06504776569467}, "cpu": {"percent": 8.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:23:12.658769+00:00", "processing_duration": 0.003899, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T13:23:12.658082+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11896188928, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-113/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:23:12.759109+00:00", "memory": {"total": 33224306688, "available": 11896188928, "used": 21328117760, "percent": 64.2}, "disk": {"total": 1965300219904, "used": 866010517504, "free": 999382429696, "percent": 44.06504964143862}, "cpu": {"percent": 4.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:23:12.764843+00:00", "processing_duration": 0.004051, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T13:23:12.764157+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11895967744, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:23:12.865099+00:00", "memory": {"total": 33224306688, "available": 11895967744, "used": 21328338944, "percent": 64.2}, "disk": {"total": 1965300219904, "used": 866010542080, "free": 999382405120, "percent": 44.06505089193459}, "cpu": {"percent": 4.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T13:23:20.869429+00:00", "processing_duration": 0.003982, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T13:23:20.868879+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12247969792, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-113/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:23:20.969722+00:00", "memory": {"total": 33224306688, "available": 12247969792, "used": 20976336896, "percent": 63.1}, "disk": {"total": 1965300219904, "used": 866010730496, "free": 999382216704, "percent": 44.06506047907034}, "cpu": {"percent": 4.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T13:23:21.000869+00:00", "processing_duration": 0.004418, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T13:23:21.000236+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12247003136, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-113/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:23:21.101135+00:00", "memory": {"total": 33224306688, "available": 12247003136, "used": 20977303552, "percent": 63.1}, "disk": {"total": 1965300219904, "used": 866010759168, "free": 999382188032, "percent": 44.0650619379823}, "cpu": {"percent": 5.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T13:23:21.135382+00:00", "processing_duration": 0.004035, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: No uncertainty found for parameter 'R' and no covariance matrix provided", "timestamp": "2025-10-23T13:23:21.134828+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12247773184, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-113/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 174, in _validate_cmb_parameters\n    raise ValueError(f\"No uncertainty found for parameter '{param}' and no covariance matrix provided\")\nValueError: No uncertainty found for parameter 'R' and no covariance matrix provided\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:23:21.235672+00:00", "memory": {"total": 33224306688, "available": 12247773184, "used": 20976533504, "percent": 63.1}, "disk": {"total": 1965300219904, "used": 866010787840, "free": 999382159360, "percent": 44.06506339689427}, "cpu": {"percent": 4.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T13:23:21.270473+00:00", "processing_duration": 0.003851, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T13:23:21.269943+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12247703552, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-113/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:23:21.370810+00:00", "memory": {"total": 33224306688, "available": 12247703552, "used": 20976603136, "percent": 63.1}, "disk": {"total": 1965300219904, "used": 866010816512, "free": 999382130688, "percent": 44.06506485580623}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T13:30:05.541146+00:00", "processing_duration": 0.00469, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T13:30:05.539424+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12396486656, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 211, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:30:05.644653+00:00", "memory": {"total": 33224306688, "available": 12396486656, "used": 20827820032, "percent": 62.7}, "disk": {"total": 1965300219904, "used": 866027896832, "free": 999365050368, "percent": 44.06593395050366}, "cpu": {"percent": 26.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T13:30:05.650288+00:00", "processing_duration": 0.002586, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T13:30:05.750593+00:00", "memory": {"total": 33224306688, "available": 12123930624, "used": 21100376064, "percent": 63.5}, "disk": {"total": 1965300219904, "used": 866027913216, "free": 999365033984, "percent": 44.06593478416765}, "cpu": {"percent": 17.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T13:30:05.753687+00:00", "processing_duration": 0.002422, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T13:30:05.753263+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12015312896, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:30:05.853996+00:00", "memory": {"total": 33224306688, "available": 12015312896, "used": 21208993792, "percent": 63.8}, "disk": {"total": 1965300219904, "used": 866027933696, "free": 999365013504, "percent": 44.06593582624762}, "cpu": {"percent": 7.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:30:06.110046+00:00", "processing_duration": 0.002562, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T13:30:06.109711+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11958710272, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:30:06.210354+00:00", "memory": {"total": 33224306688, "available": 11958710272, "used": 21265596416, "percent": 64.0}, "disk": {"total": 1965300219904, "used": 866028539904, "free": 999364407296, "percent": 44.06596667181482}, "cpu": {"percent": 28.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:30:06.215843+00:00", "processing_duration": 0.003618, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T13:30:06.215081+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11793108992, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-114/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:30:06.316119+00:00", "memory": {"total": 33224306688, "available": 11793108992, "used": 21431197696, "percent": 64.5}, "disk": {"total": 1965300219904, "used": 866028564480, "free": 999364382720, "percent": 44.06596792231079}, "cpu": {"percent": 17.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:30:06.321925+00:00", "processing_duration": 0.004195, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T13:30:06.321192+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12113756160, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:30:06.422175+00:00", "memory": {"total": 33224306688, "available": 12113756160, "used": 21110550528, "percent": 63.5}, "disk": {"total": 1965300219904, "used": 866028593152, "free": 999364354048, "percent": 44.06596938122275}, "cpu": {"percent": 11.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T13:30:14.798316+00:00", "processing_duration": 0.009966, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Processing failed for dataset 'unknown'\nStage: validation\nError Type: data_validation_error\nError: Required column 'z' not found after standardization\nContext: {'raw_data_path': '/tmp/pytest-of-fabian/pytest-114/test_sn_cross_validation0/sn_cross_validation.txt'}\nSuggested Actions:\n  1. Check data quality and remove invalid values\n  2. Verify redshift values are positive and finite\n  3. Check magnitude values for NaN or infinite values\n", "timestamp": "2025-10-23T13:30:14.793334+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11944484864, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-114/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 169, in derive\n    data = self._load_raw_data(raw_data_path)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 296, in _load_raw_data\n    raise ValueError(f\"Required column '{col}' not found after standardization\")\nValueError: Required column 'z' not found after standardization\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 202, in derive\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: validation\nError Type: data_validation_error\nError: Required column 'z' not found after standardization\nContext: {'raw_data_path': '/tmp/pytest-of-fabian/pytest-114/test_sn_cross_validation0/sn_cross_validation.txt'}\nSuggested Actions:\n  1. Check data quality and remove invalid values\n  2. Verify redshift values are positive and finite\n  3. Check magnitude values for NaN or infinite values\n\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:30:14.898706+00:00", "memory": {"total": 33224306688, "available": 11948949504, "used": 21275357184, "percent": 64.0}, "disk": {"total": 1965300219904, "used": 865998004224, "free": 999394942976, "percent": 44.064412930575145}, "cpu": {"percent": 100.0, "count": 32}, "threshold_violations": ["High CPU usage: 100.0%"]}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T13:30:14.937826+00:00", "processing_duration": 0.004732, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns. Expected one of ['dv_rd_err', 'dv_over_rd_err', 'dv_err', 'err_dv', 'sigma_dv']. Available: ['z', 'D_V', 'sigma_D_V']", "timestamp": "2025-10-23T13:30:14.937162+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12064317440, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-114/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 113, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 98, in validate_input\n    self._validate_isotropic_data(data)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 159, in _validate_isotropic_data\n    raise ValueError(f\"Missing required columns. Expected one of {error_columns}. Available: {available_cols}\")\nValueError: Missing required columns. Expected one of ['dv_rd_err', 'dv_over_rd_err', 'dv_err', 'err_dv', 'sigma_dv']. Available: ['z', 'D_V', 'sigma_D_V']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:30:15.038204+00:00", "memory": {"total": 33224306688, "available": 12064317440, "used": 21159989248, "percent": 63.7}, "disk": {"total": 1965300219904, "used": 865998032896, "free": 999394914304, "percent": 44.06441438948711}, "cpu": {"percent": 85.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T13:30:15.083899+00:00", "processing_duration": 0.003925, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: No uncertainty found for parameter 'R' and no covariance matrix provided", "timestamp": "2025-10-23T13:30:15.083355+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12018249728, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-114/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 185, in _validate_cmb_parameters\n    raise ValueError(f\"No uncertainty found for parameter '{param}' and no covariance matrix provided\")\nValueError: No uncertainty found for parameter 'R' and no covariance matrix provided\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:30:15.184207+00:00", "memory": {"total": 33224306688, "available": 12018249728, "used": 21206056960, "percent": 63.8}, "disk": {"total": 1965300219904, "used": 865998057472, "free": 999394889728, "percent": 44.06441563998308}, "cpu": {"percent": 87.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T13:30:15.259409+00:00", "processing_duration": 0.004069, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Insufficient data points: 1 (minimum 2 required)", "timestamp": "2025-10-23T13:30:15.258842+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11976470528, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-114/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 150, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 126, in validate_input\n    raise ValueError(f\"Insufficient data points: {len(data)} (minimum 2 required)\")\nValueError: Insufficient data points: 1 (minimum 2 required)\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:30:15.360460+00:00", "memory": {"total": 33224306688, "available": 11976470528, "used": 21247836160, "percent": 64.0}, "disk": {"total": 1965300219904, "used": 865998094336, "free": 999394852864, "percent": 44.06441751572703}, "cpu": {"percent": 83.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T13:31:28.674632+00:00", "processing_duration": 0.011447, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Insufficient data points: 1 (minimum 2 required)", "timestamp": "2025-10-23T13:31:28.673670+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10822942720, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-116/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 150, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 126, in validate_input\n    raise ValueError(f\"Insufficient data points: {len(data)} (minimum 2 required)\")\nValueError: Insufficient data points: 1 (minimum 2 required)\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:31:28.774922+00:00", "memory": {"total": 33224306688, "available": 10822942720, "used": 22401363968, "percent": 67.4}, "disk": {"total": 1965300219904, "used": 866011176960, "free": 999381770240, "percent": 44.06508319641375}, "cpu": {"percent": 11.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T13:33:41.366314+00:00", "processing_duration": 0.004272, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T13:33:41.365208+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10946080768, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 211, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:33:41.466550+00:00", "memory": {"total": 33224306688, "available": 10937823232, "used": 22286483456, "percent": 67.1}, "disk": {"total": 1965300219904, "used": 866022969344, "free": 999369977856, "percent": 44.06568322606218}, "cpu": {"percent": 9.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T13:33:41.471190+00:00", "processing_duration": 0.002406, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T13:33:41.571465+00:00", "memory": {"total": 33224306688, "available": 10992627712, "used": 22231678976, "percent": 66.9}, "disk": {"total": 1965300219904, "used": 866022985728, "free": 999369961472, "percent": 44.06568405972616}, "cpu": {"percent": 9.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T13:33:41.573994+00:00", "processing_duration": 0.001928, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T13:33:41.573643+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11401863168, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:33:41.674228+00:00", "memory": {"total": 33224306688, "available": 11401601024, "used": 21822705664, "percent": 65.7}, "disk": {"total": 1965300219904, "used": 866023026688, "free": 999369920512, "percent": 44.065686143886104}, "cpu": {"percent": 9.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:33:41.870053+00:00", "processing_duration": 0.002821, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T13:33:41.869719+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11491028992, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:33:41.970284+00:00", "memory": {"total": 33224306688, "available": 11491028992, "used": 21733277696, "percent": 65.4}, "disk": {"total": 1965300219904, "used": 866023366656, "free": 999369580544, "percent": 44.06570344241365}, "cpu": {"percent": 7.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:33:41.974507+00:00", "processing_duration": 0.003087, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T13:33:41.973800+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11377328128, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-117/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:33:42.074741+00:00", "memory": {"total": 33224306688, "available": 11388489728, "used": 21835816960, "percent": 65.7}, "disk": {"total": 1965300219904, "used": 866023395328, "free": 999369551872, "percent": 44.06570490132562}, "cpu": {"percent": 5.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:33:42.079630+00:00", "processing_duration": 0.003686, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T13:33:42.078952+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11867107328, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:33:42.179841+00:00", "memory": {"total": 33224306688, "available": 11867107328, "used": 21357199360, "percent": 64.3}, "disk": {"total": 1965300219904, "used": 866023428096, "free": 999369519104, "percent": 44.065706568653574}, "cpu": {"percent": 5.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T13:33:49.429773+00:00", "processing_duration": 0.004352, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Processing failed for dataset 'unknown'\nStage: validation\nError Type: data_validation_error\nError: Required column 'z' not found after standardization\nContext: {'raw_data_path': '/tmp/pytest-of-fabian/pytest-117/test_sn_cross_validation0/sn_cross_validation.txt'}\nSuggested Actions:\n  1. Check data quality and remove invalid values\n  2. Verify redshift values are positive and finite\n  3. Check magnitude values for NaN or infinite values\n", "timestamp": "2025-10-23T13:33:49.429045+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12276338688, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-117/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 170, in derive\n    data = self._load_raw_data(raw_data_path)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 297, in _load_raw_data\n    raise ValueError(f\"Required column '{col}' not found after standardization\")\nValueError: Required column 'z' not found after standardization\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 203, in derive\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: validation\nError Type: data_validation_error\nError: Required column 'z' not found after standardization\nContext: {'raw_data_path': '/tmp/pytest-of-fabian/pytest-117/test_sn_cross_validation0/sn_cross_validation.txt'}\nSuggested Actions:\n  1. Check data quality and remove invalid values\n  2. Verify redshift values are positive and finite\n  3. Check magnitude values for NaN or infinite values\n\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:33:49.530084+00:00", "memory": {"total": 33224306688, "available": 12276338688, "used": 20947968000, "percent": 63.1}, "disk": {"total": 1965300219904, "used": 866023792640, "free": 999369154560, "percent": 44.06572511767709}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T13:33:49.536691+00:00", "processing_duration": 0.004167, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns. Expected one of ['dv_rd_err', 'dv_over_rd_err', 'dv_err', 'err_dv', 'sigma_dv']. Available: ['z', 'D_V', 'sigma_D_V']", "timestamp": "2025-10-23T13:33:49.536106+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12287922176, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-117/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 114, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 98, in validate_input\n    self._validate_isotropic_data(data)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 160, in _validate_isotropic_data\n    raise ValueError(f\"Missing required columns. Expected one of {error_columns}. Available: {available_cols}\")\nValueError: Missing required columns. Expected one of ['dv_rd_err', 'dv_over_rd_err', 'dv_err', 'err_dv', 'sigma_dv']. Available: ['z', 'D_V', 'sigma_D_V']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:33:49.636936+00:00", "memory": {"total": 33224306688, "available": 12287922176, "used": 20936384512, "percent": 63.0}, "disk": {"total": 1965300219904, "used": 866023821312, "free": 999369125888, "percent": 44.06572657658906}, "cpu": {"percent": 4.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T13:33:49.643711+00:00", "processing_duration": 0.004505, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "redshift_range_error", "error_message": "Redshift values above maximum 10.0 found (max: 1090.0)", "timestamp": "2025-10-23T13:33:49.643145+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12289183744, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["dataset_type", "data_type", "source", "citation", "version", "processing_timestamp", "redshift", "n_parameters", "n_points", "parameters", "parameter_descriptions", "transformations_applied", "dimensionless_consistency_check", "parameter_validation", "parameter_extraction"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 303, in validate\n    return dataset.validate_redshift_range(self.min_z, self.max_z)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 396, in validate_redshift_range\n    raise ValueError(f\"Redshift values above maximum {max_z} found (max: {max_found})\")\nValueError: Redshift values above maximum 10.0 found (max: 1090.0)\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 305, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: redshift_range_error\nError: Redshift values above maximum 10.0 found (max: 1090.0)\nContext: {'allowed_range': [0.0, 10.0], 'actual_range': [1090.0, 1090.0]}\nSuggested Actions:\n  1. Check that redshift values are within expected range [0.0, 10.0]\n  2. Review input data for outliers or data entry errors\n  3. Verify coordinate system and redshift definitions\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:33:49.743948+00:00", "memory": {"total": 33224306688, "available": 12289183744, "used": 20935122944, "percent": 63.0}, "disk": {"total": 1965300219904, "used": 866023849984, "free": 999369097216, "percent": 44.06572803550101}, "cpu": {"percent": 4.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T13:33:49.750760+00:00", "processing_duration": 0.00419, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Processing failed for dataset 'unknown'\nStage: validation\nError Type: data_validation_error\nError: Required column 'z' not found after standardization\nContext: {'raw_data_path': '/tmp/pytest-of-fabian/pytest-117/test_format_conversion_compati0/sn_compatibility.txt'}\nSuggested Actions:\n  1. Check data quality and remove invalid values\n  2. Verify redshift values are positive and finite\n  3. Check magnitude values for NaN or infinite values\n", "timestamp": "2025-10-23T13:33:49.750107+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12305756160, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-117/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 170, in derive\n    data = self._load_raw_data(raw_data_path)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 297, in _load_raw_data\n    raise ValueError(f\"Required column '{col}' not found after standardization\")\nValueError: Required column 'z' not found after standardization\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 203, in derive\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: validation\nError Type: data_validation_error\nError: Required column 'z' not found after standardization\nContext: {'raw_data_path': '/tmp/pytest-of-fabian/pytest-117/test_format_conversion_compati0/sn_compatibility.txt'}\nSuggested Actions:\n  1. Check data quality and remove invalid values\n  2. Verify redshift values are positive and finite\n  3. Check magnitude values for NaN or infinite values\n\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:33:49.850996+00:00", "memory": {"total": 33224306688, "available": 12305756160, "used": 20918550528, "percent": 63.0}, "disk": {"total": 1965300219904, "used": 866023882752, "free": 999369064448, "percent": 44.06572970282897}, "cpu": {"percent": 4.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T13:34:25.211517+00:00", "processing_duration": 0.004229, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T13:34:25.210379+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11661578240, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 211, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:34:25.311778+00:00", "memory": {"total": 33224306688, "available": 11655729152, "used": 21568577536, "percent": 64.9}, "disk": {"total": 1965300219904, "used": 866024665088, "free": 999368282112, "percent": 44.065769510283936}, "cpu": {"percent": 10.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T13:34:25.316956+00:00", "processing_duration": 0.002761, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T13:34:25.417190+00:00", "memory": {"total": 33224306688, "available": 11443421184, "used": 21780885504, "percent": 65.6}, "disk": {"total": 1965300219904, "used": 866024681472, "free": 999368265728, "percent": 44.06577034394791}, "cpu": {"percent": 10.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T13:34:25.420013+00:00", "processing_duration": 0.002343, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T13:34:25.419419+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11089719296, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:34:25.520378+00:00", "memory": {"total": 33224306688, "available": 11089719296, "used": 22134587392, "percent": 66.6}, "disk": {"total": 1965300219904, "used": 866024701952, "free": 999368245248, "percent": 44.06577138602789}, "cpu": {"percent": 10.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:34:25.719386+00:00", "processing_duration": 0.003201, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T13:34:25.718954+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11227086848, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:34:25.819691+00:00", "memory": {"total": 33224306688, "available": 11227086848, "used": 21997219840, "percent": 66.2}, "disk": {"total": 1965300219904, "used": 866025033728, "free": 999367913472, "percent": 44.06578826772345}, "cpu": {"percent": 8.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:34:25.825023+00:00", "processing_duration": 0.003775, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T13:34:25.824302+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11617964032, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-118/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:34:25.925387+00:00", "memory": {"total": 33224306688, "available": 11615612928, "used": 21608693760, "percent": 65.0}, "disk": {"total": 1965300219904, "used": 866025066496, "free": 999367880704, "percent": 44.065789935051406}, "cpu": {"percent": 8.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:34:25.931571+00:00", "processing_duration": 0.004275, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T13:34:25.930696+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11570249728, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:34:26.031818+00:00", "memory": {"total": 33224306688, "available": 11570249728, "used": 21654056960, "percent": 65.2}, "disk": {"total": 1965300219904, "used": 866025091072, "free": 999367856128, "percent": 44.065791185547376}, "cpu": {"percent": 7.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T13:34:33.149360+00:00", "processing_duration": 0.005329, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Processing failed for dataset 'unknown'\nStage: validation\nError Type: data_validation_error\nError: Required column 'z' not found after standardization\nContext: {'raw_data_path': '/tmp/pytest-of-fabian/pytest-118/test_sn_cross_validation0/sn_cross_validation.txt'}\nSuggested Actions:\n  1. Check data quality and remove invalid values\n  2. Verify redshift values are positive and finite\n  3. Check magnitude values for NaN or infinite values\n", "timestamp": "2025-10-23T13:34:33.148691+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12220309504, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-118/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 170, in derive\n    data = self._load_raw_data(raw_data_path)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 297, in _load_raw_data\n    raise ValueError(f\"Required column '{col}' not found after standardization\")\nValueError: Required column 'z' not found after standardization\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 203, in derive\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: validation\nError Type: data_validation_error\nError: Required column 'z' not found after standardization\nContext: {'raw_data_path': '/tmp/pytest-of-fabian/pytest-118/test_sn_cross_validation0/sn_cross_validation.txt'}\nSuggested Actions:\n  1. Check data quality and remove invalid values\n  2. Verify redshift values are positive and finite\n  3. Check magnitude values for NaN or infinite values\n\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:34:33.249612+00:00", "memory": {"total": 33224306688, "available": 12220309504, "used": 21003997184, "percent": 63.2}, "disk": {"total": 1965300219904, "used": 866025308160, "free": 999367639040, "percent": 44.065802231595086}, "cpu": {"percent": 4.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T13:34:33.255947+00:00", "processing_duration": 0.00408, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns. Expected one of ['dv_rd_err', 'dv_over_rd_err', 'dv_err', 'err_dv', 'sigma_dv']. Available: ['z', 'D_V', 'sigma_D_V']", "timestamp": "2025-10-23T13:34:33.255365+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12220968960, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-118/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 114, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 98, in validate_input\n    self._validate_isotropic_data(data)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 160, in _validate_isotropic_data\n    raise ValueError(f\"Missing required columns. Expected one of {error_columns}. Available: {available_cols}\")\nValueError: Missing required columns. Expected one of ['dv_rd_err', 'dv_over_rd_err', 'dv_err', 'err_dv', 'sigma_dv']. Available: ['z', 'D_V', 'sigma_D_V']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:34:33.356188+00:00", "memory": {"total": 33224306688, "available": 12220968960, "used": 21003337728, "percent": 63.2}, "disk": {"total": 1965300219904, "used": 866025336832, "free": 999367610368, "percent": 44.065803690507046}, "cpu": {"percent": 4.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T13:34:33.362890+00:00", "processing_duration": 0.004664, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "redshift_range_error", "error_message": "Redshift values above maximum 10.0 found (max: 1090.0)", "timestamp": "2025-10-23T13:34:33.362302+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12221140992, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["dataset_type", "data_type", "source", "citation", "version", "processing_timestamp", "redshift", "n_parameters", "n_points", "parameters", "parameter_descriptions", "transformations_applied", "dimensionless_consistency_check", "parameter_validation", "parameter_extraction"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 303, in validate\n    return dataset.validate_redshift_range(self.min_z, self.max_z)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 396, in validate_redshift_range\n    raise ValueError(f\"Redshift values above maximum {max_z} found (max: {max_found})\")\nValueError: Redshift values above maximum 10.0 found (max: 1090.0)\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 305, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: redshift_range_error\nError: Redshift values above maximum 10.0 found (max: 1090.0)\nContext: {'allowed_range': [0.0, 10.0], 'actual_range': [1090.0, 1090.0]}\nSuggested Actions:\n  1. Check that redshift values are within expected range [0.0, 10.0]\n  2. Review input data for outliers or data entry errors\n  3. Verify coordinate system and redshift definitions\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:34:33.463134+00:00", "memory": {"total": 33224306688, "available": 12221140992, "used": 21003165696, "percent": 63.2}, "disk": {"total": 1965300219904, "used": 866025369600, "free": 999367577600, "percent": 44.06580535783501}, "cpu": {"percent": 4.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T13:34:33.470351+00:00", "processing_duration": 0.004823, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Processing failed for dataset 'unknown'\nStage: validation\nError Type: data_validation_error\nError: Required column 'z' not found after standardization\nContext: {'raw_data_path': '/tmp/pytest-of-fabian/pytest-118/test_format_conversion_compati0/sn_compatibility.txt'}\nSuggested Actions:\n  1. Check data quality and remove invalid values\n  2. Verify redshift values are positive and finite\n  3. Check magnitude values for NaN or infinite values\n", "timestamp": "2025-10-23T13:34:33.469703+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12236386304, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-118/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 170, in derive\n    data = self._load_raw_data(raw_data_path)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 297, in _load_raw_data\n    raise ValueError(f\"Required column '{col}' not found after standardization\")\nValueError: Required column 'z' not found after standardization\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 203, in derive\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: validation\nError Type: data_validation_error\nError: Required column 'z' not found after standardization\nContext: {'raw_data_path': '/tmp/pytest-of-fabian/pytest-118/test_format_conversion_compati0/sn_compatibility.txt'}\nSuggested Actions:\n  1. Check data quality and remove invalid values\n  2. Verify redshift values are positive and finite\n  3. Check magnitude values for NaN or infinite values\n\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:34:33.570590+00:00", "memory": {"total": 33224306688, "available": 12236386304, "used": 20987920384, "percent": 63.2}, "disk": {"total": 1965300219904, "used": 866025410560, "free": 999367536640, "percent": 44.065807441994956}, "cpu": {"percent": 4.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T13:34:45.102291+00:00", "processing_duration": 0.012624, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Processing failed for dataset 'unknown'\nStage: validation\nError Type: data_validation_error\nError: Required column 'z' not found after standardization\nContext: {'raw_data_path': '/tmp/pytest-of-fabian/pytest-119/test_format_conversion_compati0/sn_compatibility.txt'}\nSuggested Actions:\n  1. Check data quality and remove invalid values\n  2. Verify redshift values are positive and finite\n  3. Check magnitude values for NaN or infinite values\n", "timestamp": "2025-10-23T13:34:45.101225+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11318018048, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-119/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 170, in derive\n    data = self._load_raw_data(raw_data_path)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 297, in _load_raw_data\n    raise ValueError(f\"Required column '{col}' not found after standardization\")\nValueError: Required column 'z' not found after standardization\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 203, in derive\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: validation\nError Type: data_validation_error\nError: Required column 'z' not found after standardization\nContext: {'raw_data_path': '/tmp/pytest-of-fabian/pytest-119/test_format_conversion_compati0/sn_compatibility.txt'}\nSuggested Actions:\n  1. Check data quality and remove invalid values\n  2. Verify redshift values are positive and finite\n  3. Check magnitude values for NaN or infinite values\n\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:34:45.202522+00:00", "memory": {"total": 33224306688, "available": 11318018048, "used": 21906288640, "percent": 65.9}, "disk": {"total": 1965300219904, "used": 866026369024, "free": 999366578176, "percent": 44.06585621133769}, "cpu": {"percent": 8.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T13:37:11.294038+00:00", "processing_duration": 0.013137, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "physical_sanity_error", "error_message": "Supernova distance modulus values outside reasonable range [20, 50] mag", "timestamp": "2025-10-23T13:37:11.293131+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11340091392, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["dataset_type", "source", "citation", "version", "processing_date", "n_points", "redshift_range", "calibration_system", "transformations_applied", "calibration_homogenization"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 557, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 547, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 392, in validate\n    self._validate_physical_sanity(dataset)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 404, in _validate_physical_sanity\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: physical_sanity_error\nError: Supernova distance modulus values outside reasonable range [20, 50] mag\nContext: {'observable_range': [53.78, 53.78], 'extreme_indices': [0]}\nSuggested Actions:\n  1. Check distance modulus calculation\n  2. Verify magnitude to distance conversion\n  3. Review input magnitude values for outliers\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:37:11.394333+00:00", "memory": {"total": 33224306688, "available": 11339890688, "used": 21884416000, "percent": 65.9}, "disk": {"total": 1965300219904, "used": 866031566848, "free": 999361380352, "percent": 44.06612069123482}, "cpu": {"percent": 14.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_compatibility", "failure_time": "2025-10-23T13:37:47.772194+00:00", "processing_duration": 0.04028, "error_context": {"dataset_name": "bao_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns. Expected one of ['dv_rd_err', 'dv_over_rd_err', 'dv_err', 'err_dv', 'sigma_dv']. Available: ['z', 'D_V', 'sigma_D_V']", "timestamp": "2025-10-23T13:37:47.771191+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11158892544, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-121/test_format_conversion_compati0/bao_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 114, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 98, in validate_input\n    self._validate_isotropic_data(data)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 160, in _validate_isotropic_data\n    raise ValueError(f\"Missing required columns. Expected one of {error_columns}. Available: {available_cols}\")\nValueError: Missing required columns. Expected one of ['dv_rd_err', 'dv_over_rd_err', 'dv_err', 'err_dv', 'sigma_dv']. Available: ['z', 'D_V', 'sigma_D_V']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:37:47.872608+00:00", "memory": {"total": 33224306688, "available": 11158892544, "used": 22065414144, "percent": 66.4}, "disk": {"total": 1965300219904, "used": 866027077632, "free": 999365869568, "percent": 44.065892267304754}, "cpu": {"percent": 9.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_compatibility", "failure_time": "2025-10-23T13:38:50.796471+00:00", "processing_duration": 0.00377, "error_context": {"dataset_name": "bao_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns. Expected one of ['dv_rd_err', 'dv_over_rd_err', 'dv_err', 'err_dv', 'sigma_dv']. Available: ['z', 'D_V', 'sigma_D_V']", "timestamp": "2025-10-23T13:38:50.795577+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11245129728, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-122/test_format_conversion_compati0/bao_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 114, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 98, in validate_input\n    self._validate_isotropic_data(data)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 160, in _validate_isotropic_data\n    raise ValueError(f\"Missing required columns. Expected one of {error_columns}. Available: {available_cols}\")\nValueError: Missing required columns. Expected one of ['dv_rd_err', 'dv_over_rd_err', 'dv_err', 'err_dv', 'sigma_dv']. Available: ['z', 'D_V', 'sigma_D_V']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:38:50.896769+00:00", "memory": {"total": 33224306688, "available": 11236872192, "used": 21987434496, "percent": 66.2}, "disk": {"total": 1965300219904, "used": 866026442752, "free": 999366504448, "percent": 44.065859962825584}, "cpu": {"percent": 8.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T13:39:37.686403+00:00", "processing_duration": 0.00407, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T13:39:37.685122+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11415040000, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 211, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 565, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 555, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:39:37.786796+00:00", "memory": {"total": 33224306688, "available": 11415044096, "used": 21809262592, "percent": 65.6}, "disk": {"total": 1965300219904, "used": 866030317568, "free": 999362629632, "percent": 44.066057124356476}, "cpu": {"percent": 10.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T13:39:37.791791+00:00", "processing_duration": 0.002453, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T13:39:37.892050+00:00", "memory": {"total": 33224306688, "available": 11410919424, "used": 21813387264, "percent": 65.7}, "disk": {"total": 1965300219904, "used": 866030333952, "free": 999362613248, "percent": 44.06605795802045}, "cpu": {"percent": 9.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T13:39:37.894462+00:00", "processing_duration": 0.001912, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T13:39:37.894113+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11171659776, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:39:37.994790+00:00", "memory": {"total": 33224306688, "available": 11171659776, "used": 22052646912, "percent": 66.4}, "disk": {"total": 1965300219904, "used": 866030358528, "free": 999362588672, "percent": 44.066059208516414}, "cpu": {"percent": 10.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:39:38.201198+00:00", "processing_duration": 0.002969, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T13:39:38.200782+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10663194624, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:39:38.301477+00:00", "memory": {"total": 33224306688, "available": 10663194624, "used": 22561112064, "percent": 67.9}, "disk": {"total": 1965300219904, "used": 866030694400, "free": 999362252800, "percent": 44.066076298627976}, "cpu": {"percent": 10.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:39:38.306636+00:00", "processing_duration": 0.003745, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T13:39:38.305968+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11031711744, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-123/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:39:38.406899+00:00", "memory": {"total": 33224306688, "available": 11031711744, "used": 22192594944, "percent": 66.8}, "disk": {"total": 1965300219904, "used": 866030723072, "free": 999362224128, "percent": 44.06607775753994}, "cpu": {"percent": 9.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:39:38.412914+00:00", "processing_duration": 0.003975, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T13:39:38.412182+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10784145408, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 565, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 555, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:39:38.513176+00:00", "memory": {"total": 33224306688, "available": 10784145408, "used": 22440161280, "percent": 67.5}, "disk": {"total": 1965300219904, "used": 866030747648, "free": 999362199552, "percent": 44.0660790080359}, "cpu": {"percent": 9.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T13:39:46.643326+00:00", "processing_duration": 0.004858, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Processing failed for dataset 'unknown'\nStage: transformation\nError Type: bao_derivation_error\nError: None\nContext: {'raw_data_path': '/tmp/pytest-of-fabian/pytest-123/test_bao_cross_validation0/bao_cross_validation.txt'}\nSuggested Actions:\n  1. Check raw data format and column names\n  2. Verify measurement type (isotropic/anisotropic) in metadata\n  3. Check unit specifications and survey information\n", "timestamp": "2025-10-23T13:39:46.642560+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11897020416, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-123/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/venv/lib/python3.12/site-packages/pandas/core/indexes/base.py\", line 3812, in get_loc\n    return self._engine.get_loc(casted_key)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"pandas/_libs/index.pyx\", line 167, in pandas._libs.index.IndexEngine.get_loc\n  File \"pandas/_libs/index.pyx\", line 196, in pandas._libs.index.IndexEngine.get_loc\n  File \"pandas/_libs/hashtable_class_helper.pxi\", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item\n  File \"pandas/_libs/hashtable_class_helper.pxi\", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item\nKeyError: None\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 270, in derive\n    z, observable, uncertainty = self._extract_isotropic_measurements(data)\n                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 455, in _extract_isotropic_measurements\n    uncertainty = data[error_col].values\n                  ~~~~^^^^^^^^^^^\n  File \"/home/fabian/PBUF/venv/lib/python3.12/site-packages/pandas/core/frame.py\", line 4113, in __getitem__\n    indexer = self.columns.get_loc(key)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/venv/lib/python3.12/site-packages/pandas/core/indexes/base.py\", line 3819, in get_loc\n    raise KeyError(key) from err\nKeyError: None\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 307, in derive\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: transformation\nError Type: bao_derivation_error\nError: None\nContext: {'raw_data_path': '/tmp/pytest-of-fabian/pytest-123/test_bao_cross_validation0/bao_cross_validation.txt'}\nSuggested Actions:\n  1. Check raw data format and column names\n  2. Verify measurement type (isotropic/anisotropic) in metadata\n  3. Check unit specifications and survey information\n\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:39:46.743600+00:00", "memory": {"total": 33224306688, "available": 11897020416, "used": 21327286272, "percent": 64.2}, "disk": {"total": 1965300219904, "used": 866031013888, "free": 999361933312, "percent": 44.066092555075556}, "cpu": {"percent": 4.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T13:39:46.750814+00:00", "processing_duration": 0.004213, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "redshift_range_error", "error_message": "Redshift values above maximum 10.0 found (max: 1090.0)", "timestamp": "2025-10-23T13:39:46.750258+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11900166144, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["dataset_type", "data_type", "source", "citation", "version", "processing_timestamp", "redshift", "n_parameters", "n_points", "parameters", "parameter_descriptions", "transformations_applied", "dimensionless_consistency_check", "parameter_validation", "parameter_extraction"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 303, in validate\n    return dataset.validate_redshift_range(self.min_z, self.max_z)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 396, in validate_redshift_range\n    raise ValueError(f\"Redshift values above maximum {max_z} found (max: {max_found})\")\nValueError: Redshift values above maximum 10.0 found (max: 1090.0)\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 565, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 555, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 305, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: redshift_range_error\nError: Redshift values above maximum 10.0 found (max: 1090.0)\nContext: {'allowed_range': [0.0, 10.0], 'actual_range': [1090.0, 1090.0]}\nSuggested Actions:\n  1. Check that redshift values are within expected range [0.0, 10.0]\n  2. Review input data for outliers or data entry errors\n  3. Verify coordinate system and redshift definitions\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:39:46.851089+00:00", "memory": {"total": 33224306688, "available": 11900166144, "used": 21324140544, "percent": 64.2}, "disk": {"total": 1965300219904, "used": 866031050752, "free": 999361896448, "percent": 44.066094430819504}, "cpu": {"percent": 4.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_compatibility", "failure_time": "2025-10-23T13:39:46.863597+00:00", "processing_duration": 0.004102, "error_context": {"dataset_name": "bao_compatibility", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Processing failed for dataset 'unknown'\nStage: transformation\nError Type: bao_derivation_error\nError: None\nContext: {'raw_data_path': '/tmp/pytest-of-fabian/pytest-123/test_format_conversion_compati0/bao_compatibility.txt'}\nSuggested Actions:\n  1. Check raw data format and column names\n  2. Verify measurement type (isotropic/anisotropic) in metadata\n  3. Check unit specifications and survey information\n", "timestamp": "2025-10-23T13:39:46.862839+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11900518400, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-123/test_format_conversion_compati0/bao_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/venv/lib/python3.12/site-packages/pandas/core/indexes/base.py\", line 3812, in get_loc\n    return self._engine.get_loc(casted_key)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"pandas/_libs/index.pyx\", line 167, in pandas._libs.index.IndexEngine.get_loc\n  File \"pandas/_libs/index.pyx\", line 196, in pandas._libs.index.IndexEngine.get_loc\n  File \"pandas/_libs/hashtable_class_helper.pxi\", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item\n  File \"pandas/_libs/hashtable_class_helper.pxi\", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item\nKeyError: None\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 270, in derive\n    z, observable, uncertainty = self._extract_isotropic_measurements(data)\n                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 455, in _extract_isotropic_measurements\n    uncertainty = data[error_col].values\n                  ~~~~^^^^^^^^^^^\n  File \"/home/fabian/PBUF/venv/lib/python3.12/site-packages/pandas/core/frame.py\", line 4113, in __getitem__\n    indexer = self.columns.get_loc(key)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/venv/lib/python3.12/site-packages/pandas/core/indexes/base.py\", line 3819, in get_loc\n    raise KeyError(key) from err\nKeyError: None\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 307, in derive\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: transformation\nError Type: bao_derivation_error\nError: None\nContext: {'raw_data_path': '/tmp/pytest-of-fabian/pytest-123/test_format_conversion_compati0/bao_compatibility.txt'}\nSuggested Actions:\n  1. Check raw data format and column names\n  2. Verify measurement type (isotropic/anisotropic) in metadata\n  3. Check unit specifications and survey information\n\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:39:46.963848+00:00", "memory": {"total": 33224306688, "available": 11900518400, "used": 21323788288, "percent": 64.2}, "disk": {"total": 1965300219904, "used": 866031120384, "free": 999361826816, "percent": 44.06609797389141}, "cpu": {"percent": 4.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "bao_compatibility", "failure_time": "2025-10-23T13:39:56.408816+00:00", "processing_duration": 0.006833, "error_context": {"dataset_name": "bao_compatibility", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Processing failed for dataset 'unknown'\nStage: transformation\nError Type: bao_derivation_error\nError: None\nContext: {'raw_data_path': '/tmp/pytest-of-fabian/pytest-124/test_format_conversion_compati0/bao_compatibility.txt'}\nSuggested Actions:\n  1. Check raw data format and column names\n  2. Verify measurement type (isotropic/anisotropic) in metadata\n  3. Check unit specifications and survey information\n", "timestamp": "2025-10-23T13:39:56.406326+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10819121152, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-124/test_format_conversion_compati0/bao_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/venv/lib/python3.12/site-packages/pandas/core/indexes/base.py\", line 3812, in get_loc\n    return self._engine.get_loc(casted_key)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"pandas/_libs/index.pyx\", line 167, in pandas._libs.index.IndexEngine.get_loc\n  File \"pandas/_libs/index.pyx\", line 196, in pandas._libs.index.IndexEngine.get_loc\n  File \"pandas/_libs/hashtable_class_helper.pxi\", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item\n  File \"pandas/_libs/hashtable_class_helper.pxi\", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item\nKeyError: None\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 270, in derive\n    z, observable, uncertainty = self._extract_isotropic_measurements(data)\n                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 455, in _extract_isotropic_measurements\n    uncertainty = data[error_col].values\n                  ~~~~^^^^^^^^^^^\n  File \"/home/fabian/PBUF/venv/lib/python3.12/site-packages/pandas/core/frame.py\", line 4113, in __getitem__\n    indexer = self.columns.get_loc(key)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/venv/lib/python3.12/site-packages/pandas/core/indexes/base.py\", line 3819, in get_loc\n    raise KeyError(key) from err\nKeyError: None\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 307, in derive\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: transformation\nError Type: bao_derivation_error\nError: None\nContext: {'raw_data_path': '/tmp/pytest-of-fabian/pytest-124/test_format_conversion_compati0/bao_compatibility.txt'}\nSuggested Actions:\n  1. Check raw data format and column names\n  2. Verify measurement type (isotropic/anisotropic) in metadata\n  3. Check unit specifications and survey information\n\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:39:56.509119+00:00", "memory": {"total": 33224306688, "available": 10818347008, "used": 22405959680, "percent": 67.4}, "disk": {"total": 1965300219904, "used": 866032889856, "free": 999360057344, "percent": 44.06618800960108}, "cpu": {"percent": 10.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "bao_compatibility", "failure_time": "2025-10-23T13:40:43.047204+00:00", "processing_duration": 0.007285, "error_context": {"dataset_name": "bao_compatibility", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Processing failed for dataset 'unknown'\nStage: transformation\nError Type: bao_derivation_error\nError: None\nContext: {'raw_data_path': '/tmp/pytest-of-fabian/pytest-125/test_format_conversion_compati0/bao_compatibility.txt'}\nSuggested Actions:\n  1. Check raw data format and column names\n  2. Verify measurement type (isotropic/anisotropic) in metadata\n  3. Check unit specifications and survey information\n", "timestamp": "2025-10-23T13:40:43.044669+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10992836608, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-125/test_format_conversion_compati0/bao_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/venv/lib/python3.12/site-packages/pandas/core/indexes/base.py\", line 3812, in get_loc\n    return self._engine.get_loc(casted_key)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"pandas/_libs/index.pyx\", line 167, in pandas._libs.index.IndexEngine.get_loc\n  File \"pandas/_libs/index.pyx\", line 196, in pandas._libs.index.IndexEngine.get_loc\n  File \"pandas/_libs/hashtable_class_helper.pxi\", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item\n  File \"pandas/_libs/hashtable_class_helper.pxi\", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item\nKeyError: None\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 270, in derive\n    z, observable, uncertainty = self._extract_isotropic_measurements(data)\n                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 455, in _extract_isotropic_measurements\n    uncertainty = data[error_col].values\n                  ~~~~^^^^^^^^^^^\n  File \"/home/fabian/PBUF/venv/lib/python3.12/site-packages/pandas/core/frame.py\", line 4113, in __getitem__\n    indexer = self.columns.get_loc(key)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/venv/lib/python3.12/site-packages/pandas/core/indexes/base.py\", line 3819, in get_loc\n    raise KeyError(key) from err\nKeyError: None\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 307, in derive\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: transformation\nError Type: bao_derivation_error\nError: None\nContext: {'raw_data_path': '/tmp/pytest-of-fabian/pytest-125/test_format_conversion_compati0/bao_compatibility.txt'}\nSuggested Actions:\n  1. Check raw data format and column names\n  2. Verify measurement type (isotropic/anisotropic) in metadata\n  3. Check unit specifications and survey information\n\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:40:43.147562+00:00", "memory": {"total": 33224306688, "available": 11015413760, "used": 22208892928, "percent": 66.8}, "disk": {"total": 1965300219904, "used": 866037547008, "free": 999355400192, "percent": 44.06642497858692}, "cpu": {"percent": 9.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "bao_compatibility", "failure_time": "2025-10-23T13:41:29.316380+00:00", "processing_duration": 0.006606, "error_context": {"dataset_name": "bao_compatibility", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Processing failed for dataset 'unknown'\nStage: transformation\nError Type: bao_derivation_error\nError: None\nContext: {'raw_data_path': '/tmp/pytest-of-fabian/pytest-126/test_format_conversion_compati0/bao_compatibility.txt'}\nSuggested Actions:\n  1. Check raw data format and column names\n  2. Verify measurement type (isotropic/anisotropic) in metadata\n  3. Check unit specifications and survey information\n", "timestamp": "2025-10-23T13:41:29.313921+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11128954880, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-126/test_format_conversion_compati0/bao_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/venv/lib/python3.12/site-packages/pandas/core/indexes/base.py\", line 3812, in get_loc\n    return self._engine.get_loc(casted_key)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"pandas/_libs/index.pyx\", line 167, in pandas._libs.index.IndexEngine.get_loc\n  File \"pandas/_libs/index.pyx\", line 196, in pandas._libs.index.IndexEngine.get_loc\n  File \"pandas/_libs/hashtable_class_helper.pxi\", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item\n  File \"pandas/_libs/hashtable_class_helper.pxi\", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item\nKeyError: None\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 270, in derive\n    z, observable, uncertainty = self._extract_isotropic_measurements(data)\n                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 455, in _extract_isotropic_measurements\n    uncertainty = data[error_col].values\n                  ~~~~^^^^^^^^^^^\n  File \"/home/fabian/PBUF/venv/lib/python3.12/site-packages/pandas/core/frame.py\", line 4113, in __getitem__\n    indexer = self.columns.get_loc(key)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/venv/lib/python3.12/site-packages/pandas/core/indexes/base.py\", line 3819, in get_loc\n    raise KeyError(key) from err\nKeyError: None\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 307, in derive\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: transformation\nError Type: bao_derivation_error\nError: None\nContext: {'raw_data_path': '/tmp/pytest-of-fabian/pytest-126/test_format_conversion_compati0/bao_compatibility.txt'}\nSuggested Actions:\n  1. Check raw data format and column names\n  2. Verify measurement type (isotropic/anisotropic) in metadata\n  3. Check unit specifications and survey information\n\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:41:29.416653+00:00", "memory": {"total": 33224306688, "available": 11125084160, "used": 22099222528, "percent": 66.5}, "disk": {"total": 1965300219904, "used": 866038329344, "free": 999354617856, "percent": 44.06646478604189}, "cpu": {"percent": 11.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "cmb_compatibility", "failure_time": "2025-10-23T13:42:32.826313+00:00", "processing_duration": 0.004247, "error_context": {"dataset_name": "cmb_compatibility", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "redshift_range_error", "error_message": "Redshift values above maximum 10.0 found (max: 1090.0)", "timestamp": "2025-10-23T13:42:32.825310+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11325440000, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["dataset_type", "data_type", "source", "citation", "version", "processing_timestamp", "redshift", "n_parameters", "n_points", "parameters", "parameter_descriptions", "transformations_applied", "dimensionless_consistency_check", "parameter_validation", "parameter_extraction"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 303, in validate\n    return dataset.validate_redshift_range(self.min_z, self.max_z)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 396, in validate_redshift_range\n    raise ValueError(f\"Redshift values above maximum {max_z} found (max: {max_found})\")\nValueError: Redshift values above maximum 10.0 found (max: 1090.0)\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 565, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 555, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 305, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: redshift_range_error\nError: Redshift values above maximum 10.0 found (max: 1090.0)\nContext: {'allowed_range': [0.0, 10.0], 'actual_range': [1090.0, 1090.0]}\nSuggested Actions:\n  1. Check that redshift values are within expected range [0.0, 10.0]\n  2. Review input data for outliers or data entry errors\n  3. Verify coordinate system and redshift definitions\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:42:32.926676+00:00", "memory": {"total": 33224306688, "available": 11325440000, "used": 21898866688, "percent": 65.9}, "disk": {"total": 1965300219904, "used": 866039980032, "free": 999352967168, "percent": 44.06654877768771}, "cpu": {"percent": 31.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T13:42:44.672040+00:00", "processing_duration": 0.003888, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T13:42:44.670927+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11099516928, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 211, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 565, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 555, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:42:44.772358+00:00", "memory": {"total": 33224306688, "available": 11099516928, "used": 22124789760, "percent": 66.6}, "disk": {"total": 1965300219904, "used": 866040754176, "free": 999352193024, "percent": 44.06658816831069}, "cpu": {"percent": 16.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T13:42:44.777836+00:00", "processing_duration": 0.002697, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T13:42:44.878169+00:00", "memory": {"total": 33224306688, "available": 11045433344, "used": 22178873344, "percent": 66.8}, "disk": {"total": 1965300219904, "used": 866040770560, "free": 999352176640, "percent": 44.06658900197466}, "cpu": {"percent": 25.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T13:42:44.881194+00:00", "processing_duration": 0.002348, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T13:42:44.880816+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11036618752, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:42:44.981459+00:00", "memory": {"total": 33224306688, "available": 11036618752, "used": 22187687936, "percent": 66.8}, "disk": {"total": 1965300219904, "used": 866040791040, "free": 999352156160, "percent": 44.066590044054635}, "cpu": {"percent": 9.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:42:45.184995+00:00", "processing_duration": 0.002752, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T13:42:45.184592+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10407874560, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:42:45.285229+00:00", "memory": {"total": 33224306688, "available": 10407874560, "used": 22816432128, "percent": 68.7}, "disk": {"total": 1965300219904, "used": 866041122816, "free": 999351824384, "percent": 44.0666069257502}, "cpu": {"percent": 9.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:42:45.290585+00:00", "processing_duration": 0.004053, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T13:42:45.289868+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10879746048, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-128/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:42:45.390978+00:00", "memory": {"total": 33224306688, "available": 10880061440, "used": 22344245248, "percent": 67.3}, "disk": {"total": 1965300219904, "used": 866041155584, "free": 999351791616, "percent": 44.06660859307816}, "cpu": {"percent": 10.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:42:45.396949+00:00", "processing_duration": 0.004122, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T13:42:45.396199+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10546528256, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 565, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 555, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:42:45.497330+00:00", "memory": {"total": 33224306688, "available": 10546528256, "used": 22677778432, "percent": 68.3}, "disk": {"total": 1965300219904, "used": 866041180160, "free": 999351767040, "percent": 44.06660984357413}, "cpu": {"percent": 11.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T13:42:52.618521+00:00", "processing_duration": 0.004557, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "redshift_range_error", "error_message": "Redshift values above maximum 10.0 found (max: 1090.0)", "timestamp": "2025-10-23T13:42:52.617935+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11865198592, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["dataset_type", "data_type", "source", "citation", "version", "processing_timestamp", "redshift", "n_parameters", "n_points", "parameters", "parameter_descriptions", "transformations_applied", "dimensionless_consistency_check", "parameter_validation", "parameter_extraction"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 303, in validate\n    return dataset.validate_redshift_range(self.min_z, self.max_z)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 396, in validate_redshift_range\n    raise ValueError(f\"Redshift values above maximum {max_z} found (max: {max_found})\")\nValueError: Redshift values above maximum 10.0 found (max: 1090.0)\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 565, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 555, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 305, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: redshift_range_error\nError: Redshift values above maximum 10.0 found (max: 1090.0)\nContext: {'allowed_range': [0.0, 10.0], 'actual_range': [1090.0, 1090.0]}\nSuggested Actions:\n  1. Check that redshift values are within expected range [0.0, 10.0]\n  2. Review input data for outliers or data entry errors\n  3. Verify coordinate system and redshift definitions\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:42:52.718792+00:00", "memory": {"total": 33224306688, "available": 11865198592, "used": 21359108096, "percent": 64.3}, "disk": {"total": 1965300219904, "used": 866041458688, "free": 999351488512, "percent": 44.066624015861755}, "cpu": {"percent": 5.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_compatibility", "failure_time": "2025-10-23T13:42:52.734812+00:00", "processing_duration": 0.003376, "error_context": {"dataset_name": "cmb_compatibility", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "redshift_range_error", "error_message": "Redshift values above maximum 10.0 found (max: 1090.0)", "timestamp": "2025-10-23T13:42:52.734216+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11865055232, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["dataset_type", "data_type", "source", "citation", "version", "processing_timestamp", "redshift", "n_parameters", "n_points", "parameters", "parameter_descriptions", "transformations_applied", "dimensionless_consistency_check", "parameter_validation", "parameter_extraction"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 303, in validate\n    return dataset.validate_redshift_range(self.min_z, self.max_z)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 396, in validate_redshift_range\n    raise ValueError(f\"Redshift values above maximum {max_z} found (max: {max_found})\")\nValueError: Redshift values above maximum 10.0 found (max: 1090.0)\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 565, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 555, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 305, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: redshift_range_error\nError: Redshift values above maximum 10.0 found (max: 1090.0)\nContext: {'allowed_range': [0.0, 10.0], 'actual_range': [1090.0, 1090.0]}\nSuggested Actions:\n  1. Check that redshift values are within expected range [0.0, 10.0]\n  2. Review input data for outliers or data entry errors\n  3. Verify coordinate system and redshift definitions\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:42:52.835088+00:00", "memory": {"total": 33224306688, "available": 11865055232, "used": 21359251456, "percent": 64.3}, "disk": {"total": 1965300219904, "used": 866041573376, "free": 999351373824, "percent": 44.06662985150961}, "cpu": {"percent": 4.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T13:44:59.469247+00:00", "processing_duration": 0.003877, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T13:44:59.468137+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11013881856, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 211, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 565, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 555, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:44:59.569499+00:00", "memory": {"total": 33224306688, "available": 11009265664, "used": 22215041024, "percent": 66.9}, "disk": {"total": 1965300219904, "used": 866049826816, "free": 999343120384, "percent": 44.067049809738705}, "cpu": {"percent": 13.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T13:44:59.575563+00:00", "processing_duration": 0.002707, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T13:44:59.675923+00:00", "memory": {"total": 33224306688, "available": 11035475968, "used": 22188830720, "percent": 66.8}, "disk": {"total": 1965300219904, "used": 866049843200, "free": 999343104000, "percent": 44.06705064340268}, "cpu": {"percent": 20.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T13:44:59.679003+00:00", "processing_duration": 0.002321, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T13:44:59.678548+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10895659008, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:44:59.779324+00:00", "memory": {"total": 33224306688, "available": 10895659008, "used": 22328647680, "percent": 67.2}, "disk": {"total": 1965300219904, "used": 866049867776, "free": 999343079424, "percent": 44.06705189389865}, "cpu": {"percent": 28.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:44:59.984978+00:00", "processing_duration": 0.00265, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T13:44:59.984617+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10946183168, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:45:00.085231+00:00", "memory": {"total": 33224306688, "available": 10946183168, "used": 22278123520, "percent": 67.1}, "disk": {"total": 1965300219904, "used": 866050203648, "free": 999342743552, "percent": 44.06706898401021}, "cpu": {"percent": 22.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:45:00.089606+00:00", "processing_duration": 0.00314, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T13:45:00.088952+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11151855616, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-129/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:45:00.189922+00:00", "memory": {"total": 33224306688, "available": 11173421056, "used": 22050885632, "percent": 66.4}, "disk": {"total": 1965300219904, "used": 866050232320, "free": 999342714880, "percent": 44.067070442922166}, "cpu": {"percent": 27.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:45:00.196214+00:00", "processing_duration": 0.004505, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T13:45:00.195275+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11135275008, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 565, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 555, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:45:00.296472+00:00", "memory": {"total": 33224306688, "available": 11135016960, "used": 22089289728, "percent": 66.5}, "disk": {"total": 1965300219904, "used": 866050265088, "free": 999342682112, "percent": 44.06707211025013}, "cpu": {"percent": 10.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T13:45:07.824591+00:00", "processing_duration": 0.004897, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "redshift_range_error", "error_message": "Redshift values above maximum 10.0 found (max: 1090.0)", "timestamp": "2025-10-23T13:45:07.823944+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12119097344, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["dataset_type", "data_type", "source", "citation", "version", "processing_timestamp", "redshift", "n_parameters", "n_points", "parameters", "parameter_descriptions", "transformations_applied", "dimensionless_consistency_check", "parameter_validation", "parameter_extraction"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 303, in validate\n    return dataset.validate_redshift_range(self.min_z, self.max_z)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 396, in validate_redshift_range\n    raise ValueError(f\"Redshift values above maximum {max_z} found (max: {max_found})\")\nValueError: Redshift values above maximum 10.0 found (max: 1090.0)\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 565, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 555, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 305, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: redshift_range_error\nError: Redshift values above maximum 10.0 found (max: 1090.0)\nContext: {'allowed_range': [0.0, 10.0], 'actual_range': [1090.0, 1090.0]}\nSuggested Actions:\n  1. Check that redshift values are within expected range [0.0, 10.0]\n  2. Review input data for outliers or data entry errors\n  3. Verify coordinate system and redshift definitions\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:45:07.924950+00:00", "memory": {"total": 33224306688, "available": 12119097344, "used": 21105209344, "percent": 63.5}, "disk": {"total": 1965300219904, "used": 866050502656, "free": 999342444544, "percent": 44.06708419837781}, "cpu": {"percent": 30.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_compatibility", "failure_time": "2025-10-23T13:45:07.943918+00:00", "processing_duration": 0.004754, "error_context": {"dataset_name": "cmb_compatibility", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "redshift_range_error", "error_message": "Redshift values above maximum 10.0 found (max: 1090.0)", "timestamp": "2025-10-23T13:45:07.943034+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12148076544, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["dataset_type", "data_type", "source", "citation", "version", "processing_timestamp", "redshift", "n_parameters", "n_points", "parameters", "parameter_descriptions", "transformations_applied", "dimensionless_consistency_check", "parameter_validation", "parameter_extraction"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 303, in validate\n    return dataset.validate_redshift_range(self.min_z, self.max_z)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 396, in validate_redshift_range\n    raise ValueError(f\"Redshift values above maximum {max_z} found (max: {max_found})\")\nValueError: Redshift values above maximum 10.0 found (max: 1090.0)\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 565, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 555, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 305, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: redshift_range_error\nError: Redshift values above maximum 10.0 found (max: 1090.0)\nContext: {'allowed_range': [0.0, 10.0], 'actual_range': [1090.0, 1090.0]}\nSuggested Actions:\n  1. Check that redshift values are within expected range [0.0, 10.0]\n  2. Review input data for outliers or data entry errors\n  3. Verify coordinate system and redshift definitions\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:45:08.044144+00:00", "memory": {"total": 33224306688, "available": 12147818496, "used": 21076488192, "percent": 63.4}, "disk": {"total": 1965300219904, "used": 866050605056, "free": 999342342144, "percent": 44.067089408777676}, "cpu": {"percent": 8.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_compatibility", "failure_time": "2025-10-23T13:45:27.707024+00:00", "processing_duration": 0.003687, "error_context": {"dataset_name": "cmb_compatibility", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "redshift_range_error", "error_message": "Redshift values above maximum 10.0 found (max: 1090.0)", "timestamp": "2025-10-23T13:45:27.706059+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10198212608, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["dataset_type", "data_type", "source", "citation", "version", "processing_timestamp", "redshift", "n_parameters", "n_points", "parameters", "parameter_descriptions", "transformations_applied", "dimensionless_consistency_check", "parameter_validation", "parameter_extraction"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 303, in validate\n    return dataset.validate_redshift_range(self.min_z, self.max_z)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 396, in validate_redshift_range\n    raise ValueError(f\"Redshift values above maximum {max_z} found (max: {max_found})\")\nValueError: Redshift values above maximum 10.0 found (max: 1090.0)\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 565, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 555, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 305, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: redshift_range_error\nError: Redshift values above maximum 10.0 found (max: 1090.0)\nContext: {'allowed_range': [0.0, 10.0], 'actual_range': [1090.0, 1090.0]}\nSuggested Actions:\n  1. Check that redshift values are within expected range [0.0, 10.0]\n  2. Review input data for outliers or data entry errors\n  3. Verify coordinate system and redshift definitions\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:45:27.807336+00:00", "memory": {"total": 33224306688, "available": 10198212608, "used": 23026094080, "percent": 69.3}, "disk": {"total": 1965300219904, "used": 866052440064, "free": 999340507136, "percent": 44.06718277914325}, "cpu": {"percent": 11.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_compatibility", "failure_time": "2025-10-23T13:46:19.391995+00:00", "processing_duration": 0.003716, "error_context": {"dataset_name": "cmb_compatibility", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "duplicate_redshift_error", "error_message": "Duplicate redshift values found: 1 unique values with duplicates", "timestamp": "2025-10-23T13:46:19.391157+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10805526528, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["dataset_type", "data_type", "source", "citation", "version", "processing_timestamp", "redshift", "n_parameters", "n_points", "parameters", "parameter_descriptions", "transformations_applied", "dimensionless_consistency_check", "parameter_validation", "parameter_extraction"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 575, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 565, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 383, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: duplicate_redshift_error\nError: Duplicate redshift values found: 1 unique values with duplicates\nContext: {'duplicate_redshifts': [1090.0], 'duplicate_counts': [3], 'total_duplicates': 1}\nSuggested Actions:\n  1. Remove duplicate entries or average observables at same redshift\n  2. Check data loading process for duplicate rows\n  3. Verify redshift precision and rounding issues\n  4. Consider binning strategy for closely spaced redshifts\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:46:19.492339+00:00", "memory": {"total": 33224306688, "available": 10805526528, "used": 22418780160, "percent": 67.5}, "disk": {"total": 1965300219904, "used": 866057027584, "free": 999335919616, "percent": 44.0674162050572}, "cpu": {"percent": 15.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_compatibility", "failure_time": "2025-10-23T13:46:39.771059+00:00", "processing_duration": 0.004137, "error_context": {"dataset_name": "cmb_compatibility", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "duplicate_redshift_error", "error_message": "Duplicate redshift values found: 1 unique values with duplicates", "timestamp": "2025-10-23T13:46:39.769955+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10714267648, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["dataset_type", "data_type", "source", "citation", "version", "processing_timestamp", "redshift", "n_parameters", "n_points", "parameters", "parameter_descriptions", "transformations_applied", "dimensionless_consistency_check", "parameter_validation", "parameter_extraction"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 575, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 565, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 383, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: duplicate_redshift_error\nError: Duplicate redshift values found: 1 unique values with duplicates\nContext: {'duplicate_redshifts': [1090.0], 'duplicate_counts': [3], 'total_duplicates': 1}\nSuggested Actions:\n  1. Remove duplicate entries or average observables at same redshift\n  2. Check data loading process for duplicate rows\n  3. Verify redshift precision and rounding issues\n  4. Consider binning strategy for closely spaced redshifts\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:46:39.871468+00:00", "memory": {"total": 33224306688, "available": 10738823168, "used": 22485483520, "percent": 67.7}, "disk": {"total": 1965300219904, "used": 866056466432, "free": 999336480768, "percent": 44.06738765206594}, "cpu": {"percent": 10.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T13:48:20.256021+00:00", "processing_duration": 0.004687, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T13:48:20.254564+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11411906560, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 211, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 579, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 569, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:48:20.356392+00:00", "memory": {"total": 33224306688, "available": 11411906560, "used": 21812400128, "percent": 65.7}, "disk": {"total": 1965300219904, "used": 866053963776, "free": 999338983424, "percent": 44.06726030989324}, "cpu": {"percent": 20.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T13:48:20.361845+00:00", "processing_duration": 0.002727, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T13:48:20.462121+00:00", "memory": {"total": 33224306688, "available": 11374944256, "used": 21849362432, "percent": 65.8}, "disk": {"total": 1965300219904, "used": 866053988352, "free": 999338958848, "percent": 44.06726156038921}, "cpu": {"percent": 20.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T13:48:20.465197+00:00", "processing_duration": 0.002431, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T13:48:20.464785+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11327397888, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:48:20.565536+00:00", "memory": {"total": 33224306688, "available": 11327397888, "used": 21896908800, "percent": 65.9}, "disk": {"total": 1965300219904, "used": 866054008832, "free": 999338938368, "percent": 44.067262602469185}, "cpu": {"percent": 6.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:48:20.756155+00:00", "processing_duration": 0.002573, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T13:48:20.755822+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11438907392, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:48:20.856400+00:00", "memory": {"total": 33224306688, "available": 11438907392, "used": 21785399296, "percent": 65.6}, "disk": {"total": 1965300219904, "used": 866054340608, "free": 999338606592, "percent": 44.06727948416474}, "cpu": {"percent": 7.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:48:20.860842+00:00", "processing_duration": 0.003277, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T13:48:20.860237+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11314339840, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-135/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:48:20.961111+00:00", "memory": {"total": 33224306688, "available": 11314339840, "used": 21909966848, "percent": 65.9}, "disk": {"total": 1965300219904, "used": 866054381568, "free": 999338565632, "percent": 44.06728156832469}, "cpu": {"percent": 10.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:48:20.965924+00:00", "processing_duration": 0.003441, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T13:48:20.965160+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11268096000, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 579, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 569, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:48:21.066217+00:00", "memory": {"total": 33224306688, "available": 11259838464, "used": 21964468224, "percent": 66.1}, "disk": {"total": 1965300219904, "used": 866054410240, "free": 999338536960, "percent": 44.067283027236655}, "cpu": {"percent": 9.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T13:48:45.853299+00:00", "processing_duration": 0.004026, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T13:48:45.852204+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11074117632, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 211, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 579, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 569, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:48:45.953681+00:00", "memory": {"total": 33224306688, "available": 11073601536, "used": 22150705152, "percent": 66.7}, "disk": {"total": 1965300219904, "used": 866025521152, "free": 999367426048, "percent": 44.065813069226806}, "cpu": {"percent": 11.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T13:48:45.959265+00:00", "processing_duration": 0.002939, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T13:48:46.059610+00:00", "memory": {"total": 33224306688, "available": 10851274752, "used": 22373031936, "percent": 67.3}, "disk": {"total": 1965300219904, "used": 866025541632, "free": 999367405568, "percent": 44.06581411130678}, "cpu": {"percent": 21.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T13:48:46.062308+00:00", "processing_duration": 0.002033, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T13:48:46.061944+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10683125760, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:48:46.162551+00:00", "memory": {"total": 33224306688, "available": 10699673600, "used": 22524633088, "percent": 67.8}, "disk": {"total": 1965300219904, "used": 866025558016, "free": 999367389184, "percent": 44.06581494497076}, "cpu": {"percent": 8.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:48:46.358693+00:00", "processing_duration": 0.002755, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T13:48:46.358349+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10885271552, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:48:46.458935+00:00", "memory": {"total": 33224306688, "available": 10885271552, "used": 22339035136, "percent": 67.2}, "disk": {"total": 1965300219904, "used": 866025893888, "free": 999367053312, "percent": 44.065832035082316}, "cpu": {"percent": 9.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:48:46.464047+00:00", "processing_duration": 0.003875, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T13:48:46.463279+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10913026048, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-136/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:48:46.564381+00:00", "memory": {"total": 33224306688, "available": 10913026048, "used": 22311280640, "percent": 67.2}, "disk": {"total": 1965300219904, "used": 866025930752, "free": 999367016448, "percent": 44.065833910826264}, "cpu": {"percent": 9.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:48:46.570001+00:00", "processing_duration": 0.003946, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T13:48:46.569154+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10699616256, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 579, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 569, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:48:46.670247+00:00", "memory": {"total": 33224306688, "available": 10699616256, "used": 22524690432, "percent": 67.8}, "disk": {"total": 1965300219904, "used": 866025955328, "free": 999366991872, "percent": 44.065835161322234}, "cpu": {"percent": 9.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T13:49:55.793191+00:00", "processing_duration": 0.004569, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T13:49:55.791899+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10739159040, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 211, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 579, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 569, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:49:55.893522+00:00", "memory": {"total": 33224306688, "available": 10739159040, "used": 22485147648, "percent": 67.7}, "disk": {"total": 1965300219904, "used": 866031771648, "free": 999361175552, "percent": 44.066131112034554}, "cpu": {"percent": 10.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T13:49:55.898938+00:00", "processing_duration": 0.002565, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T13:49:55.999248+00:00", "memory": {"total": 33224306688, "available": 10637119488, "used": 22587187200, "percent": 68.0}, "disk": {"total": 1965300219904, "used": 866031788032, "free": 999361159168, "percent": 44.06613194569853}, "cpu": {"percent": 8.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T13:49:56.001624+00:00", "processing_duration": 0.00185, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T13:49:56.001266+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10481176576, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:49:56.101860+00:00", "memory": {"total": 33224306688, "available": 10481176576, "used": 22743130112, "percent": 68.5}, "disk": {"total": 1965300219904, "used": 866031812608, "free": 999361134592, "percent": 44.06613319619449}, "cpu": {"percent": 11.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:49:56.311968+00:00", "processing_duration": 0.00284, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T13:49:56.311599+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10674536448, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:49:56.412304+00:00", "memory": {"total": 33224306688, "available": 10674536448, "used": 22549770240, "percent": 67.9}, "disk": {"total": 1965300219904, "used": 866032148480, "free": 999360798720, "percent": 44.066150286306055}, "cpu": {"percent": 19.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:49:56.417682+00:00", "processing_duration": 0.003845, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T13:49:56.417040+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11104157696, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-139/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:49:56.517945+00:00", "memory": {"total": 33224306688, "available": 11095900160, "used": 22128406528, "percent": 66.6}, "disk": {"total": 1965300219904, "used": 866032181248, "free": 999360765952, "percent": 44.066151953634005}, "cpu": {"percent": 6.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:49:56.523306+00:00", "processing_duration": 0.004012, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T13:49:56.522577+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10923220992, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 579, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 569, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:49:56.623545+00:00", "memory": {"total": 33224306688, "available": 10923220992, "used": 22301085696, "percent": 67.1}, "disk": {"total": 1965300219904, "used": 866032201728, "free": 999360745472, "percent": 44.06615299571398}, "cpu": {"percent": 6.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T13:51:12.093562+00:00", "processing_duration": 0.004388, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T13:51:12.092389+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11684503552, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 211, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 579, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 569, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:51:12.193829+00:00", "memory": {"total": 33224306688, "available": 11683012608, "used": 21541294080, "percent": 64.8}, "disk": {"total": 1965300219904, "used": 866033328128, "free": 999359619072, "percent": 44.066210310112496}, "cpu": {"percent": 10.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T13:51:12.199336+00:00", "processing_duration": 0.002703, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T13:51:12.299618+00:00", "memory": {"total": 33224306688, "available": 11577659392, "used": 21646647296, "percent": 65.2}, "disk": {"total": 1965300219904, "used": 866033348608, "free": 999359598592, "percent": 44.06621135219247}, "cpu": {"percent": 10.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T13:51:12.302326+00:00", "processing_duration": 0.00204, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T13:51:12.301962+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11253972992, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:51:12.402573+00:00", "memory": {"total": 33224306688, "available": 11253972992, "used": 21970333696, "percent": 66.1}, "disk": {"total": 1965300219904, "used": 866033364992, "free": 999359582208, "percent": 44.06621218585644}, "cpu": {"percent": 10.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:51:12.608737+00:00", "processing_duration": 0.003103, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T13:51:12.608335+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11290460160, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:51:12.709039+00:00", "memory": {"total": 33224306688, "available": 11288395776, "used": 21935910912, "percent": 66.0}, "disk": {"total": 1965300219904, "used": 866033700864, "free": 999359246336, "percent": 44.066229275968006}, "cpu": {"percent": 10.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:51:12.714074+00:00", "processing_duration": 0.003614, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T13:51:12.713455+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11766030336, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-140/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:51:12.814359+00:00", "memory": {"total": 33224306688, "available": 11763105792, "used": 21461200896, "percent": 64.6}, "disk": {"total": 1965300219904, "used": 866033737728, "free": 999359209472, "percent": 44.06623115171195}, "cpu": {"percent": 8.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T13:51:12.819237+00:00", "processing_duration": 0.003552, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T13:51:12.818634+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11556954112, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 579, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 569, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T13:51:12.919472+00:00", "memory": {"total": 33224306688, "available": 11556954112, "used": 21667352576, "percent": 65.2}, "disk": {"total": 1965300219904, "used": 866033766400, "free": 999359180800, "percent": 44.06623261062392}, "cpu": {"percent": 7.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T14:02:09.312802+00:00", "processing_duration": 0.00444, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T14:02:09.311570+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11547688960, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 211, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 579, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 569, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:02:09.413157+00:00", "memory": {"total": 33224306688, "available": 11541381120, "used": 21682925568, "percent": 65.3}, "disk": {"total": 1965300219904, "used": 866039025664, "free": 999353921536, "percent": 44.06650021676097}, "cpu": {"percent": 10.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T14:02:09.418720+00:00", "processing_duration": 0.003236, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T14:02:09.519089+00:00", "memory": {"total": 33224306688, "available": 11263950848, "used": 21960355840, "percent": 66.1}, "disk": {"total": 1965300219904, "used": 866039042048, "free": 999353905152, "percent": 44.06650105042495}, "cpu": {"percent": 10.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T14:02:09.521959+00:00", "processing_duration": 0.002147, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T14:02:09.521575+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11001094144, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:02:09.622232+00:00", "memory": {"total": 33224306688, "available": 11001094144, "used": 22223212544, "percent": 66.9}, "disk": {"total": 1965300219904, "used": 866039062528, "free": 999353884672, "percent": 44.06650209250492}, "cpu": {"percent": 9.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:02:09.875489+00:00", "processing_duration": 0.003208, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T14:02:09.875128+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11358232576, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:02:09.975820+00:00", "memory": {"total": 33224306688, "available": 11371180032, "used": 21853126656, "percent": 65.8}, "disk": {"total": 1965300219904, "used": 866039402496, "free": 999353544704, "percent": 44.06651939103247}, "cpu": {"percent": 8.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:02:09.981475+00:00", "processing_duration": 0.003955, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T14:02:09.980821+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11449663488, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-145/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:02:10.081706+00:00", "memory": {"total": 33224306688, "available": 11449663488, "used": 21774643200, "percent": 65.5}, "disk": {"total": 1965300219904, "used": 866039431168, "free": 999353516032, "percent": 44.06652084994443}, "cpu": {"percent": 7.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:02:10.086662+00:00", "processing_duration": 0.003682, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T14:02:10.086068+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11305418752, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 579, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 569, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:02:10.186874+00:00", "memory": {"total": 33224306688, "available": 11305418752, "used": 21918887936, "percent": 66.0}, "disk": {"total": 1965300219904, "used": 866039459840, "free": 999353487360, "percent": 44.0665223088564}, "cpu": {"percent": 6.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T14:11:56.691620+00:00", "processing_duration": 0.004462, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T14:11:56.690488+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11151912960, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 211, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 582, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 572, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:11:56.792012+00:00", "memory": {"total": 33224306688, "available": 11151912960, "used": 22072393728, "percent": 66.4}, "disk": {"total": 1965300219904, "used": 866070319104, "free": 999322628096, "percent": 44.06809251495964}, "cpu": {"percent": 11.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T14:11:56.797965+00:00", "processing_duration": 0.00262, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T14:11:56.898214+00:00", "memory": {"total": 33224306688, "available": 10811609088, "used": 22412697600, "percent": 67.5}, "disk": {"total": 1965300219904, "used": 866070335488, "free": 999322611712, "percent": 44.06809334862362}, "cpu": {"percent": 12.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T14:11:56.901085+00:00", "processing_duration": 0.002366, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T14:11:56.900566+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11089481728, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:11:57.001491+00:00", "memory": {"total": 33224306688, "available": 11087532032, "used": 22136774656, "percent": 66.6}, "disk": {"total": 1965300219904, "used": 866070355968, "free": 999322591232, "percent": 44.06809439070359}, "cpu": {"percent": 18.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:11:57.207486+00:00", "processing_duration": 0.003073, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T14:11:57.207105+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10802089984, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:11:57.307755+00:00", "memory": {"total": 33224306688, "available": 10800910336, "used": 22423396352, "percent": 67.5}, "disk": {"total": 1965300219904, "used": 866070687744, "free": 999322259456, "percent": 44.06811127239916}, "cpu": {"percent": 14.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:11:57.312808+00:00", "processing_duration": 0.003811, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T14:11:57.312071+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10644361216, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-154/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:11:57.413076+00:00", "memory": {"total": 33224306688, "available": 10643247104, "used": 22581059584, "percent": 68.0}, "disk": {"total": 1965300219904, "used": 866070720512, "free": 999322226688, "percent": 44.06811293972711}, "cpu": {"percent": 9.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:11:57.418175+00:00", "processing_duration": 0.003675, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T14:11:57.417582+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10353377280, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 582, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 572, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:11:57.518454+00:00", "memory": {"total": 33224306688, "available": 10353377280, "used": 22870929408, "percent": 68.8}, "disk": {"total": 1965300219904, "used": 866070745088, "free": 999322202112, "percent": 44.06811419022308}, "cpu": {"percent": 10.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T14:12:23.145195+00:00", "processing_duration": 0.004822, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T14:12:23.143971+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11524669440, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 211, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 582, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 572, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:12:23.245590+00:00", "memory": {"total": 33224306688, "available": 11522633728, "used": 21701672960, "percent": 65.3}, "disk": {"total": 1965300219904, "used": 866072952832, "free": 999319994368, "percent": 44.068226526444164}, "cpu": {"percent": 9.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T14:12:23.251085+00:00", "processing_duration": 0.002537, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T14:12:23.351392+00:00", "memory": {"total": 33224306688, "available": 11451441152, "used": 21772865536, "percent": 65.5}, "disk": {"total": 1965300219904, "used": 866072973312, "free": 999319973888, "percent": 44.06822756852414}, "cpu": {"percent": 11.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T14:12:23.354217+00:00", "processing_duration": 0.002072, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T14:12:23.353856+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11097661440, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:12:23.454454+00:00", "memory": {"total": 33224306688, "available": 11097661440, "used": 22126645248, "percent": 66.6}, "disk": {"total": 1965300219904, "used": 866072989696, "free": 999319957504, "percent": 44.06822840218811}, "cpu": {"percent": 11.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:12:23.658963+00:00", "processing_duration": 0.003011, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T14:12:23.658584+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11175157760, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:12:23.759234+00:00", "memory": {"total": 33224306688, "available": 11175157760, "used": 22049148928, "percent": 66.4}, "disk": {"total": 1965300219904, "used": 866073333760, "free": 999319613440, "percent": 44.06824590913166}, "cpu": {"percent": 9.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:12:23.764366+00:00", "processing_duration": 0.003597, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T14:12:23.763775+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11295535104, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-155/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:12:23.864681+00:00", "memory": {"total": 33224306688, "available": 11295535104, "used": 21928771584, "percent": 66.0}, "disk": {"total": 1965300219904, "used": 866073362432, "free": 999319584768, "percent": 44.06824736804362}, "cpu": {"percent": 9.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:12:23.870014+00:00", "processing_duration": 0.003781, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T14:12:23.869412+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11590168576, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 582, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 572, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:12:23.970281+00:00", "memory": {"total": 33224306688, "available": 11581911040, "used": 21642395648, "percent": 65.1}, "disk": {"total": 1965300219904, "used": 866073387008, "free": 999319560192, "percent": 44.06824861853959}, "cpu": {"percent": 7.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T14:15:53.956226+00:00", "processing_duration": 0.004253, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T14:15:53.955013+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10753490944, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 211, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 650, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 640, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:15:54.056528+00:00", "memory": {"total": 33224306688, "available": 10753490944, "used": 22470815744, "percent": 67.6}, "disk": {"total": 1965300219904, "used": 866085765120, "free": 999307182080, "percent": 44.06887845167524}, "cpu": {"percent": 9.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T14:15:54.061483+00:00", "processing_duration": 0.00252, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T14:15:54.161715+00:00", "memory": {"total": 33224306688, "available": 11162918912, "used": 22061387776, "percent": 66.4}, "disk": {"total": 1965300219904, "used": 866085781504, "free": 999307165696, "percent": 44.06887928533922}, "cpu": {"percent": 12.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T14:15:54.164199+00:00", "processing_duration": 0.002001, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T14:15:54.163857+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11126829056, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:15:54.264422+00:00", "memory": {"total": 33224306688, "available": 11126829056, "used": 22097477632, "percent": 66.5}, "disk": {"total": 1965300219904, "used": 866085801984, "free": 999307145216, "percent": 44.068880327419194}, "cpu": {"percent": 7.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:15:54.455568+00:00", "processing_duration": 0.00278, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T14:15:54.455176+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11236843520, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:15:54.555866+00:00", "memory": {"total": 33224306688, "available": 11236843520, "used": 21987463168, "percent": 66.2}, "disk": {"total": 1965300219904, "used": 866086137856, "free": 999306809344, "percent": 44.06889741753075}, "cpu": {"percent": 15.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:15:54.560647+00:00", "processing_duration": 0.003411, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T14:15:54.559974+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11099058176, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-159/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:15:54.660957+00:00", "memory": {"total": 33224306688, "available": 11099058176, "used": 22125248512, "percent": 66.6}, "disk": {"total": 1965300219904, "used": 866086162432, "free": 999306784768, "percent": 44.06889866802672}, "cpu": {"percent": 6.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:15:54.666543+00:00", "processing_duration": 0.004232, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T14:15:54.665892+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11501568000, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 650, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 640, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:15:54.766895+00:00", "memory": {"total": 33224306688, "available": 11501568000, "used": 21722738688, "percent": 65.4}, "disk": {"total": 1965300219904, "used": 866086191104, "free": 999306756096, "percent": 44.06890012693868}, "cpu": {"percent": 6.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T14:16:16.603472+00:00", "processing_duration": 0.004739, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T14:16:16.602162+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11077222400, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 211, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 650, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 640, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:16:16.703724+00:00", "memory": {"total": 33224306688, "available": 11095973888, "used": 22128332800, "percent": 66.6}, "disk": {"total": 1965300219904, "used": 866088865792, "free": 999304081408, "percent": 44.069036222583144}, "cpu": {"percent": 10.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T14:16:16.708770+00:00", "processing_duration": 0.002379, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T14:16:16.809011+00:00", "memory": {"total": 33224306688, "available": 11075342336, "used": 22148964352, "percent": 66.7}, "disk": {"total": 1965300219904, "used": 866088869888, "free": 999304077312, "percent": 44.06903643099914}, "cpu": {"percent": 12.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T14:16:16.811602+00:00", "processing_duration": 0.002064, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T14:16:16.811159+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10716536832, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:16:16.911875+00:00", "memory": {"total": 33224306688, "available": 10716536832, "used": 22507769856, "percent": 67.7}, "disk": {"total": 1965300219904, "used": 866088890368, "free": 999304056832, "percent": 44.06903747307911}, "cpu": {"percent": 13.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:16:17.120979+00:00", "processing_duration": 0.003565, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T14:16:17.120499+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10705227776, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:16:17.221313+00:00", "memory": {"total": 33224306688, "available": 10705227776, "used": 22519078912, "percent": 67.8}, "disk": {"total": 1965300219904, "used": 866089226240, "free": 999303720960, "percent": 44.06905456319067}, "cpu": {"percent": 9.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:16:17.226547+00:00", "processing_duration": 0.003615, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T14:16:17.225895+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10992685056, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-160/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:16:17.326799+00:00", "memory": {"total": 33224306688, "available": 11014561792, "used": 22209744896, "percent": 66.8}, "disk": {"total": 1965300219904, "used": 866089259008, "free": 999303688192, "percent": 44.069056230518626}, "cpu": {"percent": 10.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:16:17.331700+00:00", "processing_duration": 0.003416, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T14:16:17.330996+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11218522112, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 650, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 640, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:16:17.431989+00:00", "memory": {"total": 33224306688, "available": 11216875520, "used": 22007431168, "percent": 66.2}, "disk": {"total": 1965300219904, "used": 866089279488, "free": 999303667712, "percent": 44.0690572725986}, "cpu": {"percent": 8.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T14:18:57.761699+00:00", "processing_duration": 0.004077, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T14:18:57.760483+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10810572800, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 211, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 650, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 640, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:18:57.861964+00:00", "memory": {"total": 33224306688, "available": 10810572800, "used": 22413733888, "percent": 67.5}, "disk": {"total": 1965300219904, "used": 866067169280, "free": 999325777920, "percent": 44.0679322430598}, "cpu": {"percent": 10.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T14:18:57.868069+00:00", "processing_duration": 0.003518, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T14:18:57.968498+00:00", "memory": {"total": 33224306688, "available": 10717077504, "used": 22507229184, "percent": 67.7}, "disk": {"total": 1965300219904, "used": 866067038208, "free": 999325908992, "percent": 44.06792557374797}, "cpu": {"percent": 12.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T14:18:57.971330+00:00", "processing_duration": 0.002008, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T14:18:57.970947+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10411663360, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:18:58.071622+00:00", "memory": {"total": 33224306688, "available": 10411663360, "used": 22812643328, "percent": 68.7}, "disk": {"total": 1965300219904, "used": 866067054592, "free": 999325892608, "percent": 44.06792640741195}, "cpu": {"percent": 12.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:18:58.272917+00:00", "processing_duration": 0.003033, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T14:18:58.272474+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10509664256, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:18:58.373205+00:00", "memory": {"total": 33224306688, "available": 10493149184, "used": 22731157504, "percent": 68.4}, "disk": {"total": 1965300219904, "used": 866067390464, "free": 999325556736, "percent": 44.06794349752351}, "cpu": {"percent": 9.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:18:58.379233+00:00", "processing_duration": 0.00441, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T14:18:58.378462+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10107793408, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-165/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:18:58.479616+00:00", "memory": {"total": 33224306688, "available": 10103963648, "used": 23120343040, "percent": 69.6}, "disk": {"total": 1965300219904, "used": 866067419136, "free": 999325528064, "percent": 44.067944956435475}, "cpu": {"percent": 12.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:18:58.485101+00:00", "processing_duration": 0.003697, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T14:18:58.484460+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10639384576, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 650, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 640, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:18:58.585375+00:00", "memory": {"total": 33224306688, "available": 10639384576, "used": 22584922112, "percent": 68.0}, "disk": {"total": 1965300219904, "used": 866067451904, "free": 999325495296, "percent": 44.067946623763426}, "cpu": {"percent": 9.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T14:19:39.797626+00:00", "processing_duration": 0.00479, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T14:19:39.796249+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10629656576, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 211, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 650, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 640, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:19:39.897894+00:00", "memory": {"total": 33224306688, "available": 10621399040, "used": 22602907648, "percent": 68.0}, "disk": {"total": 1965300219904, "used": 866069368832, "free": 999323578368, "percent": 44.06804416244889}, "cpu": {"percent": 12.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T14:19:39.902804+00:00", "processing_duration": 0.00259, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T14:19:40.003031+00:00", "memory": {"total": 33224306688, "available": 11148234752, "used": 22076071936, "percent": 66.4}, "disk": {"total": 1965300219904, "used": 866069385216, "free": 999323561984, "percent": 44.068044996112874}, "cpu": {"percent": 8.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T14:19:40.005535+00:00", "processing_duration": 0.00195, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T14:19:40.005186+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10963947520, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:19:40.105764+00:00", "memory": {"total": 33224306688, "available": 10963947520, "used": 22260359168, "percent": 67.0}, "disk": {"total": 1965300219904, "used": 866069405696, "free": 999323541504, "percent": 44.06804603819285}, "cpu": {"percent": 8.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:19:40.306464+00:00", "processing_duration": 0.002783, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T14:19:40.306131+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10604015616, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:19:40.406725+00:00", "memory": {"total": 33224306688, "available": 10604015616, "used": 22620291072, "percent": 68.1}, "disk": {"total": 1965300219904, "used": 866069741568, "free": 999323205632, "percent": 44.0680631283044}, "cpu": {"percent": 8.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:19:40.411037+00:00", "processing_duration": 0.00316, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T14:19:40.410434+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11147505664, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-166/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:19:40.511306+00:00", "memory": {"total": 33224306688, "available": 11147898880, "used": 22076407808, "percent": 66.4}, "disk": {"total": 1965300219904, "used": 866069774336, "free": 999323172864, "percent": 44.06806479563236}, "cpu": {"percent": 9.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:19:40.517380+00:00", "processing_duration": 0.003596, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T14:19:40.516773+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11124789248, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 650, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 640, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:19:40.617685+00:00", "memory": {"total": 33224306688, "available": 11123118080, "used": 22101188608, "percent": 66.5}, "disk": {"total": 1965300219904, "used": 866069803008, "free": 999323144192, "percent": 44.06806625454433}, "cpu": {"percent": 9.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T14:22:51.137863+00:00", "processing_duration": 0.004146, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T14:22:51.136689+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11806081024, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 211, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 650, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 640, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:22:51.238113+00:00", "memory": {"total": 33224306688, "available": 11806081024, "used": 21418225664, "percent": 64.5}, "disk": {"total": 1965300219904, "used": 866076028928, "free": 999316918272, "percent": 44.068383046856106}, "cpu": {"percent": 9.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T14:22:51.242994+00:00", "processing_duration": 0.002617, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T14:22:51.343231+00:00", "memory": {"total": 33224306688, "available": 11671609344, "used": 21552697344, "percent": 64.9}, "disk": {"total": 1965300219904, "used": 866076045312, "free": 999316901888, "percent": 44.06838388052008}, "cpu": {"percent": 10.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T14:22:51.345652+00:00", "processing_duration": 0.001918, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T14:22:51.345305+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11399864320, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:22:51.445878+00:00", "memory": {"total": 33224306688, "available": 11399864320, "used": 21824442368, "percent": 65.7}, "disk": {"total": 1965300219904, "used": 866076073984, "free": 999316873216, "percent": 44.06838533943204}, "cpu": {"percent": 10.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:22:51.646872+00:00", "processing_duration": 0.003308, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T14:22:51.646437+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11359911936, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:22:51.747142+00:00", "memory": {"total": 33224306688, "available": 11359911936, "used": 21864394752, "percent": 65.8}, "disk": {"total": 1965300219904, "used": 866076409856, "free": 999316537344, "percent": 44.068402429543596}, "cpu": {"percent": 8.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:22:51.751417+00:00", "processing_duration": 0.00307, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T14:22:51.750827+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11631116288, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-167/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:22:51.851679+00:00", "memory": {"total": 33224306688, "available": 11655671808, "used": 21568634880, "percent": 64.9}, "disk": {"total": 1965300219904, "used": 866076442624, "free": 999316504576, "percent": 44.068404096871554}, "cpu": {"percent": 9.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:22:51.856965+00:00", "processing_duration": 0.003965, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T14:22:51.856290+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11693989888, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 650, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 640, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:22:51.957325+00:00", "memory": {"total": 33224306688, "available": 11686010880, "used": 21538295808, "percent": 64.8}, "disk": {"total": 1965300219904, "used": 866076471296, "free": 999316475904, "percent": 44.06840555578352}, "cpu": {"percent": 7.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T14:27:20.447766+00:00", "processing_duration": 0.0049, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T14:27:20.446547+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11125465088, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 211, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 650, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 640, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:27:20.548042+00:00", "memory": {"total": 33224306688, "available": 11125207040, "used": 22099099648, "percent": 66.5}, "disk": {"total": 1965300219904, "used": 866090344448, "free": 999302602752, "percent": 44.06911146075719}, "cpu": {"percent": 12.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T14:27:20.553108+00:00", "processing_duration": 0.002546, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T14:27:20.653359+00:00", "memory": {"total": 33224306688, "available": 10783174656, "used": 22441132032, "percent": 67.5}, "disk": {"total": 1965300219904, "used": 866090364928, "free": 999302582272, "percent": 44.069112502837164}, "cpu": {"percent": 10.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T14:27:20.656216+00:00", "processing_duration": 0.002025, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T14:27:20.655863+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11089965056, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:27:20.756463+00:00", "memory": {"total": 33224306688, "available": 11089965056, "used": 22134341632, "percent": 66.6}, "disk": {"total": 1965300219904, "used": 866090385408, "free": 999302561792, "percent": 44.06911354491714}, "cpu": {"percent": 7.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:27:20.957161+00:00", "processing_duration": 0.002983, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T14:27:20.956824+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11402137600, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:27:21.057424+00:00", "memory": {"total": 33224306688, "available": 11402137600, "used": 21822169088, "percent": 65.7}, "disk": {"total": 1965300219904, "used": 866090721280, "free": 999302225920, "percent": 44.0691306350287}, "cpu": {"percent": 8.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:27:21.062452+00:00", "processing_duration": 0.003441, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T14:27:21.061880+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11287552000, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-172/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:27:21.162670+00:00", "memory": {"total": 33224306688, "available": 11279294464, "used": 21945012224, "percent": 66.1}, "disk": {"total": 1965300219904, "used": 866090754048, "free": 999302193152, "percent": 44.06913230235665}, "cpu": {"percent": 8.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:27:21.168002+00:00", "processing_duration": 0.00407, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T14:27:21.167321+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11130662912, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 650, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 640, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:27:21.268321+00:00", "memory": {"total": 33224306688, "available": 11130662912, "used": 22093643776, "percent": 66.5}, "disk": {"total": 1965300219904, "used": 866090786816, "free": 999302160384, "percent": 44.06913396968461}, "cpu": {"percent": 6.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T14:30:37.372692+00:00", "processing_duration": 0.003909, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T14:30:37.371587+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10883383296, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 211, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 658, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 648, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:30:37.472995+00:00", "memory": {"total": 33224306688, "available": 10883383296, "used": 22340923392, "percent": 67.2}, "disk": {"total": 1965300219904, "used": 866099822592, "free": 999293124608, "percent": 44.06959373536868}, "cpu": {"percent": 11.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T14:30:37.478971+00:00", "processing_duration": 0.003356, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T14:30:37.579374+00:00", "memory": {"total": 33224306688, "available": 10724081664, "used": 22500225024, "percent": 67.7}, "disk": {"total": 1965300219904, "used": 866099838976, "free": 999293108224, "percent": 44.06959456903265}, "cpu": {"percent": 9.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T14:30:37.582460+00:00", "processing_duration": 0.002269, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T14:30:37.582091+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10475970560, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:30:37.682774+00:00", "memory": {"total": 33224306688, "available": 10475970560, "used": 22748336128, "percent": 68.5}, "disk": {"total": 1965300219904, "used": 866099863552, "free": 999293083648, "percent": 44.06959581952862}, "cpu": {"percent": 10.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:30:37.878785+00:00", "processing_duration": 0.003056, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T14:30:37.878351+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10791804928, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:30:37.979052+00:00", "memory": {"total": 33224306688, "available": 10791804928, "used": 22432501760, "percent": 67.5}, "disk": {"total": 1965300219904, "used": 866100199424, "free": 999292747776, "percent": 44.06961290964018}, "cpu": {"percent": 7.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:30:37.983871+00:00", "processing_duration": 0.003329, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T14:30:37.983251+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10617749504, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-174/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:30:38.084131+00:00", "memory": {"total": 33224306688, "available": 10617749504, "used": 22606557184, "percent": 68.0}, "disk": {"total": 1965300219904, "used": 866100232192, "free": 999292715008, "percent": 44.069614576968135}, "cpu": {"percent": 7.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:30:38.088724+00:00", "processing_duration": 0.003301, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T14:30:38.088156+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10571743232, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 658, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 648, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:30:38.188991+00:00", "memory": {"total": 33224306688, "available": 10569678848, "used": 22654627840, "percent": 68.2}, "disk": {"total": 1965300219904, "used": 866100260864, "free": 999292686336, "percent": 44.0696160358801}, "cpu": {"percent": 7.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T14:32:18.300660+00:00", "processing_duration": 0.00425, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "numerical_error", "error_message": "NaN values found in observable (1 total, indices: [1])", "timestamp": "2025-10-23T14:32:18.299499+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10992889856, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 211, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 658, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 648, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:32:18.400912+00:00", "memory": {"total": 33224306688, "available": 10992889856, "used": 22231416832, "percent": 66.9}, "disk": {"total": 1965300219904, "used": 866101428224, "free": 999291518976, "percent": 44.06967543443855}, "cpu": {"percent": 8.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T14:32:18.405738+00:00", "processing_duration": 0.002574, "error_type": "unsupported_dataset_type", "error_message": "No derivation module available for dataset type: unknown", "stage": "module_selection", "context": {"detected_type": "unknown", "available_types": [], "registered_modules": 0}, "system_health": {"timestamp": "2025-10-23T14:32:18.505960+00:00", "memory": {"total": 33224306688, "available": 10767695872, "used": 22456610816, "percent": 67.6}, "disk": {"total": 1965300219904, "used": 866101448704, "free": 999291498496, "percent": 44.069676476518524}, "cpu": {"percent": 7.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_strict_data", "failure_time": "2025-10-23T14:32:18.508493+00:00", "processing_duration": 0.002054, "error_context": {"dataset_name": "test_strict_data", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T14:32:18.508051+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10643853312, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:32:18.608808+00:00", "memory": {"total": 33224306688, "available": 10643853312, "used": 22580453376, "percent": 68.0}, "disk": {"total": 1965300219904, "used": 866101465088, "free": 999291482112, "percent": 44.069677310182506}, "cpu": {"percent": 13.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:32:18.818424+00:00", "processing_duration": 0.003372, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T14:32:18.818013+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10987245568, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:32:18.918755+00:00", "memory": {"total": 33224306688, "available": 10987245568, "used": 22237061120, "percent": 66.9}, "disk": {"total": 1965300219904, "used": 866101805056, "free": 999291142144, "percent": 44.06969460871006}, "cpu": {"percent": 7.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:32:18.924136+00:00", "processing_duration": 0.003716, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T14:32:18.923442+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11442610176, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-177/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1628, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:32:19.024417+00:00", "memory": {"total": 33224306688, "available": 11442610176, "used": 21781696512, "percent": 65.6}, "disk": {"total": 1965300219904, "used": 866101833728, "free": 999291113472, "percent": 44.06969606762202}, "cpu": {"percent": 7.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T14:32:19.029670+00:00", "processing_duration": 0.003688, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "schema_error", "error_message": "Required metadata field 'source' is missing", "timestamp": "2025-10-23T14:32:19.029079+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11272290304, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 168, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 658, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 648, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T14:32:19.129982+00:00", "memory": {"total": 33224306688, "available": 11272290304, "used": 21952016384, "percent": 66.1}, "disk": {"total": 1965300219904, "used": 866101870592, "free": 999291076608, "percent": 44.06969794336597}, "cpu": {"percent": 7.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
