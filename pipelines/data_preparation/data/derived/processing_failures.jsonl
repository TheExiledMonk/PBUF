{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T09:03:19.370179+00:00", "processing_duration": 0.003966, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n", "timestamp": "2025-10-23T09:03:19.369248+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 14299873280, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 144, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:03:19.470486+00:00", "memory": {"total": 33224306688, "available": 14299873280, "used": 18924433408, "percent": 57.0}, "disk": {"total": 1965300219904, "used": 865646505984, "free": 999746441216, "percent": 44.046527711999374}, "cpu": {"percent": 3.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T09:03:19.483009+00:00", "processing_duration": 0.0032, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T09:03:19.482552+00:00", "processing_duration": 0.002739, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 14294753280, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 304, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:03:19.583240+00:00", "memory": {"total": 33224306688, "available": 14294753280, "used": 18929553408, "percent": 57.0}, "disk": {"total": 1965300219904, "used": 865646542848, "free": 999746404352, "percent": 44.04652958774333}, "cpu": {"percent": 4.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:03:19.960980+00:00", "processing_duration": 0.003407, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T09:03:19.960509+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 14259322880, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:03:20.061314+00:00", "memory": {"total": 33224306688, "available": 14259322880, "used": 18964983808, "percent": 57.1}, "disk": {"total": 1965300219904, "used": 865646878720, "free": 999746068480, "percent": 44.04654667785488}, "cpu": {"percent": 4.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:03:20.066732+00:00", "processing_duration": 0.003506, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T09:03:20.066160+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 14258819072, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-31/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1610, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:03:20.167008+00:00", "memory": {"total": 33224306688, "available": 14258819072, "used": 18965487616, "percent": 57.1}, "disk": {"total": 1965300219904, "used": 865646903296, "free": 999746043904, "percent": 44.04654792835085}, "cpu": {"percent": 3.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:03:20.172337+00:00", "processing_duration": 0.003774, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n", "timestamp": "2025-10-23T09:03:20.171801+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 14258872320, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 113, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:03:20.272580+00:00", "memory": {"total": 33224306688, "available": 14258872320, "used": 18965434368, "percent": 57.1}, "disk": {"total": 1965300219904, "used": 865646940160, "free": 999746007040, "percent": 44.0465498040948}, "cpu": {"percent": 3.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T09:03:28.626488+00:00", "processing_duration": 0.003606, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: []", "timestamp": "2025-10-23T09:03:28.625979+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 14300033024, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-31/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 140, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 112, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: []\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:03:28.726749+00:00", "memory": {"total": 33224306688, "available": 14300033024, "used": 18924273664, "percent": 57.0}, "disk": {"total": 1965300219904, "used": 865647185920, "free": 999745761280, "percent": 44.04656230905448}, "cpu": {"percent": 3.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T09:03:28.754959+00:00", "processing_duration": 0.003308, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T09:03:28.754395+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 14300069888, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-31/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:03:28.855242+00:00", "memory": {"total": 33224306688, "available": 14300069888, "used": 18924236800, "percent": 57.0}, "disk": {"total": 1965300219904, "used": 865647210496, "free": 999745736704, "percent": 44.04656355955044}, "cpu": {"percent": 3.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T09:03:28.889665+00:00", "processing_duration": 0.003944, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Required CMB parameter 'R' not found. Available keys: []", "timestamp": "2025-10-23T09:03:28.889231+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 14300082176, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-31/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Required CMB parameter 'R' not found. Available keys: []\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:03:28.989929+00:00", "memory": {"total": 33224306688, "available": 14300082176, "used": 18924224512, "percent": 57.0}, "disk": {"total": 1965300219904, "used": 865647235072, "free": 999745712128, "percent": 44.04656481004641}, "cpu": {"percent": 6.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T09:03:29.021088+00:00", "processing_duration": 0.004207, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: []", "timestamp": "2025-10-23T09:03:29.020623+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 14294118400, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-31/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 140, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 112, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: []\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:03:29.121336+00:00", "memory": {"total": 33224306688, "available": 14293671936, "used": 18930634752, "percent": 57.0}, "disk": {"total": 1965300219904, "used": 865647267840, "free": 999745679360, "percent": 44.04656647737436}, "cpu": {"percent": 8.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T09:05:01.960786+00:00", "processing_duration": 0.004258, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n", "timestamp": "2025-10-23T09:05:01.959593+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13061922816, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 144, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:05:02.061137+00:00", "memory": {"total": 33224306688, "available": 13061922816, "used": 20162383872, "percent": 60.7}, "disk": {"total": 1965300219904, "used": 865648300032, "free": 999744647168, "percent": 44.046618998205005}, "cpu": {"percent": 12.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T09:05:02.074790+00:00", "processing_duration": 0.002849, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T09:05:02.074412+00:00", "processing_duration": 0.002468, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12871516160, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 304, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:05:02.175055+00:00", "memory": {"total": 33224306688, "available": 12871516160, "used": 20352790528, "percent": 61.3}, "disk": {"total": 1965300219904, "used": 865648328704, "free": 999744618496, "percent": 44.04662045711697}, "cpu": {"percent": 11.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:05:02.571209+00:00", "processing_duration": 0.002842, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T09:05:02.570884+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12948328448, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:05:02.671485+00:00", "memory": {"total": 33224306688, "available": 12956811264, "used": 20267495424, "percent": 61.0}, "disk": {"total": 1965300219904, "used": 865648660480, "free": 999744286720, "percent": 44.04663733881253}, "cpu": {"percent": 9.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:05:02.676858+00:00", "processing_duration": 0.003926, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T09:05:02.676154+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13136494592, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-32/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1610, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:05:02.777191+00:00", "memory": {"total": 33224306688, "available": 13136494592, "used": 20087812096, "percent": 60.5}, "disk": {"total": 1965300219904, "used": 865648689152, "free": 999744258048, "percent": 44.04663879772449}, "cpu": {"percent": 7.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:05:02.782705+00:00", "processing_duration": 0.003874, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n", "timestamp": "2025-10-23T09:05:02.782120+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13258035200, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 113, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:05:02.882981+00:00", "memory": {"total": 33224306688, "available": 13266518016, "used": 19957788672, "percent": 60.1}, "disk": {"total": 1965300219904, "used": 865648721920, "free": 999744225280, "percent": 44.04664046505245}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T09:05:10.561076+00:00", "processing_duration": 0.00345, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: []", "timestamp": "2025-10-23T09:05:10.560577+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13863579648, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-32/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 140, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 112, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: []\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:05:10.661341+00:00", "memory": {"total": 33224306688, "available": 13863063552, "used": 19361243136, "percent": 58.3}, "disk": {"total": 1965300219904, "used": 865648906240, "free": 999744040960, "percent": 44.04664984377221}, "cpu": {"percent": 4.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T09:05:10.690952+00:00", "processing_duration": 0.003756, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T09:05:10.690494+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13870911488, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-32/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:05:10.791231+00:00", "memory": {"total": 33224306688, "available": 13870911488, "used": 19353395200, "percent": 58.3}, "disk": {"total": 1965300219904, "used": 865648930816, "free": 999744016384, "percent": 44.04665109426817}, "cpu": {"percent": 4.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T09:05:10.823536+00:00", "processing_duration": 0.003049, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Required CMB parameter 'R' not found. Available keys: []", "timestamp": "2025-10-23T09:05:10.823106+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13869412352, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-32/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Required CMB parameter 'R' not found. Available keys: []\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:05:10.923822+00:00", "memory": {"total": 33224306688, "available": 13869412352, "used": 19354894336, "percent": 58.3}, "disk": {"total": 1965300219904, "used": 865648959488, "free": 999743987712, "percent": 44.04665255318013}, "cpu": {"percent": 4.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T09:05:10.953435+00:00", "processing_duration": 0.003395, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: []", "timestamp": "2025-10-23T09:05:10.952998+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13870014464, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-32/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 140, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 112, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: []\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:05:11.053724+00:00", "memory": {"total": 33224306688, "available": 13870014464, "used": 19354292224, "percent": 58.3}, "disk": {"total": 1965300219904, "used": 865648988160, "free": 999743959040, "percent": 44.0466540120921}, "cpu": {"percent": 4.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T09:18:35.981387+00:00", "processing_duration": 0.003937, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n", "timestamp": "2025-10-23T09:18:35.980429+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11909636096, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 144, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:18:36.081695+00:00", "memory": {"total": 33224306688, "available": 11909636096, "used": 21314670592, "percent": 64.2}, "disk": {"total": 1965300219904, "used": 865758797824, "free": 999634149376, "percent": 44.052241436491066}, "cpu": {"percent": 10.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T09:18:36.087325+00:00", "processing_duration": 0.002722, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T09:18:36.086867+00:00", "processing_duration": 0.002262, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11638927360, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 304, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:18:36.187591+00:00", "memory": {"total": 33224306688, "available": 11638927360, "used": 21585379328, "percent": 65.0}, "disk": {"total": 1965300219904, "used": 865758822400, "free": 999634124800, "percent": 44.052242686987036}, "cpu": {"percent": 12.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:18:36.392055+00:00", "processing_duration": 0.003153, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T09:18:36.391748+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11942916096, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:18:36.492286+00:00", "memory": {"total": 33224306688, "available": 11942916096, "used": 21281390592, "percent": 64.1}, "disk": {"total": 1965300219904, "used": 865759227904, "free": 999633719296, "percent": 44.0522633201705}, "cpu": {"percent": 13.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:18:36.497199+00:00", "processing_duration": 0.003434, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T09:18:36.496515+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12129660928, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-33/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1610, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:18:36.597473+00:00", "memory": {"total": 33224306688, "available": 12129660928, "used": 21094645760, "percent": 63.5}, "disk": {"total": 1965300219904, "used": 865759272960, "free": 999633674240, "percent": 44.052265612746446}, "cpu": {"percent": 11.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:18:36.603139+00:00", "processing_duration": 0.003687, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n", "timestamp": "2025-10-23T09:18:36.602416+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12042428416, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 113, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:18:36.703510+00:00", "memory": {"total": 33224306688, "available": 12039331840, "used": 21184974848, "percent": 63.8}, "disk": {"total": 1965300219904, "used": 865760374784, "free": 999632572416, "percent": 44.05232167664899}, "cpu": {"percent": 15.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T09:18:44.034528+00:00", "processing_duration": 0.003772, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T09:18:44.034074+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13041434624, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-33/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 140, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 112, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:18:44.134815+00:00", "memory": {"total": 33224306688, "available": 13041434624, "used": 20182872064, "percent": 60.7}, "disk": {"total": 1965300219904, "used": 865761472512, "free": 999631474688, "percent": 44.05237753213554}, "cpu": {"percent": 5.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T09:18:44.140789+00:00", "processing_duration": 0.003878, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T09:18:44.140330+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13043548160, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-33/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:18:44.241023+00:00", "memory": {"total": 33224306688, "available": 13043548160, "used": 20180758528, "percent": 60.7}, "disk": {"total": 1965300219904, "used": 865761529856, "free": 999631417344, "percent": 44.05238044995946}, "cpu": {"percent": 5.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T09:18:44.246356+00:00", "processing_duration": 0.003506, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T09:18:44.245918+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13055066112, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-33/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:18:44.346596+00:00", "memory": {"total": 33224306688, "available": 13055066112, "used": 20169240576, "percent": 60.7}, "disk": {"total": 1965300219904, "used": 865761558528, "free": 999631388672, "percent": 44.052381908871425}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T09:18:44.352002+00:00", "processing_duration": 0.003546, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T09:18:44.351545+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13054402560, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-33/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 140, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 112, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:18:44.452273+00:00", "memory": {"total": 33224306688, "available": 13054402560, "used": 20169904128, "percent": 60.7}, "disk": {"total": 1965300219904, "used": 865761587200, "free": 999631360000, "percent": 44.052383367783385}, "cpu": {"percent": 5.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T09:21:47.703386+00:00", "processing_duration": 0.003852, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n", "timestamp": "2025-10-23T09:21:47.702462+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12291080192, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 153, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:21:47.803710+00:00", "memory": {"total": 33224306688, "available": 12281049088, "used": 20943257600, "percent": 63.0}, "disk": {"total": 1965300219904, "used": 865767444480, "free": 999625502720, "percent": 44.05268140265565}, "cpu": {"percent": 10.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T09:21:47.809533+00:00", "processing_duration": 0.002759, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T09:21:47.809030+00:00", "processing_duration": 0.002254, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12084588544, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 304, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:21:47.909828+00:00", "memory": {"total": 33224306688, "available": 12084588544, "used": 21139718144, "percent": 63.6}, "disk": {"total": 1965300219904, "used": 865767469056, "free": 999625478144, "percent": 44.05268265315162}, "cpu": {"percent": 12.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:21:48.114508+00:00", "processing_duration": 0.003033, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T09:21:48.114064+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12418412544, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:21:48.214778+00:00", "memory": {"total": 33224306688, "available": 12417638400, "used": 20806668288, "percent": 62.6}, "disk": {"total": 1965300219904, "used": 865767804928, "free": 999625142272, "percent": 44.052699743263176}, "cpu": {"percent": 8.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:21:48.219628+00:00", "processing_duration": 0.003461, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T09:21:48.218970+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12328030208, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-34/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1610, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:21:48.319954+00:00", "memory": {"total": 33224306688, "available": 12328030208, "used": 20896276480, "percent": 62.9}, "disk": {"total": 1965300219904, "used": 865767833600, "free": 999625113600, "percent": 44.052701202175136}, "cpu": {"percent": 8.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:21:48.324828+00:00", "processing_duration": 0.003478, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n", "timestamp": "2025-10-23T09:21:48.324280+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12178874368, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 122, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:21:48.425068+00:00", "memory": {"total": 33224306688, "available": 12178874368, "used": 21045432320, "percent": 63.3}, "disk": {"total": 1965300219904, "used": 865767862272, "free": 999625084928, "percent": 44.0527026610871}, "cpu": {"percent": 8.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T09:21:56.035946+00:00", "processing_duration": 0.003757, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T09:21:56.035394+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13267525632, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-34/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 140, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 112, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:21:56.136236+00:00", "memory": {"total": 33224306688, "available": 13267525632, "used": 19956781056, "percent": 60.1}, "disk": {"total": 1965300219904, "used": 865768083456, "free": 999624863744, "percent": 44.052713915550804}, "cpu": {"percent": 5.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T09:21:56.142652+00:00", "processing_duration": 0.004215, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T09:21:56.142062+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13299494912, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-34/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:21:56.242946+00:00", "memory": {"total": 33224306688, "available": 13299494912, "used": 19924811776, "percent": 60.0}, "disk": {"total": 1965300219904, "used": 865768112128, "free": 999624835072, "percent": 44.05271537446277}, "cpu": {"percent": 5.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T09:21:56.248427+00:00", "processing_duration": 0.003539, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T09:21:56.247960+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13335150592, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-34/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:21:56.348695+00:00", "memory": {"total": 33224306688, "available": 13335150592, "used": 19889156096, "percent": 59.9}, "disk": {"total": 1965300219904, "used": 865768144896, "free": 999624802304, "percent": 44.05271704179072}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T09:21:56.354673+00:00", "processing_duration": 0.003744, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T09:21:56.354222+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13335171072, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-34/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 140, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 112, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:21:56.454948+00:00", "memory": {"total": 33224306688, "available": 13335171072, "used": 19889135616, "percent": 59.9}, "disk": {"total": 1965300219904, "used": 865768173568, "free": 999624773632, "percent": 44.05271850070269}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T09:23:53.249608+00:00", "processing_duration": 0.004211, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n", "timestamp": "2025-10-23T09:23:53.248577+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12296986624, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 160, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:23:53.349878+00:00", "memory": {"total": 33224306688, "available": 12297003008, "used": 20927303680, "percent": 63.0}, "disk": {"total": 1965300219904, "used": 865769627648, "free": 999623319552, "percent": 44.05279248838077}, "cpu": {"percent": 10.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T09:23:53.356158+00:00", "processing_duration": 0.003558, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T09:23:53.355527+00:00", "processing_duration": 0.002923, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12082958336, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 304, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:23:53.456512+00:00", "memory": {"total": 33224306688, "available": 12074700800, "used": 21149605888, "percent": 63.7}, "disk": {"total": 1965300219904, "used": 865769656320, "free": 999623290880, "percent": 44.05279394729273}, "cpu": {"percent": 12.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:23:53.665476+00:00", "processing_duration": 0.002985, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T09:23:53.665135+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12584968192, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:23:53.765760+00:00", "memory": {"total": 33224306688, "available": 12584968192, "used": 20639338496, "percent": 62.1}, "disk": {"total": 1965300219904, "used": 865769984000, "free": 999622963200, "percent": 44.052810620572295}, "cpu": {"percent": 8.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:23:53.770137+00:00", "processing_duration": 0.003041, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T09:23:53.769567+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12527980544, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-35/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1610, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:23:53.870375+00:00", "memory": {"total": 33224306688, "available": 12527988736, "used": 20696317952, "percent": 62.3}, "disk": {"total": 1965300219904, "used": 865770016768, "free": 999622930432, "percent": 44.05281228790025}, "cpu": {"percent": 9.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:23:53.875167+00:00", "processing_duration": 0.003557, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n", "timestamp": "2025-10-23T09:23:53.874620+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12405616640, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 129, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:23:53.975441+00:00", "memory": {"total": 33224306688, "available": 12405616640, "used": 20818690048, "percent": 62.7}, "disk": {"total": 1965300219904, "used": 865770049536, "free": 999622897664, "percent": 44.05281395522821}, "cpu": {"percent": 8.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T09:24:01.086795+00:00", "processing_duration": 0.003858, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T09:24:01.086298+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13368115200, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-35/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 140, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 112, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:24:01.187057+00:00", "memory": {"total": 33224306688, "available": 13368115200, "used": 19856191488, "percent": 59.8}, "disk": {"total": 1965300219904, "used": 865770237952, "free": 999622709248, "percent": 44.05282354236396}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T09:24:01.193357+00:00", "processing_duration": 0.003712, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T09:24:01.192879+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13366894592, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-35/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:24:01.293628+00:00", "memory": {"total": 33224306688, "available": 13366894592, "used": 19857412096, "percent": 59.8}, "disk": {"total": 1965300219904, "used": 865770266624, "free": 999622680576, "percent": 44.05282500127593}, "cpu": {"percent": 5.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T09:24:01.299769+00:00", "processing_duration": 0.003978, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T09:24:01.299327+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13373669376, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-35/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:24:01.400027+00:00", "memory": {"total": 33224306688, "available": 13373669376, "used": 19850637312, "percent": 59.7}, "disk": {"total": 1965300219904, "used": 865770291200, "free": 999622656000, "percent": 44.05282625177189}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T09:24:01.405799+00:00", "processing_duration": 0.003521, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T09:24:01.405237+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13375270912, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-35/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 140, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 112, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:24:01.506169+00:00", "memory": {"total": 33224306688, "available": 13375270912, "used": 19849035776, "percent": 59.7}, "disk": {"total": 1965300219904, "used": 865770323968, "free": 999622623232, "percent": 44.05282791909985}, "cpu": {"percent": 5.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T09:31:54.738094+00:00", "processing_duration": 0.003917, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n", "timestamp": "2025-10-23T09:31:54.737062+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11985010688, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 198, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:31:54.838498+00:00", "memory": {"total": 33224306688, "available": 11985010688, "used": 21239296000, "percent": 63.9}, "disk": {"total": 1965300219904, "used": 865778270208, "free": 999614676992, "percent": 44.053232246129355}, "cpu": {"percent": 11.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T09:31:54.844969+00:00", "processing_duration": 0.003355, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T09:31:54.844287+00:00", "processing_duration": 0.002669, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11785605120, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 304, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:31:54.945277+00:00", "memory": {"total": 33224306688, "available": 11785605120, "used": 21438701568, "percent": 64.5}, "disk": {"total": 1965300219904, "used": 865778311168, "free": 999614636032, "percent": 44.0532343302893}, "cpu": {"percent": 12.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:31:55.141777+00:00", "processing_duration": 0.002809, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T09:31:55.141479+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12097110016, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:31:55.242055+00:00", "memory": {"total": 33224306688, "available": 12097110016, "used": 21127196672, "percent": 63.6}, "disk": {"total": 1965300219904, "used": 865778647040, "free": 999614300160, "percent": 44.053251420400855}, "cpu": {"percent": 8.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:31:55.247073+00:00", "processing_duration": 0.003298, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T09:31:55.246478+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11973079040, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-36/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1610, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:31:55.347359+00:00", "memory": {"total": 33224306688, "available": 11973079040, "used": 21251227648, "percent": 64.0}, "disk": {"total": 1965300219904, "used": 865778675712, "free": 999614271488, "percent": 44.053252879312815}, "cpu": {"percent": 9.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:31:55.352127+00:00", "processing_duration": 0.00334, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n", "timestamp": "2025-10-23T09:31:55.351535+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11839619072, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 167, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:31:55.452432+00:00", "memory": {"total": 33224306688, "available": 11839619072, "used": 21384687616, "percent": 64.4}, "disk": {"total": 1965300219904, "used": 865778708480, "free": 999614238720, "percent": 44.05325454664077}, "cpu": {"percent": 8.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T09:32:02.824586+00:00", "processing_duration": 0.003191, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T09:32:02.824127+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12831391744, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-36/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 140, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 112, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:32:02.924827+00:00", "memory": {"total": 33224306688, "available": 12831391744, "used": 20392914944, "percent": 61.4}, "disk": {"total": 1965300219904, "used": 865778786304, "free": 999614160896, "percent": 44.053258506544665}, "cpu": {"percent": 6.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T09:32:02.930437+00:00", "processing_duration": 0.003687, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T09:32:02.929988+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12835270656, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-36/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:32:03.030679+00:00", "memory": {"total": 33224306688, "available": 12835270656, "used": 20389036032, "percent": 61.4}, "disk": {"total": 1965300219904, "used": 865778810880, "free": 999614136320, "percent": 44.053259757040635}, "cpu": {"percent": 6.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T09:32:03.036266+00:00", "processing_duration": 0.003771, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T09:32:03.035787+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12835209216, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-36/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:32:03.136536+00:00", "memory": {"total": 33224306688, "available": 12835209216, "used": 20389097472, "percent": 61.4}, "disk": {"total": 1965300219904, "used": 865778835456, "free": 999614111744, "percent": 44.053261007536605}, "cpu": {"percent": 6.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T09:32:03.142101+00:00", "processing_duration": 0.003489, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T09:32:03.141631+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12836900864, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-36/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 140, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 112, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:32:03.242338+00:00", "memory": {"total": 33224306688, "available": 12836900864, "used": 20387405824, "percent": 61.4}, "disk": {"total": 1965300219904, "used": 865778872320, "free": 999614074880, "percent": 44.05326288328056}, "cpu": {"percent": 6.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T09:37:40.802456+00:00", "processing_duration": 0.003994, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n", "timestamp": "2025-10-23T09:37:40.801525+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11730939904, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 198, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:37:40.902740+00:00", "memory": {"total": 33224306688, "available": 11730939904, "used": 21493366784, "percent": 64.7}, "disk": {"total": 1965300219904, "used": 865760788480, "free": 999632158720, "percent": 44.05234272666444}, "cpu": {"percent": 11.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T09:37:40.908480+00:00", "processing_duration": 0.003138, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T09:37:40.908020+00:00", "processing_duration": 0.002676, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11502837760, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 304, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:37:41.008844+00:00", "memory": {"total": 33224306688, "available": 11494580224, "used": 21729726464, "percent": 65.4}, "disk": {"total": 1965300219904, "used": 865760817152, "free": 999632130048, "percent": 44.0523441855764}, "cpu": {"percent": 13.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:37:41.214128+00:00", "processing_duration": 0.003194, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T09:37:41.213565+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11789000704, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:37:41.314460+00:00", "memory": {"total": 33224306688, "available": 11789000704, "used": 21435305984, "percent": 64.5}, "disk": {"total": 1965300219904, "used": 865761153024, "free": 999631794176, "percent": 44.05236127568796}, "cpu": {"percent": 8.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:37:41.319437+00:00", "processing_duration": 0.003636, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T09:37:41.318889+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11778564096, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-37/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1610, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:37:41.419699+00:00", "memory": {"total": 33224306688, "available": 11778564096, "used": 21445742592, "percent": 64.5}, "disk": {"total": 1965300219904, "used": 865761177600, "free": 999631769600, "percent": 44.05236252618393}, "cpu": {"percent": 8.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:37:41.424351+00:00", "processing_duration": 0.003371, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n", "timestamp": "2025-10-23T09:37:41.423814+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11647639552, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 167, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:37:41.524610+00:00", "memory": {"total": 33224306688, "available": 11647639552, "used": 21576667136, "percent": 64.9}, "disk": {"total": 1965300219904, "used": 865761210368, "free": 999631736832, "percent": 44.052364193511885}, "cpu": {"percent": 8.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T09:37:48.692388+00:00", "processing_duration": 0.004279, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T09:37:48.691893+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12917497856, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-37/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 140, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 112, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:37:48.792685+00:00", "memory": {"total": 33224306688, "available": 12917497856, "used": 20306808832, "percent": 61.1}, "disk": {"total": 1965300219904, "used": 865761394688, "free": 999631552512, "percent": 44.05237357223164}, "cpu": {"percent": 4.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T09:37:48.799025+00:00", "processing_duration": 0.004141, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T09:37:48.798480+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12915826688, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-37/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:37:48.899296+00:00", "memory": {"total": 33224306688, "available": 12915826688, "used": 20308480000, "percent": 61.1}, "disk": {"total": 1965300219904, "used": 865761415168, "free": 999631532032, "percent": 44.05237461431161}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T09:37:48.906436+00:00", "processing_duration": 0.004458, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T09:37:48.905953+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12916269056, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-37/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:37:49.006775+00:00", "memory": {"total": 33224306688, "available": 12916269056, "used": 20308037632, "percent": 61.1}, "disk": {"total": 1965300219904, "used": 865761443840, "free": 999631503360, "percent": 44.05237607322358}, "cpu": {"percent": 5.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T09:37:49.013346+00:00", "processing_duration": 0.004122, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T09:37:49.012589+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12914282496, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-37/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 140, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 112, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:37:49.113658+00:00", "memory": {"total": 33224306688, "available": 12914282496, "used": 20310024192, "percent": 61.1}, "disk": {"total": 1965300219904, "used": 865761472512, "free": 999631474688, "percent": 44.05237753213554}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T09:38:23.791452+00:00", "processing_duration": 0.003505, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n", "timestamp": "2025-10-23T09:38:23.790561+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11401895936, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 198, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:38:23.891721+00:00", "memory": {"total": 33224306688, "available": 11401895936, "used": 21822410752, "percent": 65.7}, "disk": {"total": 1965300219904, "used": 865761820672, "free": 999631126528, "percent": 44.05239524749508}, "cpu": {"percent": 10.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T09:38:23.904014+00:00", "processing_duration": 0.002542, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T09:38:23.903677+00:00", "processing_duration": 0.002203, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11587239936, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 304, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:38:24.004248+00:00", "memory": {"total": 33224306688, "available": 11587239936, "used": 21637066752, "percent": 65.1}, "disk": {"total": 1965300219904, "used": 865761849344, "free": 999631097856, "percent": 44.05239670640704}, "cpu": {"percent": 9.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:38:24.364977+00:00", "processing_duration": 0.002899, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T09:38:24.364550+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11721551872, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:38:24.465231+00:00", "memory": {"total": 33224306688, "available": 11721551872, "used": 21502754816, "percent": 64.7}, "disk": {"total": 1965300219904, "used": 865762181120, "free": 999630766080, "percent": 44.0524135881026}, "cpu": {"percent": 14.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:38:24.470443+00:00", "processing_duration": 0.003554, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T09:38:24.469622+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11484487680, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-38/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1610, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:38:24.570930+00:00", "memory": {"total": 33224306688, "available": 11484487680, "used": 21739819008, "percent": 65.4}, "disk": {"total": 1965300219904, "used": 865762197504, "free": 999630749696, "percent": 44.05241442176658}, "cpu": {"percent": 10.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:38:24.577828+00:00", "processing_duration": 0.003873, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n", "timestamp": "2025-10-23T09:38:24.577218+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11624177664, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 167, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:38:24.678112+00:00", "memory": {"total": 33224306688, "available": 11640623104, "used": 21583683584, "percent": 65.0}, "disk": {"total": 1965300219904, "used": 865762234368, "free": 999630712832, "percent": 44.05241629751053}, "cpu": {"percent": 10.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T09:38:33.499970+00:00", "processing_duration": 0.004273, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T09:38:33.499463+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11482390528, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-38/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 140, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 112, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:38:33.600326+00:00", "memory": {"total": 33224306688, "available": 11482390528, "used": 21741916160, "percent": 65.4}, "disk": {"total": 1965300219904, "used": 865762480128, "free": 999630467072, "percent": 44.0524288024702}, "cpu": {"percent": 11.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T09:38:33.634819+00:00", "processing_duration": 0.004544, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T09:38:33.634310+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11183849472, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-38/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:38:33.735173+00:00", "memory": {"total": 33224306688, "available": 11183849472, "used": 22040457216, "percent": 66.3}, "disk": {"total": 1965300219904, "used": 865762500608, "free": 999630446592, "percent": 44.052429844550176}, "cpu": {"percent": 10.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T09:38:33.775025+00:00", "processing_duration": 0.004118, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T09:38:33.774432+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11474124800, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-38/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:38:33.875390+00:00", "memory": {"total": 33224306688, "available": 11471028224, "used": 21753278464, "percent": 65.5}, "disk": {"total": 1965300219904, "used": 865762533376, "free": 999630413824, "percent": 44.05243151187814}, "cpu": {"percent": 34.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T09:38:33.912788+00:00", "processing_duration": 0.004491, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T09:38:33.912252+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11499343872, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-38/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 140, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 112, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:38:34.013075+00:00", "memory": {"total": 33224306688, "available": 11499343872, "used": 21724962816, "percent": 65.4}, "disk": {"total": 1965300219904, "used": 865762557952, "free": 999630389248, "percent": 44.0524327623741}, "cpu": {"percent": 11.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T09:39:45.935610+00:00", "processing_duration": 0.003916, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n", "timestamp": "2025-10-23T09:39:45.934643+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12153196544, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 198, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:39:46.035917+00:00", "memory": {"total": 33224306688, "available": 12144939008, "used": 21079367680, "percent": 63.4}, "disk": {"total": 1965300219904, "used": 865765400576, "free": 999627546624, "percent": 44.05257740307435}, "cpu": {"percent": 11.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T09:39:46.041629+00:00", "processing_duration": 0.002866, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T09:39:46.041152+00:00", "processing_duration": 0.002386, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11845197824, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 304, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:39:46.141919+00:00", "memory": {"total": 33224306688, "available": 11845197824, "used": 21379108864, "percent": 64.3}, "disk": {"total": 1965300219904, "used": 865765429248, "free": 999627517952, "percent": 44.05257886198631}, "cpu": {"percent": 9.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:39:46.341054+00:00", "processing_duration": 0.003039, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T09:39:46.340766+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11871780864, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:39:46.441287+00:00", "memory": {"total": 33224306688, "available": 11871780864, "used": 21352525824, "percent": 64.3}, "disk": {"total": 1965300219904, "used": 865765761024, "free": 999627186176, "percent": 44.05259574368187}, "cpu": {"percent": 8.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:39:46.445678+00:00", "processing_duration": 0.003126, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T09:39:46.445141+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12358295552, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-39/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1610, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:39:46.545917+00:00", "memory": {"total": 33224306688, "available": 12358295552, "used": 20866011136, "percent": 62.8}, "disk": {"total": 1965300219904, "used": 865765789696, "free": 999627157504, "percent": 44.05259720259384}, "cpu": {"percent": 7.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:39:46.550510+00:00", "processing_duration": 0.0033, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n", "timestamp": "2025-10-23T09:39:46.549972+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12234194944, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 167, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:39:46.650808+00:00", "memory": {"total": 33224306688, "available": 12234194944, "used": 20990111744, "percent": 63.2}, "disk": {"total": 1965300219904, "used": 865765826560, "free": 999627120640, "percent": 44.052599078337785}, "cpu": {"percent": 8.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T09:39:54.296798+00:00", "processing_duration": 0.003544, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T09:39:54.296333+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13150703616, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-39/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 140, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 112, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:39:54.397054+00:00", "memory": {"total": 33224306688, "available": 13150703616, "used": 20073603072, "percent": 60.4}, "disk": {"total": 1965300219904, "used": 865766035456, "free": 999626911744, "percent": 44.05260970755351}, "cpu": {"percent": 4.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T09:39:54.403389+00:00", "processing_duration": 0.004282, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T09:39:54.402839+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13166579712, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-39/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:39:54.503697+00:00", "memory": {"total": 33224306688, "available": 13166579712, "used": 20057726976, "percent": 60.4}, "disk": {"total": 1965300219904, "used": 865766060032, "free": 999626887168, "percent": 44.05261095804948}, "cpu": {"percent": 4.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T09:39:54.510058+00:00", "processing_duration": 0.00423, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T09:39:54.509554+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13183942656, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-39/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:39:54.610346+00:00", "memory": {"total": 33224306688, "available": 13183942656, "used": 20040364032, "percent": 60.3}, "disk": {"total": 1965300219904, "used": 865766088704, "free": 999626858496, "percent": 44.05261241696144}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T09:39:54.616441+00:00", "processing_duration": 0.003683, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T09:39:54.615939+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13193318400, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-39/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 140, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 112, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:39:54.716728+00:00", "memory": {"total": 33224306688, "available": 13193318400, "used": 20030988288, "percent": 60.3}, "disk": {"total": 1965300219904, "used": 865766121472, "free": 999626825728, "percent": 44.0526140842894}, "cpu": {"percent": 4.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T09:47:54.259937+00:00", "processing_duration": 0.004101, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n", "timestamp": "2025-10-23T09:47:54.259008+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11311075328, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 188, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:47:54.360191+00:00", "memory": {"total": 33224306688, "available": 11311075328, "used": 21913231360, "percent": 66.0}, "disk": {"total": 1965300219904, "used": 865815592960, "free": 999577354240, "percent": 44.05513133267206}, "cpu": {"percent": 8.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T09:47:54.365605+00:00", "processing_duration": 0.002894, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T09:47:54.365147+00:00", "processing_duration": 0.002433, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11737538560, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 304, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:47:54.465899+00:00", "memory": {"total": 33224306688, "available": 11737538560, "used": 21486768128, "percent": 64.7}, "disk": {"total": 1965300219904, "used": 865815629824, "free": 999577317376, "percent": 44.05513320841601}, "cpu": {"percent": 7.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:47:54.662423+00:00", "processing_duration": 0.003152, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T09:47:54.662063+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11279822848, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:47:54.762756+00:00", "memory": {"total": 33224306688, "available": 11279822848, "used": 21944483840, "percent": 66.0}, "disk": {"total": 1965300219904, "used": 865816047616, "free": 999576899584, "percent": 44.055154466847455}, "cpu": {"percent": 8.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:47:54.768155+00:00", "processing_duration": 0.00377, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T09:47:54.767536+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11642953728, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-40/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1610, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:47:54.868463+00:00", "memory": {"total": 33224306688, "available": 11657306112, "used": 21567000576, "percent": 64.9}, "disk": {"total": 1965300219904, "used": 865815588864, "free": 999577358336, "percent": 44.055131124256064}, "cpu": {"percent": 17.5, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:47:54.874975+00:00", "processing_duration": 0.004806, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n", "timestamp": "2025-10-23T09:47:54.873906+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11675201536, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 157, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:47:54.975371+00:00", "memory": {"total": 33224306688, "available": 11674906624, "used": 21549400064, "percent": 64.9}, "disk": {"total": 1965300219904, "used": 865815617536, "free": 999577329664, "percent": 44.055132583168024}, "cpu": {"percent": 20.1, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T09:48:02.407530+00:00", "processing_duration": 0.004244, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T09:48:02.406991+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12361891840, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-40/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 140, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 112, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:48:02.507874+00:00", "memory": {"total": 33224306688, "available": 12361891840, "used": 20862414848, "percent": 62.8}, "disk": {"total": 1965300219904, "used": 865815810048, "free": 999577137152, "percent": 44.05514237871977}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T09:48:02.514104+00:00", "processing_duration": 0.003995, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T09:48:02.513619+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12382846976, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-40/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:48:02.614361+00:00", "memory": {"total": 33224306688, "available": 12382846976, "used": 20841459712, "percent": 62.7}, "disk": {"total": 1965300219904, "used": 865815842816, "free": 999577104384, "percent": 44.05514404604773}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T09:48:02.620602+00:00", "processing_duration": 0.003997, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T09:48:02.620151+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12399403008, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-40/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:48:02.720871+00:00", "memory": {"total": 33224306688, "available": 12399403008, "used": 20824903680, "percent": 62.7}, "disk": {"total": 1965300219904, "used": 865815867392, "free": 999577079808, "percent": 44.0551452965437}, "cpu": {"percent": 5.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T09:48:02.726429+00:00", "processing_duration": 0.003205, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T09:48:02.725981+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12405723136, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-40/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 140, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 112, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:48:02.826713+00:00", "memory": {"total": 33224306688, "available": 12405723136, "used": 20818583552, "percent": 62.7}, "disk": {"total": 1965300219904, "used": 865815900160, "free": 999577047040, "percent": 44.05514696387166}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T09:51:02.281439+00:00", "processing_duration": 0.004576, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n", "timestamp": "2025-10-23T09:51:02.280348+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11682013184, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 200, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:51:02.381835+00:00", "memory": {"total": 33224306688, "available": 11682013184, "used": 21542293504, "percent": 64.8}, "disk": {"total": 1965300219904, "used": 865799663616, "free": 999593283584, "percent": 44.05432080286909}, "cpu": {"percent": 15.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T09:51:02.388188+00:00", "processing_duration": 0.003054, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T09:51:02.387810+00:00", "processing_duration": 0.002674, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11582930944, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 304, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:51:02.488434+00:00", "memory": {"total": 33224306688, "available": 11582930944, "used": 21641375744, "percent": 65.1}, "disk": {"total": 1965300219904, "used": 865799692288, "free": 999593254912, "percent": 44.05432226178106}, "cpu": {"percent": 11.2, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:51:02.688267+00:00", "processing_duration": 0.003477, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T09:51:02.687721+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11138260992, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:51:02.788643+00:00", "memory": {"total": 33224306688, "available": 11138260992, "used": 22086045696, "percent": 66.5}, "disk": {"total": 1965300219904, "used": 865800024064, "free": 999592923136, "percent": 44.054339143476625}, "cpu": {"percent": 11.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:51:02.794498+00:00", "processing_duration": 0.003839, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T09:51:02.793878+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11739107328, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-41/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1610, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:51:02.894724+00:00", "memory": {"total": 33224306688, "available": 11738910720, "used": 21485395968, "percent": 64.7}, "disk": {"total": 1965300219904, "used": 865800056832, "free": 999592890368, "percent": 44.054340810804575}, "cpu": {"percent": 10.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:51:02.899721+00:00", "processing_duration": 0.003596, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n", "timestamp": "2025-10-23T09:51:02.899057+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11682111488, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 157, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:51:03.000141+00:00", "memory": {"total": 33224306688, "available": 11680649216, "used": 21543657472, "percent": 64.8}, "disk": {"total": 1965300219904, "used": 865800085504, "free": 999592861696, "percent": 44.05434226971654}, "cpu": {"percent": 8.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T09:51:12.495919+00:00", "processing_duration": 0.003319, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T09:51:12.495438+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12494282752, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-41/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 140, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 112, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:51:12.596195+00:00", "memory": {"total": 33224306688, "available": 12494282752, "used": 20730023936, "percent": 62.4}, "disk": {"total": 1965300219904, "used": 865800527872, "free": 999592419328, "percent": 44.05436477864396}, "cpu": {"percent": 4.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T09:51:12.601737+00:00", "processing_duration": 0.003615, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T09:51:12.601277+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12582465536, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-41/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:51:12.701973+00:00", "memory": {"total": 33224306688, "available": 12582465536, "used": 20641841152, "percent": 62.1}, "disk": {"total": 1965300219904, "used": 865800556544, "free": 999592390656, "percent": 44.05436623755592}, "cpu": {"percent": 5.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T09:51:12.708620+00:00", "processing_duration": 0.00479, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T09:51:12.708080+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12581744640, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-41/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:51:12.808915+00:00", "memory": {"total": 33224306688, "available": 12581744640, "used": 20642562048, "percent": 62.1}, "disk": {"total": 1965300219904, "used": 865800581120, "free": 999592366080, "percent": 44.05436748805189}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T09:51:12.815058+00:00", "processing_duration": 0.003993, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T09:51:12.814569+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12616204288, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-41/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 140, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 112, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:51:12.915345+00:00", "memory": {"total": 33224306688, "available": 12616204288, "used": 20608102400, "percent": 62.0}, "disk": {"total": 1965300219904, "used": 865800613888, "free": 999592333312, "percent": 44.05436915537984}, "cpu": {"percent": 4.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T09:54:41.078772+00:00", "processing_duration": 0.004347, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n", "timestamp": "2025-10-23T09:54:41.077798+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12284583936, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": ["source"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 96, in validate\n    return dataset.validate_numerical()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 200, in validate_numerical\n    raise ValueError(f\"NaN values found in {field_name} ({nan_count} total, indices: {nan_indices.tolist()})\")\nValueError: NaN values found in observable (1 total, indices: [1])\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 169, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: numerical_error\nError: NaN values found in observable (1 total, indices: [1])\nContext: {'issue_type': 'nan_values', 'data_statistics': {'n_points': 3, 'z_range': [0.1, 0.3], 'observable_range': [nan, nan], 'uncertainty_range': [0.1, 0.3]}}\nSuggested Actions:\n  1. Check input data for missing values or invalid entries\n  2. Review data loading process for proper NaN handling\n  3. Verify mathematical operations don't produce NaN (e.g., 0/0, inf-inf)\n  4. Consider data cleaning or interpolation for missing values\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:54:41.179087+00:00", "memory": {"total": 33224306688, "available": 12284583936, "used": 20939722752, "percent": 63.0}, "disk": {"total": 1965300219904, "used": 865803173888, "free": 999589773312, "percent": 44.05449941537646}, "cpu": {"percent": 11.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T09:54:41.194778+00:00", "processing_duration": 0.003557, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T09:54:41.194241+00:00", "processing_duration": 0.003016, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12576874496, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 304, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:54:41.295058+00:00", "memory": {"total": 33224306688, "available": 12576874496, "used": 20647432192, "percent": 62.1}, "disk": {"total": 1965300219904, "used": 865803202560, "free": 999589744640, "percent": 44.05450087428842}, "cpu": {"percent": 11.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:54:41.647834+00:00", "processing_duration": 0.002686, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T09:54:41.647494+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12451094528, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:54:41.748120+00:00", "memory": {"total": 33224306688, "available": 12442836992, "used": 20781469696, "percent": 62.5}, "disk": {"total": 1965300219904, "used": 865803538432, "free": 999589408768, "percent": 44.05451796439998}, "cpu": {"percent": 7.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:54:41.752764+00:00", "processing_duration": 0.003185, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T09:54:41.752223+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12868419584, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-42/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 374, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1610, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:54:41.853045+00:00", "memory": {"total": 33224306688, "available": 12868419584, "used": 20355887104, "percent": 61.3}, "disk": {"total": 1965300219904, "used": 865803563008, "free": 999589384192, "percent": 44.05451921489595}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T09:54:41.859220+00:00", "processing_duration": 0.004292, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n", "timestamp": "2025-10-23T09:54:41.858280+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 12879282176, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 157, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 410, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:54:41.959557+00:00", "memory": {"total": 33224306688, "available": 12879282176, "used": 20345024512, "percent": 61.2}, "disk": {"total": 1965300219904, "used": 865803599872, "free": 999589347328, "percent": 44.054521090639895}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T09:54:49.736134+00:00", "processing_duration": 0.004167, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T09:54:49.735646+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13349388288, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-42/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 140, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 112, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:54:49.836351+00:00", "memory": {"total": 33224306688, "available": 13349388288, "used": 19874918400, "percent": 59.8}, "disk": {"total": 1965300219904, "used": 865803808768, "free": 999589138432, "percent": 44.054531719855625}, "cpu": {"percent": 4.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T09:54:49.867455+00:00", "processing_duration": 0.003478, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T09:54:49.867001+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13350699008, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-42/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:54:49.967740+00:00", "memory": {"total": 33224306688, "available": 13350699008, "used": 19873607680, "percent": 59.8}, "disk": {"total": 1965300219904, "used": 865803833344, "free": 999589113856, "percent": 44.05453297035159}, "cpu": {"percent": 5.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T09:54:50.002021+00:00", "processing_duration": 0.00385, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T09:54:50.001585+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13349048320, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-42/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:54:50.102281+00:00", "memory": {"total": 33224306688, "available": 13349048320, "used": 19875258368, "percent": 59.8}, "disk": {"total": 1965300219904, "used": 865803857920, "free": 999589089280, "percent": 44.05453422084756}, "cpu": {"percent": 5.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T09:54:50.139503+00:00", "processing_duration": 0.003834, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T09:54:50.139026+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 13349924864, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-42/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 319, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 140, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 112, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T09:54:50.239787+00:00", "memory": {"total": 33224306688, "available": 13349924864, "used": 19874381824, "percent": 59.8}, "disk": {"total": 1965300219904, "used": 865803886592, "free": 999589060608, "percent": 44.054535679759525}, "cpu": {"percent": 4.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_data", "failure_time": "2025-10-23T10:08:35.764230+00:00", "processing_duration": 0.008609, "error_context": {"dataset_name": "test_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:08:35.763391+00:00", "processing_duration": 0.007767, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11317977088, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:08:35.864630+00:00", "memory": {"total": 33224306688, "available": 11350867968, "used": 21873438720, "percent": 65.8}, "disk": {"total": 1965300219904, "used": 865819299840, "free": 999573647360, "percent": 44.05531994914716}, "cpu": {"percent": 13.7, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "test_invalid_data", "failure_time": "2025-10-23T10:08:35.900859+00:00", "processing_duration": 0.003063, "error_context": {"dataset_name": "test_invalid_data", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:08:35.900436+00:00", "processing_duration": 0.002637, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11619594240, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'test_invalid_data'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': ['test'], 'registered_modules': 1}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:08:36.001170+00:00", "memory": {"total": 33224306688, "available": 11610828800, "used": 21613477888, "percent": 65.1}, "disk": {"total": 1965300219904, "used": 865819328512, "free": 999573618688, "percent": 44.05532140805913}, "cpu": {"percent": 16.6, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "unknown_nonexistent", "failure_time": "2025-10-23T10:08:36.014014+00:00", "processing_duration": 0.002875, "error_context": {"dataset_name": "unknown_nonexistent", "stage": "ProcessingStage.INITIALIZATION", "severity": "ErrorSeverity.CRITICAL", "error_type": "unexpected_error", "error_message": "Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n", "timestamp": "2025-10-23T10:08:36.013655+00:00", "processing_duration": 0.002513, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11414777856, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 303, in prepare_dataset\n    module = self._get_derivation_module(dataset_name, dataset_type)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 158, in _get_derivation_module\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown_nonexistent'\nStage: module_selection\nError Type: unsupported_dataset_type\nError: No derivation module available for dataset type: unknown\nContext: {'detected_type': 'unknown', 'available_types': [], 'registered_modules': 0}\nSuggested Actions:\n  1. Implement derivation module for unknown\n  2. Check dataset name and type classification\n  3. Verify module registration\n  4. Use register_derivation_module() to add missing module\n\n", "suggested_actions": ["Check logs for detailed error information", "Verify system resources and permissions", "Report issue if error persists"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:08:36.114252+00:00", "memory": {"total": 33224306688, "available": 11429728256, "used": 21794578432, "percent": 65.6}, "disk": {"total": 1965300219904, "used": 865819357184, "free": 999573590016, "percent": 44.05532286697109}, "cpu": {"percent": 24.8, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:08:36.571493+00:00", "processing_duration": 0.003195, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "input_validation_failed", "error_message": "Input validation failed", "timestamp": "2025-10-23T10:08:36.571158+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 10963767296, "disk_usage": 46.4}, "dataset_info": null, "stack_trace": "NoneType: None\n", "suggested_actions": ["Check raw data format and integrity", "Verify file permissions and accessibility", "Review dataset metadata completeness"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:08:36.671779+00:00", "memory": {"total": 33224306688, "available": 10963767296, "used": 22260539392, "percent": 67.0}, "disk": {"total": 1965300219904, "used": 865819676672, "free": 999573270528, "percent": 44.05533912341867}, "cpu": {"percent": 11.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:08:36.676640+00:00", "processing_duration": 0.003439, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.TRANSFORMATION", "severity": "ErrorSeverity.ERROR", "error_type": "transformation_failed", "error_message": "Dataset transformation failed: Mock transformation failure", "timestamp": "2025-10-23T10:08:36.675866+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11230318592, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-47/test_prepare_dataset_transform0/test_data.txt", "metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 373, in prepare_dataset\n    derived_dataset = enhanced_module.derive(raw_data_path, metadata)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 1609, in derive\n    result = self.wrapped_module.derive(raw_data_path, metadata)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/tests/test_preparation_engine.py\", line 40, in derive\n    raise ValueError(\"Mock transformation failure\")\nValueError: Mock transformation failure\n", "suggested_actions": ["Check input data format compatibility", "Review transformation module implementation", "Verify all required data fields are present", "Check for data corruption or missing values", "Review transformation parameters and assumptions"], "recovery_attempted": true, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:08:36.776927+00:00", "memory": {"total": 33224306688, "available": 11222061056, "used": 22002245632, "percent": 66.2}, "disk": {"total": 1965300219904, "used": 865819713536, "free": 999573233664, "percent": 44.05534099916262}, "cpu": {"percent": 9.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": true, "recovery_successful": false}
{"dataset_name": "sn_pantheon", "failure_time": "2025-10-23T10:08:36.781711+00:00", "processing_duration": 0.003398, "error_context": {"dataset_name": "sn_pantheon", "stage": "ProcessingStage.OUTPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "output_validation_error", "error_message": "Output validation failed: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n", "timestamp": "2025-10-23T10:08:36.780948+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11214733312, "disk_usage": 46.4}, "dataset_info": {"metadata_keys": []}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 24, in validate\n    return dataset.validate_schema()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/schema.py\", line 157, in validate_schema\n    raise ValueError(f\"Required metadata field '{key}' is missing\")\nValueError: Required metadata field 'source' is missing\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 409, in prepare_dataset\n    validation_results = self.validation_engine.validate_dataset(\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 554, in validate_dataset\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 544, in validate_dataset\n    rule_passed = rule.validate(dataset)\n                  ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/core/validation.py\", line 69, in validate\n    raise ProcessingError(\npipelines.data_preparation.core.interfaces.ProcessingError: Processing failed for dataset 'unknown'\nStage: output_validation\nError Type: schema_error\nError: Required metadata field 'source' is missing\nContext: {'schema_requirements': {'required_fields': ['z', 'observable', 'uncertainty', 'metadata'], 'optional_fields': ['covariance'], 'required_metadata_keys': ['source'], 'recommended_metadata_keys': ['dataset_type']}}\nSuggested Actions:\n  1. Ensure all required fields (z, observable, uncertainty, metadata) are present\n  2. Check derivation module output format\n  3. Verify data loading process includes all necessary fields\n\n", "suggested_actions": ["Check derived dataset structure and completeness", "Verify transformation produced valid output", "Review validation rules for appropriateness", "Check for data type consistency", "Verify array shapes and dimensions"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:08:36.881979+00:00", "memory": {"total": 33224306688, "available": 11214733312, "used": 22009573376, "percent": 66.2}, "disk": {"total": 1965300219904, "used": 865819738112, "free": 999573209088, "percent": 44.05534224965859}, "cpu": {"percent": 11.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_cross_validation", "failure_time": "2025-10-23T10:08:48.433038+00:00", "processing_duration": 0.004268, "error_context": {"dataset_name": "sn_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T10:08:48.432556+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11698319360, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-47/test_sn_cross_validation0/sn_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:08:48.533387+00:00", "memory": {"total": 33224306688, "available": 11698319360, "used": 21525987328, "percent": 64.8}, "disk": {"total": 1965300219904, "used": 865820446720, "free": 999572500480, "percent": 44.055378305625645}, "cpu": {"percent": 31.9, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "bao_cross_validation", "failure_time": "2025-10-23T10:08:48.567552+00:00", "processing_duration": 0.004925, "error_context": {"dataset_name": "bao_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Cannot determine BAO measurement type from data columns", "timestamp": "2025-10-23T10:08:48.567052+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11895664640, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-47/test_bao_cross_validation0/bao_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 99, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 80, in validate_input\n    measurement_type = self._determine_measurement_type(data, metadata)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/bao_derivation.py\", line 126, in _determine_measurement_type\n    raise ValueError(\"Cannot determine BAO measurement type from data columns\")\nValueError: Cannot determine BAO measurement type from data columns\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:08:48.667916+00:00", "memory": {"total": 33224306688, "available": 11895664640, "used": 21328642048, "percent": 64.2}, "disk": {"total": 1965300219904, "used": 865820479488, "free": 999572467712, "percent": 44.05537997295361}, "cpu": {"percent": 10.0, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "cmb_cross_validation", "failure_time": "2025-10-23T10:08:48.705852+00:00", "processing_duration": 0.00502, "error_context": {"dataset_name": "cmb_cross_validation", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']", "timestamp": "2025-10-23T10:08:48.705277+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11678556160, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-47/test_cmb_cross_validation0/cmb_cross_validation.txt", "metadata_keys": ["source", "version", "description"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 83, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 76, in validate_input\n    self._validate_cmb_parameters(data, metadata)\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/cmb_derivation.py\", line 139, in _validate_cmb_parameters\n    raise ValueError(f\"Required CMB parameter '{param}' not found. Available keys: {available_keys}\")\nValueError: Required CMB parameter 'R' not found. Available keys: ['1.7502', '301.63', '1.04119']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:08:48.806130+00:00", "memory": {"total": 33224306688, "available": 11678556160, "used": 21545750528, "percent": 64.8}, "disk": {"total": 1965300219904, "used": 865820499968, "free": 999572447232, "percent": 44.05538101503358}, "cpu": {"percent": 9.4, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
{"dataset_name": "sn_compatibility", "failure_time": "2025-10-23T10:08:48.840348+00:00", "processing_duration": 0.003499, "error_context": {"dataset_name": "sn_compatibility", "stage": "ProcessingStage.INPUT_VALIDATION", "severity": "ErrorSeverity.ERROR", "error_type": "validation_error", "error_message": "Input validation failed: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']", "timestamp": "2025-10-23T10:08:48.839899+00:00", "processing_duration": null, "system_info": {"python_version": "3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]", "platform": "Linux-6.8.0-85-generic-x86_64-with-glibc2.39", "cpu_count": 32, "memory_total": 33224306688, "memory_available": 11382427648, "disk_usage": 46.4}, "dataset_info": {"raw_data_path": "/tmp/pytest-of-fabian/pytest-47/test_format_conversion_compati0/sn_compatibility.txt", "metadata_keys": ["source", "version"]}, "stack_trace": "Traceback (most recent call last):\n  File \"/home/fabian/PBUF/pipelines/data_preparation/engine/preparation_engine.py\", line 318, in prepare_dataset\n    if not module.validate_input(raw_data_path, metadata):\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 136, in validate_input\n    raise e\n  File \"/home/fabian/PBUF/pipelines/data_preparation/derivation/sn_derivation.py\", line 108, in validate_input\n    raise ValueError(f\"Missing required columns {missing_columns}. Available columns: {available_cols}\")\nValueError: Missing required columns ['z', 'mb', 'dmb']. Available columns: ['0.0233', '32.81', '0.12']\n", "suggested_actions": ["Check file format and structure", "Verify file is not corrupted", "Review dataset documentation for expected format", "Check file permissions and accessibility"], "recovery_attempted": false, "recovery_successful": false}, "system_health": {"timestamp": "2025-10-23T10:08:48.940641+00:00", "memory": {"total": 33224306688, "available": 11382427648, "used": 21841879040, "percent": 65.7}, "disk": {"total": 1965300219904, "used": 865820532736, "free": 999572414464, "percent": 44.05538268236154}, "cpu": {"percent": 11.3, "count": 32}, "threshold_violations": []}, "recovery_attempted": false, "recovery_successful": false}
